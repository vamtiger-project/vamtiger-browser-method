{"version":3,"file":"vamtiger-browser-method.js","sources":["../source/types.ts","../node_modules/tslib/tslib.js","../source/load-ts-lib.ts","../source/get-meta-element.ts","../source/load-element-query-css.ts","../source/config.ts","../source/get-transpiled-js.ts","../source/is-window.ts","../source/is-worker.ts","../source/send-message.ts","../source/is-json-script.ts","../source/remove-redundant-scripts.ts","../source/load-script.ts","../source/get-db-params.ts","../source/save-indexed-db-data.ts","../source/get-indexed-db-data.ts","../source/handle-load-script.ts","../source/get-text-mode-css.ts","../source/save-custom-element-name.ts","../source/define-custom-element.ts","../source/pause.ts","../source/load-container-stylesheets.ts","../source/get-element-from-template.ts","../source/get-element-from-url.ts","../source/get-element.ts","../source/queue.ts","../source/dequeue.ts","../source/get-web-component-data.ts","../source/save-web-component-data.ts","../source/load-web-component-data.ts","../source/get-json-ld.ts","../source/view-json-ld.ts","../source/is-text-mode.ts","../source/get-data.ts","../source/get-environment.ts","../source/get-message-data.ts","../source/save-support.ts","../source/set-support.ts","../source/ignore-message.ts","../source/handle-message.ts","../source/get-local-host-worker-url.ts","../source/is-local-host.ts","../source/get-worker.ts","../source/setup-window.ts","../source/setup-worker.ts","../source/html/index.ts","../source/get-template.ts","../source/get-microdata-caption.ts","../source/get-tab-link.ts","../source/get-json-ld-array.ts","../source/get-email-link.ts","../source/load-dependencies.ts","../source/dispatch-event.ts","../source/vamtiger-browser-method.ts","../source/load-scripts.ts","../source/load-scripts-sequentially.ts","../source/load-shadow-stylesheet.ts"],"sourcesContent":["import * as tslib from 'tslib/tslib';\nimport { requestIdleCallback } from 'requestidlecallback';\nimport * as lodash from 'lodash';\n\nexport enum Environment {\n    window = 'window',\n    worker = 'worker'\n}\n\nexport enum EventName {\n    vamtigerBrowserMethodReady = 'vamtigerBrowserMethodReady'\n}\n\nexport enum TimeoutDuration {\n    webComponent = 60000,\n    indexDbIsAccessible = 100\n}\n\nexport enum MessageQueueName {\n    webComponent = 'webComponent'\n}\n\nexport enum Prefix {\n    vamtigerBrowserMethod = 'vamtiger-browser-method',\n    db = 'vamtiger-browser-method',\n    messageIdWindow = 'vamtiger-browser-method-window',\n    messageIdWorker = 'vamtiger-browser-method-worker'\n}\n\nexport enum ElementId {\n    metaElement = 'vamtiger-browser-method'\n}\n\nexport enum Origin {\n    nowhere = '',\n    everyWhere = '*'\n}\n\nexport enum HostName {\n    localHost = 'localhost'\n}\n\nexport enum LocalHostRelativePath {\n    vamtigerBrowserMethod = 'vamtiger-browser-method.js'\n}\n\nexport enum ScriptType {\n    js = 'text/javascript',\n    babel = 'text/babel',\n    json = 'application/json',\n    jsonld = 'application/ld+json'\n}\n\nexport enum ScriptAttribute {\n    type = 'type'\n}\n\nexport enum DataAttribute {\n    vamtigerElementQuery = 'vamtigerLoadElementQueryCss',\n    elementQueryCssLoaded = 'elementQueryCssLoaded',\n    customElementName = 'customElementName'\n}\n\nexport enum ErrorMessage {\n    failedToLoadScript = 'Failed to load script',\n    windowPropertyNotSet = 'Window property not set',\n    unsupportedFeature = 'Unsupported feature',\n    customElementAreadyDefined = 'Custom element already defined',\n    noElementName = 'No Element Name',\n    noTemplateUrl = 'No Template URL',\n    noElementSelector = 'No Template Selector',\n    noTemplateForUrl = 'No Template for URL',\n    noTemplate = 'No Template',\n    noElementForSelector = 'No Element for Selector',\n    noJsonLdParameter = 'No \"jsonLd\" property set'\n}\n\nexport enum StringConstant {\n    nothing = '',\n    slash = '/',\n    dash = '-',\n    pipe = '|',\n    comma = ',',\n    backTick = '`',\n    doubleQuote = '\"',\n    commaSpace = ', ',\n    space = ' ',\n    period = '.',\n    newline = '\\n',\n    semiColon = ';'\n}\n\nexport enum TagName {\n    div = 'div',\n    template = 'template'\n}\n\nexport enum LinkRel {\n    stylesheet = 'stylesheet'\n}\n\nexport enum LoadScriptElement {\n    script = 'script',\n    link = 'link',\n    style = 'style'\n}\n\nexport enum Selector {\n    lastStylesheet = 'style:last-of-type',\n    lastMetaElement = 'head > meta:last-of-type',\n    webcomponentsjs = 'script[src*=\"@webcomponents\\/webcomponentsjs\"]',\n    style = 'style',\n    stylesheet = ' link[rel=\"stylesheet\"]',\n    vamtigerBrowserMethodJsonJs = '[src$=\"vamtiger-browser-method.js.json.js\"]',\n    worker = '[src$=\"js.json.js\"][data-worker]',\n    workderDependency = 'script[data-worker-dependency]',\n    vamtigerBrowserMethodJson = '[data-name$=\"vamtiger-browser-method.js.json\"]',\n    vamtigerBrowserMethod = '[data-name$=\"vamtiger-browser-method.js\"]',\n    script = 'script',\n    jsonScript = 'script[type=\"application/json\"]',\n    jsonLdScript = 'script[type=\"application/ld+json\"]',\n    a = 'a',\n    linkedDataCaption = '[data-linked-data-caption]',\n    linkedDataCaptionElement = '[data-linked-data-caption-element]',\n    jsonLdViewer = 'vamtiger-json-ld-viewer',\n    transpiledJs = '[data-transpiled-js]',\n    htmlTextMode = 'html[data-vamtiger-text-mode]',\n    customElementNameMetaElement = 'meta[data-custom-element-name]'\n}\n\nexport enum TextModeElementName {\n    vamtigerJsonLdViewer = 'vamtiger-json-ld-viewer'\n}\n\nexport enum  MetaElementName {\n    loadElementQueryCss = 'vamtiger-load-element-query-css'\n}\n\nexport enum ScriptNameSuffix {\n    style = 'style',\n    stylesheet = 'stylesheet'\n}\n\nexport enum ScriptName {\n    textMode = 'vamtiger-text-mode'\n}\n\nexport enum MessageAction {\n    ignore = 'ignore',\n    removeRedundantScripts = 'removeRedundantScripts',\n    setWorkerSupport = 'setWorkerSupport',\n    saveWebComponentData = 'saveWebComponentData',\n    getWebComponentData = 'getWebComponentData',\n    dequeue = 'dequeue',\n    loadWebComponentData = 'loadWebComponentData',\n    saveSupport = 'saveSupport',\n    saveCustomElementName = 'saveCustomElementName',\n    getTextModeCss = 'getTextModeCss',\n    loadScript = 'loadScript'\n}\n\nexport enum DbName {\n    vamtigerBrowserSupport = 'vamtiger-browser-support'\n}\n\nexport enum DbStoreName {\n    support = 'support',\n    webComponent = 'web-component',\n    customElementName = 'custom-element-name'\n}\n\nexport enum DbMode {\n    readonly = 'readonly',\n    readwrite = 'readwrite',\n    versionchange = 'versionchange'\n}\n\nexport enum DbKeyPath {\n    webComponent = 'url',\n    support = 'environment',\n    customElementName = 'name'\n}\n\nexport enum Dependency {\n    lodash = 'https://vamtiger-project.github.io/vamtiger-browser-method/build/lodash.min.js.json.js',\n    jsonLdViewer = 'https://vamtiger-project.github.io/vamtiger-json-ld-viewer/build/vamtiger-json-ld-viewer.js.json.js'\n}\n\nexport interface IDequeue {\n    key: string;\n    data: IAnyObject;\n}\n\nexport interface IGetDbParams {\n    storeName: DbStoreName;\n    keyPath: DbKeyPath;\n    mode: DbMode;\n}\n\nexport interface IGetDbParamsHandleUpgradeNeeded extends Pick<IDbParams, 'db'>{}\n\nexport interface IDbParams {\n    db: IDBDatabase;\n    transaction: IDBTransaction;\n    store: IDBObjectStore;\n}\n\nexport interface ILoadRemoteScriptParams {\n    src: string;\n}\n\nexport interface ILoadRemoteStylesheetScriptParams {\n    href: string;\n}\n\nexport interface IIsJsonScript {\n    script: HTMLScriptElement;\n}\n\nexport interface ILoadLocalScriptParams {\n    name: string;\n    removeExisting?: boolean;\n    removeFromDom?: boolean;\n    workerDependency?: boolean;\n}\n\nexport interface ILoadScriptParams {\n    js: string;\n    jsonld?: boolean;\n}\n\nexport interface ISaveCustomeElementName {\n    name: string;\n}\n\nexport interface ILoadJsonScriptParams {\n    json: string;\n}\n\nexport interface ILoadStylesheetScriptParams {\n    css: string;\n}\n\nexport interface IAnyObject {\n    [key: string]: any;\n}\n\nexport interface IJsonData {\n    jsonLd: IAnyObject[];\n    json?: IAnyObject;\n}\n\nexport interface IJsonJsonLd {\n    index: number;\n    fields: {\n        [key: string]: string[];\n    }\n}\n\nexport interface ILoadScript {\n    params: LocalScriptParams\n        | LocalStylesheetScriptParams\n        | ILoadRemoteScriptParams\n        | ILoadRemoteStylesheetScriptParams\n        | ILoadJsonScriptParams;\n    reject: (error: Error) => void\n}\n\nexport interface ILoadScriptLoadJsJsonJs {\n    src: string;\n    workerDependency?: boolean;\n}\n\nexport interface ILoadShadowStylesheet {\n    css: string;\n    element: HTMLElement;\n}\n\nexport interface IJsonScriptData {\n    name: string;\n    text: string;\n}\n\nexport interface IDefineCustomElement {\n    name: string;\n    constructor: {\n        new (): HTMLElement\n        prototype: HTMLElement;\n    };\n    ignore?: boolean;\n}\n\nexport interface IPause {\n    milliseconds: number;\n}\n\nexport interface IGetElementBase {\n    name: string;\n    loadStylesheets?: boolean;\n}\n\nexport interface IGetElementTemplate extends IGetElementBase {\n    template: string;\n    selector?: string;\n}\n\nexport interface IGetElementUrl extends IGetElementBase {\n    url: string;\n    selector:  string;\n}\n\nexport interface ILoadElementQueryCss {\n    css: string;\n    stylesheetName?: string;\n    hostName?: string;\n}\n\nexport interface IGetJsonLdArray {\n    jsonLd: IAnyObject;\n}\n\nexport interface IGetJsonLdArrayGetEntry {\n    key: string;\n    value: string | IAnyObject | IAnyObject[];\n}\n\nexport interface IGetMetaElement {\n    selector?: string;\n    properties?: {\n        id?: string;\n    };\n    attributes?: {\n        [key: string]: string;\n    };\n    dataset?: DOMStringMap;\n}\n\nexport interface IDispatchEvent {\n    eventName: EventName;\n    detail?: IAnyObject;\n}\n\nexport interface IGetBabelJs {\n    url?: string;\n    js?: string;\n}\n\nexport interface ILoadContainerStylesheets {\n    name: string;\n    container: HTMLTemplateElement;\n}\n\nexport interface IGetData {\n    jsonLd: string;\n    textMode?: boolean;\n}\n\nexport interface IGetDataResolve extends IGetData {\n    data: IJsonData;\n    jsonLd: string;\n    resolve: (data: IJsonData) => void\n}\n\nexport interface IGetJsonLd {\n    jsonLd: string;\n    textMode?: boolean;\n    loadJsonJsonLd?: boolean;\n}\n\nexport interface IViewJsonLd {\n    jsonLd: string;\n}\n\nexport interface IJosnLdImageObject {\n    \"@context\": string;\n    '@type': string;\n    name: string;\n    description: string;\n    author: {\n        '@type': string;\n        givenName: string;\n        familyName: string;\n        email: string;\n    };\n    datePublished: string;\n    contentUrl: string;\n}\n\nexport interface IMessageAction {\n    action: MessageAction;\n    params: IAnyObject & {\n        messageId?: string;\n    };\n}\n\nexport interface IRemoveRedundantScripts {\n    selector: string;\n}\n\nexport interface IRemoveRedundantScriptsRemoveScripts extends IRemoveRedundantScripts {\n    parent: HTMLElement;\n}\n\nexport interface IRemoveRedundantScriptsRemoveScriptsFromParent extends IRemoveRedundantScriptsRemoveScripts {\n    resolve?: () => void;\n    reject?: (error: Error) => void;\n}\n\nexport interface ISupport {\n    localStorage: boolean;\n    indexedDb: boolean;\n    indexedDbIsAccessible: boolean;\n    worker: boolean;\n    sharedWorker: boolean;\n    textEncoder: boolean;\n    textDecoder: boolean;\n}\n\nexport interface ICustomElementName {\n    name: string;\n}\n\nexport interface ISaveSupport extends ISupport {\n    environment: Environment;\n}\n\nexport interface ISaveWebComponentData extends IWebComponentData {}\n\nexport interface IGetWebComponentData {\n    key: string;\n}\n\nexport interface IGetDbName {\n    dbName: DbName\n}\n\nexport interface ISaveIndexedDbData {\n    storeName: DbStoreName;\n    keyPath: DbKeyPath;\n    messageId?: string;\n    data: IndexDbData;\n    successAction?: MessageAction\n}\n\nexport interface IGetIndexedDbData {\n    storeName: DbStoreName;\n    keyPath: DbKeyPath;\n    key?: string;\n    messageId?: string;\n}\n\nexport interface ISaveIndexedDbDataHandleSuccess {\n    messageId?: string;\n    key: string;\n    action?: MessageAction;\n    data: IndexDbData;\n}\n\nexport interface IWebComponentData {\n    url: string;\n    created?: number;\n    messageId?: string;\n    jsonLd: IAnyObject[];\n    json: IAnyObject;\n}\n\nexport interface ISaveWebComponentDataWorker extends ISaveWebComponentData {}\n\nexport interface IMessageQueueEntry {\n    resolve: (result: any) => void;\n    reject: (reason: Error) => void;\n}\n\nexport interface IQueue extends NonNullable<Pick<IMessageQueueEntry, 'resolve' | 'reject'>> {\n    key: string;\n}\n\nexport interface IQueueHandleExpiredQueueEntry {\n    key: string;\n    queueEntry: IMessageQueueEntry;\n}\n\nexport interface ILoadData {\n    url: string;\n    loadJsonJsonLd?: boolean;\n}\n\nexport interface ILoadDataGetFeldData {\n    key: string;\n    urls: string[];\n}\n\nexport interface ILoadDataGetJsonJsonLd extends IJsonJsonLd {}\n\nexport interface IGetMicrodataCaption {\n    imageData: IAnyObject;\n    fieldKey: string;\n}\n\nexport interface IGetTemplate {\n    selector: Selector;\n    attributes?: IAttributes;\n    properties?: IProperties;\n}\n\nexport interface IProperties {\n    name?: string;\n    src?: string;\n    alt?: string;\n    innerHTML?: string;\n}\n\nexport interface IGetTabLink {\n    href: string;\n    text: string;\n}\n\nexport interface IGetEmailLink {\n    href: string;\n    text: string;\n}\n\nexport type WebComponentDataResolve = (webComponent: IJsonData | undefined) => void;\n\nexport type ErrorResolve = (error: Error) => void;\n\nexport type MessageResponse = IMessageAction | undefined | null | false;\n\nexport type TsLibType = typeof tslib;\n\nexport type TsLibKey = keyof TsLibType;\n\nexport type TsLib = {\n    [K in TsLibKey]: TsLibType[K]\n}\n\nexport type LocalScriptParams = ILoadLocalScriptParams & ILoadScriptParams;\n\nexport type LocalStylesheetScriptParams = ILoadLocalScriptParams & ILoadStylesheetScriptParams;\n\nexport type LoadScriptParams = LocalScriptParams\n    | LocalStylesheetScriptParams\n    | ILoadRemoteScriptParams\n    | ILoadRemoteStylesheetScriptParams;\n\nexport type LoadScriptsParams = LoadScriptParams[];\n\nexport type LoadScriptsSequentiallyParams = LoadScriptsParams[];\n\nexport type DependencyKey = keyof typeof Dependency;\n\nexport type LoadedScript<P extends ILoadScript['params']> =\n    P extends ILoadScriptParams ? HTMLScriptElement :\n    P extends ILoadStylesheetScriptParams ? HTMLStyleElement :\n    P extends ILoadRemoteScriptParams ? HTMLScriptElement :\n    P extends ILoadRemoteStylesheetScriptParams ? HTMLLinkElement :\n    never;\n\nexport type LoadedScripts<P extends LoadScriptsParams> =\n    P extends ILoadScriptParams[] ? HTMLScriptElement[] :\n    P extends ILoadStylesheetScriptParams[] ? HTMLStyleElement[] :\n    P extends ILoadRemoteScriptParams[] ? HTMLScriptElement[] :\n    P extends ILoadRemoteStylesheetScriptParams[] ? HTMLLinkElement[] :\n    never;\n\nexport type LoadedScriptsSequentially<P extends LoadScriptsSequentiallyParams> =\n    P extends ILoadScriptParams[][] ? HTMLScriptElement[] :\n    P extends ILoadStylesheetScriptParams[][] ? HTMLStyleElement[] :\n    P extends ILoadRemoteScriptParams[][] ? HTMLScriptElement[] :\n    P extends ILoadRemoteStylesheetScriptParams[][] ? HTMLLinkElement[] :\n    never;\n\nexport type GetElementParams = IGetElementTemplate | IGetElementUrl;\n\nexport type VamtigerBrowserMethod = {\n    metaElement?: HTMLMetaElement;\n    loadScript: <P extends LocalScriptParams | LocalStylesheetScriptParams | ILoadRemoteScriptParams | ILoadRemoteStylesheetScriptParams>(params: P) => Promise<LoadedScript<P>>;\n    loadScripts: <P extends LoadScriptParams[]>(params: P) => Promise<LoadedScripts<P>>;\n    loadScriptsSequentially: <P extends LoadScriptParams[][]>(params: P) => Promise<LoadedScriptsSequentially<P>>;\n    loadShadowStylesheet: ({ css, element }: ILoadShadowStylesheet) => void;\n    defineCustomElement: ({ name, constructor, ignore }: IDefineCustomElement) => void;\n    pause: ({ milliseconds }: IPause) => Promise<unknown>;\n    getElement: <P extends GetElementParams>(params: P) => Promise<HTMLElement>;\n    getData: ({ jsonLd }: IGetData) => Promise<IJsonData>;\n    getEnvironment: () => Environment;\n    environment: Environment;\n    getMicrodataCaption: (params: IGetMicrodataCaption) => HTMLElement | null | undefined\n    messageQueue: Map<string, Set<IMessageQueueEntry>>;\n    worker?: Worker;\n    support?: ISupport;\n    workerSupport?: ISupport;\n    getJsonLdArray: ({ jsonLd }: IGetJsonLdArray) => Promise<string[][]>;\n};\n\nexport interface IAttributes {\n    id?: string;\n    for?: string;\n    slot?: string;\n    'data-image-figure'?: string;\n    'data-json-ld'?: string;\n    itemprop?: string;\n}\n\nexport type JsonDataResolve = (data: IJsonData) => void;\n\nexport type WorkerPostMessage = (message: string | Uint8Array) => void;\n\nexport type IndexDbData = IWebComponentData | ISupport | ICustomElementName;\n\nexport type GetIndexedDbData<P extends IGetIndexedDbData> =\n    P['keyPath'] extends DbKeyPath.webComponent ? IWebComponentData | undefined :\n    P['keyPath'] extends DbKeyPath.support ? ISaveSupport :\n    P['keyPath'] extends DbKeyPath.customElementName ? ICustomElementName[] :\n    never;\n\nexport type DbKeyPathName = keyof typeof DbKeyPath;\n\nexport type DbStoreNameKey = keyof typeof DbStoreName;\n\nexport type AttributesKey = keyof IAttributes;\n\nexport type GetTemplate<P extends IGetTemplate> =\n    P['selector'] extends Selector.a ? HTMLAnchorElement :\n    P['selector'] extends  Selector.linkedDataCaptionElement ? HTMLSpanElement :\n    P['selector'] extends Selector.linkedDataCaption ? HTMLElement :\n    null;\n\ndeclare global {\n    interface Window extends TsLib {\n        VamtigerBrowserMethod: VamtigerBrowserMethod;\n        Babel: any;\n        EQCSS: IAnyObject;\n        requestIdleCallback?: typeof requestIdleCallback;\n        _: typeof lodash;\n    }\n\n    namespace NodeJS {\n        interface  Global {\n            VamtigerBrowserMethod: Window['VamtigerBrowserMethod'];\n        }\n    }\n}\n\nexport const regex = {\n    showRootHost: /:{1,2}host/gm,\n    dash: new RegExp(StringConstant.dash, 'g'),\n    space: /\\s/g,\n    nonWord: /\\W+/g,\n    backTicks: /`/gm,\n    remoteUrl: /^http(s)?/i,\n    jsJsonJs: /\\.js\\.json\\.js$/,\n    jsonJs: /\\.json\\.js$/,\n    trailingJs: /\\.js$/,\n    uppercase: /[A-Z]/,\n    leadingAt: /^@/,\n    email: /^email$/i,\n    textModeElement: new RegExp(\n        (Object.keys(TextModeElementName) as (keyof typeof TextModeElementName)[])\n            .map(key => TextModeElementName[key])\n            .join(StringConstant.pipe),\n        'i'\n    )\n}\n\nexport const selector = {\n    redundantScripts: [\n        Selector.vamtigerBrowserMethodJsonJs,\n        Selector.vamtigerBrowserMethodJson,\n        Selector.vamtigerBrowserMethod,\n        Selector.transpiledJs,\n        ...(Object.keys(Dependency) as DependencyKey[]).map(key => `[src=\"${Dependency[key]}\"]`)\n    ].join(StringConstant.comma)\n}\n\nexport const sendMessageFromWorker = postMessage as WorkerPostMessage;\n\nexport const ignore = () => {};","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global global, define, System, Reflect, Promise */\r\nvar __extends;\r\nvar __assign;\r\nvar __rest;\r\nvar __decorate;\r\nvar __param;\r\nvar __metadata;\r\nvar __awaiter;\r\nvar __generator;\r\nvar __exportStar;\r\nvar __values;\r\nvar __read;\r\nvar __spread;\r\nvar __await;\r\nvar __asyncGenerator;\r\nvar __asyncDelegator;\r\nvar __asyncValues;\r\nvar __makeTemplateObject;\r\nvar __importStar;\r\nvar __importDefault;\r\n(function (factory) {\r\n    var root = typeof global === \"object\" ? global : typeof self === \"object\" ? self : typeof this === \"object\" ? this : {};\r\n    if (typeof define === \"function\" && define.amd) {\r\n        define(\"tslib\", [\"exports\"], function (exports) { factory(createExporter(root, createExporter(exports))); });\r\n    }\r\n    else if (typeof module === \"object\" && typeof module.exports === \"object\") {\r\n        factory(createExporter(root, createExporter(module.exports)));\r\n    }\r\n    else {\r\n        factory(createExporter(root));\r\n    }\r\n    function createExporter(exports, previous) {\r\n        if (exports !== root) {\r\n            if (typeof Object.create === \"function\") {\r\n                Object.defineProperty(exports, \"__esModule\", { value: true });\r\n            }\r\n            else {\r\n                exports.__esModule = true;\r\n            }\r\n        }\r\n        return function (id, v) { return exports[id] = previous ? previous(id, v) : v; };\r\n    }\r\n})\r\n(function (exporter) {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\n    __extends = function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n\r\n    __assign = Object.assign || function (t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n\r\n    __rest = function (s, e) {\r\n        var t = {};\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n            t[p] = s[p];\r\n        if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n            for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n                t[p[i]] = s[p[i]];\r\n        return t;\r\n    };\r\n\r\n    __decorate = function (decorators, target, key, desc) {\r\n        var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n        if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n        else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n        return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n    };\r\n\r\n    __param = function (paramIndex, decorator) {\r\n        return function (target, key) { decorator(target, key, paramIndex); }\r\n    };\r\n\r\n    __metadata = function (metadataKey, metadataValue) {\r\n        if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n    };\r\n\r\n    __awaiter = function (thisArg, _arguments, P, generator) {\r\n        return new (P || (P = Promise))(function (resolve, reject) {\r\n            function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n            function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n            function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n            step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n        });\r\n    };\r\n\r\n    __generator = function (thisArg, body) {\r\n        var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n        return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n        function verb(n) { return function (v) { return step([n, v]); }; }\r\n        function step(op) {\r\n            if (f) throw new TypeError(\"Generator is already executing.\");\r\n            while (_) try {\r\n                if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n                if (y = 0, t) op = [op[0] & 2, t.value];\r\n                switch (op[0]) {\r\n                    case 0: case 1: t = op; break;\r\n                    case 4: _.label++; return { value: op[1], done: false };\r\n                    case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                    case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                    default:\r\n                        if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                        if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                        if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                        if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                        if (t[2]) _.ops.pop();\r\n                        _.trys.pop(); continue;\r\n                }\r\n                op = body.call(thisArg, _);\r\n            } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n            if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n        }\r\n    };\r\n\r\n    __exportStar = function (m, exports) {\r\n        for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n    };\r\n\r\n    __values = function (o) {\r\n        var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n        if (m) return m.call(o);\r\n        return {\r\n            next: function () {\r\n                if (o && i >= o.length) o = void 0;\r\n                return { value: o && o[i++], done: !o };\r\n            }\r\n        };\r\n    };\r\n\r\n    __read = function (o, n) {\r\n        var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n        if (!m) return o;\r\n        var i = m.call(o), r, ar = [], e;\r\n        try {\r\n            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n        }\r\n        catch (error) { e = { error: error }; }\r\n        finally {\r\n            try {\r\n                if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n            }\r\n            finally { if (e) throw e.error; }\r\n        }\r\n        return ar;\r\n    };\r\n\r\n    __spread = function () {\r\n        for (var ar = [], i = 0; i < arguments.length; i++)\r\n            ar = ar.concat(__read(arguments[i]));\r\n        return ar;\r\n    };\r\n\r\n    __await = function (v) {\r\n        return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n    };\r\n\r\n    __asyncGenerator = function (thisArg, _arguments, generator) {\r\n        if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n        var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n        return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n        function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n        function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n        function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }\r\n        function fulfill(value) { resume(\"next\", value); }\r\n        function reject(value) { resume(\"throw\", value); }\r\n        function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n    };\r\n\r\n    __asyncDelegator = function (o) {\r\n        var i, p;\r\n        return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n        function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n    };\r\n\r\n    __asyncValues = function (o) {\r\n        if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n        var m = o[Symbol.asyncIterator], i;\r\n        return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n        function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n        function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n    };\r\n\r\n    __makeTemplateObject = function (cooked, raw) {\r\n        if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n        return cooked;\r\n    };\r\n\r\n    __importStar = function (mod) {\r\n        if (mod && mod.__esModule) return mod;\r\n        var result = {};\r\n        if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n        result[\"default\"] = mod;\r\n        return result;\r\n    };\r\n\r\n    __importDefault = function (mod) {\r\n        return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n    };\r\n\r\n    exporter(\"__extends\", __extends);\r\n    exporter(\"__assign\", __assign);\r\n    exporter(\"__rest\", __rest);\r\n    exporter(\"__decorate\", __decorate);\r\n    exporter(\"__param\", __param);\r\n    exporter(\"__metadata\", __metadata);\r\n    exporter(\"__awaiter\", __awaiter);\r\n    exporter(\"__generator\", __generator);\r\n    exporter(\"__exportStar\", __exportStar);\r\n    exporter(\"__values\", __values);\r\n    exporter(\"__read\", __read);\r\n    exporter(\"__spread\", __spread);\r\n    exporter(\"__await\", __await);\r\n    exporter(\"__asyncGenerator\", __asyncGenerator);\r\n    exporter(\"__asyncDelegator\", __asyncDelegator);\r\n    exporter(\"__asyncValues\", __asyncValues);\r\n    exporter(\"__makeTemplateObject\", __makeTemplateObject);\r\n    exporter(\"__importStar\", __importStar);\r\n    exporter(\"__importDefault\", __importDefault);\r\n});\r\n","import * as tslib from '../node_modules/tslib/tslib';\nimport { TsLibKey } from './types';\n\nconst tsLibKeys = Object.keys(tslib) as TsLibKey[];\n\ntsLibKeys.forEach(key => {\n    if (!self[key]) {\n        self[key] = tslib[key];\n    }\n});","import {\n    IGetMetaElement,\n    StringConstant,\n    Selector\n} from './types';\n\nconst { nothing } = StringConstant;\n\nexport default function ({ selector = nothing, properties = {}, dataset = {}, attributes = {}}: IGetMetaElement) {\n    const { id } = properties;\n    const { head } = document;\n    const lastMetaElement = head.querySelector<HTMLMetaElement>(Selector.lastMetaElement);\n    const attributeKeys = Object.keys(attributes);\n    const existingMetaElement = id && ((window as any)[id]\n        || selector && head.querySelector(selector)) as HTMLMetaElement;\n    const newMetaElment = !existingMetaElement && document.createElement('meta');\n    const metaElement = (existingMetaElement || newMetaElment) as HTMLMetaElement;\n\n    let dataKey: string;\n\n    if (newMetaElment) {\n        Object.assign(newMetaElment, properties);\n        Object.assign(newMetaElment.dataset, dataset);\n\n        if (lastMetaElement && lastMetaElement.nextElementSibling) {\n            head.insertBefore(\n                newMetaElment,\n                lastMetaElement.nextElementSibling\n            );\n        } else {\n            head.appendChild(newMetaElment);\n        }\n    }\n\n    attributeKeys.forEach(key => !metaElement.hasAttribute(key) && metaElement.setAttribute(dataKey, attributes[key]));\n\n    return metaElement;\n}","import {\n    ILoadElementQueryCss,\n    MetaElementName,\n    StringConstant,\n    regex\n} from './types';\nimport getMetaElment from './get-meta-element';\n\nconst { requestIdleCallback } = self;\nconst { showRootHost } = regex;\nconst { nothing } = StringConstant;\n\nexport default function(params: ILoadElementQueryCss) {return new Promise(async (resolve, reject) => {\n    if (requestIdleCallback) {\n        requestIdleCallback(() => loadElementQueryCss(params).then(resolve).catch(reject));\n    } else {\n        setTimeout(() => loadElementQueryCss(params).then(resolve).catch(reject), 0);\n    }\n})}\n\nasync function loadElementQueryCss({ css, stylesheetName: currentStylesheetName = nothing, hostName = nothing }: ILoadElementQueryCss) {\n    const { _ } = self;\n    const { camelCase } = _;\n    const metaElement = getMetaElment({\n        properties: {\n            id: MetaElementName.loadElementQueryCss\n        }\n    });\n    const stylesheetName = camelCase(currentStylesheetName);\n    const { dataset } = metaElement;\n    const elementQueryCss = !dataset.hasOwnProperty(hostName) && (hostName && css.replace(showRootHost, hostName)) || css;\n    const { EQCSS } = self;\n\n    if (elementQueryCss && EQCSS) {\n        EQCSS.register(EQCSS.parse(elementQueryCss));\n\n        if (stylesheetName) {\n            dataset[stylesheetName] = nothing;\n        } else if (hostName) {\n            dataset[hostName] = nothing;\n        }\n    }\n\n    return true;\n}","import {\n    StringConstant,\n    Dependency\n} from './types';\n\nconst { slash } = StringConstant;\n\nexport const babel = {\n    presets: ['es2015']\n};\n\nexport const jsonLdEntryValueType = new Set([\n    typeof 1,\n    typeof '',\n    typeof true\n]);\n\nexport const dependencyPaths = Array.from(new Set([\n    'lodash/lodash.min.js'\n]));\n\nexport const getDependencies = () => [\n    !self._ && Dependency.lodash || ''\n].filter(dependency => dependency);","import {\n    IGetBabelJs,\n    IAnyObject,\n    ScriptType,\n    ScriptAttribute,\n    StringConstant\n} from './types';\nimport { babel } from './config';\n\nconst { nothing } = StringConstant;\n\nexport default async function ({ url, js }: IGetBabelJs) {\n    const { fetch, Babel } = self;\n    const { transform } = Babel || { transform: undefined }\n    const code = transform && (js || url && await fetch(url)\n        .then(response => response && response.text())\n        .catch(handleError));\n    const { code: transpiledCode } = code && code.trim() && transform && transform(code, babel) || { code: '' };\n    const transpiledJs: string = transpiledCode || js;\n\n    return transpiledJs;\n}\n\nfunction handleError(error: Error) {\n    const transpiledJs = '';\n\n    console.warn(error.message);\n    console.warn(error.stack);\n\n    return transpiledJs;\n}","import {\n    Environment\n} from './types';\n\nexport default function () {\n    const { VamtigerBrowserMethod } = self;\n    const { environment } = VamtigerBrowserMethod;\n    const isWindow = environment === Environment.window;\n\n    return isWindow;\n}","import {\n    Environment\n} from './types';\n\nexport default function () {\n    const { VamtigerBrowserMethod } = self;\n    const { environment } = VamtigerBrowserMethod;\n    const isWorker = environment === Environment.worker;\n\n    return isWorker;\n}","import {\n    IMessageAction,\n    ISupport,\n    sendMessageFromWorker\n} from './types';\nimport isWindow from './is-window';\nimport isWorker from './is-worker';\n\nconst { stringify } = JSON;\nconst textEncoder = new TextEncoder();\n\nexport default function (params: IMessageAction) {\n    const { VamtigerBrowserMethod } = self;\n    const { worker, support } = VamtigerBrowserMethod;\n    const { textEncoder: textEncoderSupport } = support || {} as ISupport;\n    const stringMessage = stringify(params);\n    const message = textEncoderSupport && textEncoder.encode(stringMessage)\n        || stringMessage;\n\n    isWindow() && worker && worker.postMessage(message);\n\n    isWorker() && sendMessageFromWorker(message)\n}","import {\n    IIsJsonScript\n} from './types';\n\nconst { parse } = JSON;\n\nexport default function ({ script }: IIsJsonScript) {\n    const { innerHTML } = script;\n\n    let isJson = false;\n\n    try {\n        parse(innerHTML);\n        isJson = true;\n    } catch(error) {\n        console.warn(error);\n        isJson = false;\n    }\n\n    return isJson;\n}","import {\n    MessageAction,\n    IRemoveRedundantScripts,\n    IRemoveRedundantScriptsRemoveScripts,\n    IRemoveRedundantScriptsRemoveScriptsFromParent,\n    StringConstant,\n    ScriptType,\n    Prefix\n} from './types';\nimport isWindow from './is-window';\nimport isWorker from './is-worker';\nimport sendMessage from './send-message';\nimport isJsonScript from './is-json-script';\n\nconst { requestIdleCallback } = self;\nconst { dash } = StringConstant;\nconst { vamtigerBrowserMethod: prefix } = Prefix;\n\nexport default async function (params: IRemoveRedundantScripts) {\n    isWindow() && await removeRedundantScripts(params);\n\n    isWorker() && sendRemoveRedundantScriptsMessage(params);\n}\n\nasync function removeRedundantScripts(params: IRemoveRedundantScripts) {\n    const { head: parent } = document;\n\n    await removeScripts({...params, parent});\n}\n\nexport function removeScripts(params: IRemoveRedundantScriptsRemoveScripts) {return new Promise((resolve, reject) => {\n    if (requestIdleCallback) {\n        requestIdleCallback(() => removeScriptsFromParent({...params, resolve, reject }));\n    } else {\n        setTimeout(() => removeScriptsFromParent({...params, resolve, reject }), 0);\n    }\n})}\n\nexport function removeDuplicateScripts(params: IRemoveRedundantScriptsRemoveScripts) {return new Promise((resolve, reject) => {\n    if (requestIdleCallback) {\n        requestIdleCallback(() => removeDuplicateScriptsFromParent({...params, resolve, reject }));\n    } else {\n        setTimeout(() => removeDuplicateScriptsFromParent({...params, resolve, reject }), 0);\n    }\n})}\n\nfunction removeDuplicateScriptsFromParent({resolve, reject, selector, parent}: IRemoveRedundantScriptsRemoveScriptsFromParent) {\n    const duplicateScripts = Array.from(parent.querySelectorAll<HTMLScriptElement>(selector));\n\n    duplicateScripts.pop();\n\n    duplicateScripts.forEach(duplicateScript => parent.removeChild(duplicateScript));\n\n    resolve && resolve();\n}\n\nfunction removeScriptsFromParent({ selector, parent, resolve, reject }: IRemoveRedundantScriptsRemoveScriptsFromParent) {\n    const { head } = document;\n    const scripts = Array.from(parent.querySelectorAll<HTMLScriptElement>(selector));\n    const jsScripts = scripts.filter(({type, src}) => src || !type || type === ScriptType.js);\n    const jsonScripts = scripts\n        .filter(({ type }) => type === ScriptType.json)\n        .filter(script => isJsonScript({ script }));\n    const jsonLdScripts = scripts\n        .filter(({ type }) => type === ScriptType.jsonld)\n        .filter(script => isJsonScript({ script }));\n    const safeScripts = jsonLdScripts.concat(jsonScripts);\n    const time = new Date().getTime();\n    const jsonScriptName = jsonScripts.length && [\n        prefix,\n        ScriptType.json,\n        time\n    ].join(dash);\n    const jsonScriptSelector = jsonScriptName && `script[type=\"${ScriptType.json}\"][data-name=\"${jsonScriptName}\"]`;\n    const jsonLdScriptName = jsonLdScripts.length && [\n        prefix,\n        ScriptType.jsonld,\n        time\n    ].join(dash);\n    const jsonLdScriptSelector = jsonLdScriptName && `script[type=\"${ScriptType.jsonld}\"][data-name=\"${jsonLdScriptName}\"]`;\n\n    jsScripts.length && jsonScriptName && jsScripts.forEach(({ dataset }) => dataset.name = jsonScriptName || '');\n\n    jsonLdScripts.length && jsonLdScriptName && jsonLdScriptSelector && jsonLdScripts.forEach(({ dataset }) => dataset.name = jsonLdScriptName || '');\n\n    if (jsonScriptSelector && parent !== head) {\n        parent.dataset.json = jsonScriptSelector;\n    }\n\n    if (jsonLdScriptSelector && parent !== head) {\n        parent.dataset.jsonLd = jsonLdScriptSelector;\n    }\n\n    if (scripts.length) {\n        parent.dataset.removedScripts = (Number(parent.dataset.removedScripts || 0) + scripts.length).toString();\n    }\n\n    safeScripts.forEach(script => head.appendChild(script));\n\n    scripts.forEach(script => parent.removeChild(script));\n\n    resolve && resolve();\n}\n\nexport function sendRemoveRedundantScriptsMessage({ selector }: IRemoveRedundantScripts) {\n    const massage = {\n        action: MessageAction.removeRedundantScripts,\n        params: {\n            selector\n        }\n    };\n\n    sendMessage(massage);\n}","import {\n    ILoadScript,\n    ILoadScriptLoadJsJsonJs,\n    ErrorMessage,\n    LocalScriptParams,\n    LocalStylesheetScriptParams,\n    ILoadRemoteStylesheetScriptParams,\n    ILoadRemoteScriptParams,\n    ILoadJsonScriptParams,\n    LoadScriptElement,\n    LoadedScript,\n    LinkRel,\n    ScriptAttribute,\n    ScriptType,\n    StringConstant,\n    regex,\n    Selector\n} from './types';\nimport loadElementQueryCss from './load-element-query-css';\nimport getTranspiledJs from './get-transpiled-js';\nimport removeRedundantScripts from './remove-redundant-scripts';\n\nconst { parse } = JSON;\nconst { failedToLoadScript } = ErrorMessage;\nconst { stylesheet } = LinkRel;\nconst { script: scriptElement, link, style } = LoadScriptElement;\nconst { remoteUrl, jsJsonJs, jsonJs, trailingJs } = regex;\nconst { nothing, slash } = StringConstant;\n\nexport default function<P extends ILoadScript['params']>(params: P) {\n    return loadScript(params);\n}\n\nfunction loadScript<P extends ILoadScript['params']>(params: P) {return new Promise(async (resolve: (script: LoadedScript<P>) => void, reject: ILoadScript['reject']) => {\n    const { head, body } = document;\n    const {\n        js,\n        name: scriptName,\n        jsonld,\n        removeFromDom,\n        workerDependency = false\n    } = params as LocalScriptParams;\n    const { src } = params as ILoadRemoteScriptParams;\n    const transpiledJs = (js || src && !src.match(remoteUrl)) && await getTranspiledJs({ js, url: src}) || '';\n    const { css, name: stylesheetName } = params as LocalStylesheetScriptParams;\n    const { href } = params as ILoadRemoteStylesheetScriptParams;\n    const { json } = params as ILoadJsonScriptParams;\n    const remoteScript = params.hasOwnProperty('src') || params.hasOwnProperty('href');\n    const element = (js || json|| src) && scriptElement\n        || css && style\n        || href && link;\n    const selector = src && `script[src=\"${src}\"]`\n        || href && `link[href=\"${href}\"]`\n        || js && scriptName && `script[data-name=\"${scriptName}\"]`\n        || jsonld && scriptName && `script[data-name=\"${scriptName}\"][type=\"${ScriptType.jsonld}\"]`\n        || css && stylesheetName && `style[data-name=\"${stylesheetName}\"]`;\n    const existingScript = (head.querySelector(selector) || body.querySelector(selector)) as LoadedScript<P>;\n    const script = selector\n        && element\n        && document.createElement(element) as LoadedScript<P>;\n\n    if (script instanceof HTMLScriptElement) {\n        if (!transpiledJs && src) {\n            script.src = src;\n        } else if (json || transpiledJs || js) {\n            script.innerHTML = json || transpiledJs || js;\n            script.dataset.name = scriptName || src;\n\n            if (jsonld) {\n                script.setAttribute(ScriptAttribute.type, ScriptType.jsonld);\n\n                script.dataset.jsonLd = script.dataset.name;\n            } else if (json) {\n                script.setAttribute(ScriptAttribute.type, ScriptType.json);\n            } else if (transpiledJs) {\n                script.dataset.transpiledJs = nothing;\n            }\n        }\n    } else if (script instanceof HTMLLinkElement) {\n        script.rel = stylesheet;\n        script.href = href;\n    } else if (script instanceof HTMLStyleElement) {\n        script.innerHTML = css;\n        script.dataset.name = stylesheetName;\n\n        await loadElementQueryCss({\n            css,\n            stylesheetName\n        });\n    }\n\n    if (existingScript) {\n        resolve(existingScript);\n    } else if (script) {\n        script.addEventListener('load', handleLoad);\n        script.addEventListener('error', handleLoadError);\n\n        head.appendChild(script);\n\n        if (workerDependency) {\n            script.dataset.workerDependency = nothing;\n        }\n\n        if (transpiledJs || !remoteScript) {\n            handleLoad();\n        }\n    }\n\n    async function handleLoad() {\n        if (script) {\n            removeEventListeners();\n\n            if (removeFromDom) {\n                head.removeChild(script);\n            }\n\n            if(src && src.match(jsJsonJs)){\n                await loadJsJsonJs({ src, workerDependency });\n            }\n\n            resolve(script);\n        }\n    }\n\n    function handleLoadError(event: Event) {\n        removeEventListeners();\n\n        console.error(event);\n\n        reject(new Error(`${failedToLoadScript}`));\n    }\n\n    function removeEventListeners() {\n        if (script) {\n            script.removeEventListener('load', handleLoad);\n            script.removeEventListener('error', handleLoadError);\n        }\n    }\n})};\n\nasync function loadJsJsonJs({ src, workerDependency }: ILoadScriptLoadJsJsonJs) {\n    const { head } = document;\n    const paths = src\n        .replace(trailingJs, nothing)\n        .split(slash);\n    const scriptName = paths[paths.length - 1];\n    const selector = src && scriptName && `script[type=\"${ScriptType.json}\"][data-name=\"${scriptName}\"]`;\n    const jsJsonJsScript = selector && head.querySelector<HTMLScriptElement>(selector);\n    const json = jsJsonJsScript && jsJsonJsScript.innerHTML && parse(jsJsonJsScript.innerHTML);\n    const js: string = json && json.text;\n    const name = src.replace(jsonJs, nothing);\n    const removeScriptSelector = [\n        `script[src=\"${src}\"]`,\n        selector,\n        Selector.transpiledJs\n    ].join(StringConstant.comma);\n\n    if (name && js) {\n        await loadScript({ name, js, workerDependency }).catch(handleError);\n\n        await removeRedundantScripts({selector: removeScriptSelector});\n    }\n}\n\nfunction handleError(error: Error) {\n    console.warn(error.name);\n    console.warn(error.message);\n    console.warn(error.stack);\n}","import {\n    IGetDbParams,\n    IGetDbParamsHandleUpgradeNeeded,\n    IDbParams,\n    DbName,\n    DbStoreName,\n    DbStoreNameKey,\n    DbKeyPathName,\n    DbKeyPath\n} from './types';\n\nconst { vamtigerBrowserSupport: dbName } = DbName;\n\nexport default async function (params: IGetDbParams) {\n    const { storeName, keyPath, mode } = params;\n    const db = await getDb();\n    const transaction = db && db.transaction && db.transaction(storeName, mode);\n    const store = transaction && transaction.objectStore && transaction.objectStore(storeName);\n    const dbParams: IDbParams = {\n        db,\n        transaction,\n        store\n    };\n\n    return dbParams;\n}\n\nexport function getDb() {return new Promise((resolve: (db: IDBDatabase) => void, reject) => {\n    const dbRequest = indexedDB.open(dbName, 1);\n\n    dbRequest.addEventListener('error', reject);\n\n    dbRequest.addEventListener('upgradeneeded', () => handleUpgradeNeeded({ db: dbRequest.result }));\n\n    dbRequest.addEventListener('success', () => resolve(dbRequest.result));\n})}\n\nfunction handleUpgradeNeeded({ db }: IGetDbParamsHandleUpgradeNeeded) {\n    const storeNames = Object.keys(DbKeyPath);\n\n    storeNames.forEach(storeName => !db.objectStoreNames.contains(storeName) && db.createObjectStore(DbStoreName[storeName as DbStoreNameKey], {\n        keyPath: DbKeyPath[storeName as DbKeyPathName]\n    }));\n}","import {\n    ISaveIndexedDbData,\n    ISaveIndexedDbDataHandleSuccess,\n    DbMode,\n    MessageAction\n} from './types';\nimport getDbParams from './get-db-params';\nimport sendMessage from './send-message';\n\nconst { readwrite: mode } = DbMode;\n\nexport default async function ({ storeName, keyPath, data, messageId, successAction: action }: ISaveIndexedDbData) {\n    const { store } = await getDbParams({\n        storeName,\n        keyPath,\n        mode\n    });\n    const save = store.put(data);\n\n    save.addEventListener('error', handleError);\n    save.addEventListener('success', () => handleSuccess({ messageId, key: keyPath, action, data }));\n}\n\nfunction handleSuccess(params: ISaveIndexedDbDataHandleSuccess) {\n    const {\n        action,\n        data\n    } = params;\n    const message = action && {\n        action,\n        params: {\n            ...params,\n            ...data\n        }\n    };\n\n    message && sendMessage(message);\n}\n\nfunction handleError(error: Event) {\n    console.error(error);\n    throw error;\n}","import {\n    IGetIndexedDbData,\n    GetIndexedDbData,\n    DbMode\n} from './types';\nimport getDbParams from './get-db-params';\n\nconst { readonly: mode } = DbMode;\n\nexport default async function <P extends IGetIndexedDbData>({ storeName, keyPath, key }: P): Promise<GetIndexedDbData<P>> {return new Promise(async (resolve, reject) => {\n    const { store } = await getDbParams({\n        storeName,\n        keyPath,\n        mode\n    });\n    const get = key && store.get(key) || store.getAll();\n\n    get.addEventListener('error', reject);\n    get.addEventListener('success', () => resolve(get.result));\n})}","import {\n    ILoadScript,\n    LocalScriptParams,\n    LocalStylesheetScriptParams\n} from './types';\nimport loadScript from './load-script';\nimport isWindow from './is-window';\n\nexport default async function<P extends ILoadScript['params']>(params: P) {return new Promise((resolve, reject) => {\n    const { requestIdleCallback } = self;\n\n    if (requestIdleCallback) {\n        requestIdleCallback(() => isWindow() && loadScriptWindow(params).then(resolve).catch(reject));\n    } else {\n        setTimeout(() => isWindow() && loadScriptWindow(params).then(resolve).catch(reject), 0);\n    }\n})}\n\nasync function loadScriptWindow<P extends ILoadScript['params']>(params: P) {return new Promise(async (resolve, reject) => {\n    const { head } = document;\n    const { name, removeExisting } = params as LocalScriptParams;\n    const selector = name && removeExisting && `[data-name=\"${name}\"]`;\n    const existingScript = selector && head.querySelector<HTMLElement>(selector);\n    const ignore = existingScript && existingScript.innerHTML === ((params as LocalStylesheetScriptParams).css || (params as LocalScriptParams).js);\n\n    try {\n        !ignore && await loadScript(params);\n\n        resolve();\n    } catch(error) {\n        reject(error);\n    }\n});}","import {\n    MessageAction,\n    DbKeyPath,\n    DbStoreName,\n    Selector,\n    StringConstant,\n    ScriptName,\n    regex\n} from './types';\nimport isWindow from './is-window';\nimport isWorker from './is-worker';\nimport sendMessage from './send-message';\nimport getData from './get-indexed-db-data';\nimport loadScript from './handle-load-script';\n\nconst { customElementName: keyPath } = DbKeyPath;\nconst { customElementName: storeName } = DbStoreName;\nconst { comma, semiColon, nothing } = StringConstant;\nconst { textModeElement } = regex;\n\nexport default function() {\n    isWindow() && getTextModeCssWindow();\n    isWorker() && getTextModeCssWorker();\n}\n\nfunction getTextModeCssWindow() {\n    const { VamtigerBrowserMethod } = self;\n    const { support, workerSupport } = VamtigerBrowserMethod;\n    const message = workerSupport && workerSupport.indexedDbIsAccessible && {\n        action: MessageAction.getTextModeCss,\n        params: {}\n    };\n\n    if (message) {\n        sendMessage(message);\n    } else {\n        getTextModeCssFromMetaElement()\n    }\n}\n\nasync function getTextModeCssWorker() {\n    const customElementNames = await getData({\n        storeName,\n        keyPath\n    }) || [];\n    const names = customElementNames.map(({ name }) => name);\n    const css = getCss(names);\n    const message = css && {\n        action: MessageAction.loadScript,\n        params: {\n            name: ScriptName.textMode,\n            css,\n            removeExisting: true\n        }\n    };\n\n    message && sendMessage(message);\n}\n\nfunction getTextModeCssFromMetaElement() {\n    const { VamtigerBrowserMethod } = self;\n    const { metaElement } = VamtigerBrowserMethod;\n    const customElementMetaElement = metaElement && metaElement.querySelector<HTMLMetaElement>(Selector.customElementNameMetaElement);\n    const names = customElementMetaElement && (Array\n        .from(customElementMetaElement.children) as HTMLMetaElement[])\n        .map(({ dataset }) => dataset.name || '')\n        .filter(name => name)\n        || [];\n    const css = getCss(names);\n    const params = css && {\n        name: ScriptName.textMode,\n        css,\n        removeExisting: true\n    };\n\n    params && loadScript(params);\n}\n\nfunction getCss(names: string[]) {\n    const selector = names\n        .filter(name => !name.match(textModeElement))\n        .map(name => `${Selector.htmlTextMode} ${name}`)\n        .join(comma);\n    const cssBody = selector && [\n        'display: none'\n    ].join(semiColon);\n    const css = selector && cssBody && [\n        selector,\n        '{',\n        cssBody,\n        '}'\n    ].join(nothing);\n\n    return css;\n}","import {\n    ISaveCustomeElementName,\n    DbKeyPath,\n    DbStoreName,\n    MessageAction,\n    Selector\n} from './types';\nimport isWindow from './is-window';\nimport isWorker from './is-worker';\nimport sendMessage from './send-message';\nimport save from './save-indexed-db-data';\nimport getTextModeCss from './get-text-mode-css';\n\nconst { customElementName: keyPath } = DbKeyPath;\nconst { customElementName: storeName } = DbStoreName;\n\nexport default function (params: ISaveCustomeElementName) {\n    isWindow() && saveCustomElementNameWindow(params);\n\n    isWorker() && saveCustomElementNameWorker(params)\n}\n\nfunction saveCustomElementNameWindow(params: ISaveCustomeElementName) {\n    const { VamtigerBrowserMethod } = self;\n    const { support, workerSupport } = VamtigerBrowserMethod;\n    const message = workerSupport && workerSupport.indexedDbIsAccessible && {\n        action: MessageAction.saveCustomElementName,\n        params\n    };\n\n    if (message) {\n        sendMessage(message);\n    } else if (support && support.indexedDbIsAccessible) {\n        saveCustomElementNameWindowIndexDb(params);\n    } else {\n        saveCustomeElementNameDocument(params);\n    }\n}\n\nfunction saveCustomElementNameWorker(params: ISaveCustomeElementName) {\n    saveCustomElementNameIndexDb(params);\n}\n\nfunction saveCustomElementNameIndexDb(params: ISaveCustomeElementName) {\n    const { name } = params;\n    const saveParams = name && {\n        storeName,\n        keyPath,\n        data: {\n            name,\n            ...params\n        },\n        successAction: MessageAction.getTextModeCss\n    };\n\n    saveParams && save(saveParams);\n}\n\nasync function saveCustomElementNameWindowIndexDb(params: ISaveCustomeElementName) {\n    const { name } = params;\n    const saveParams = name && {\n        storeName,\n        keyPath,\n        data: {\n            name,\n            ...params\n        }\n    };\n\n    saveParams && await save(saveParams);\n\n    getTextModeCss();\n}\n\nfunction saveCustomeElementNameDocument({name}: ISaveCustomeElementName) {\n    const { VamtigerBrowserMethod } = self;\n    const { metaElement } = VamtigerBrowserMethod;\n    const customElementMetaElement = metaElement && metaElement.querySelector<HTMLMetaElement>(Selector.customElementNameMetaElement);\n    const selector = customElementMetaElement && `meta[data-name=\"${name}\"]`;\n    const existingMetaElement = selector && customElementMetaElement && customElementMetaElement.querySelector<HTMLMetaElement>(selector);\n    const newMetaElement = !existingMetaElement && document.createElement('meta');\n\n    if (customElementMetaElement && newMetaElement) {\n        newMetaElement.dataset.name = name;\n\n        customElementMetaElement.appendChild(newMetaElement);\n\n        getTextModeCss();\n    }\n}","import {\n    IDefineCustomElement,\n    ErrorMessage,\n    ignore as doNothing\n} from './types';\nimport saveCustomElementName from './save-custom-element-name';\n\nconst { unsupportedFeature } = ErrorMessage;\n\nexport default function defineCustomElement({ name, constructor, ignore }: IDefineCustomElement) {\n    const { customElements } = self;\n    const define = customElements && customElements.define;\n    const existingElement = define && customElements.get && customElements.get(name);\n\n    if (define && !existingElement) {\n        customElements.define(name, constructor);\n        saveCustomElementName({name});\n    } else if (existingElement) {\n        doNothing();\n    } else if (!ignore) {\n        defineCustomElement({ name, constructor, ignore: true });\n    } else {\n        throw new Error(`${unsupportedFeature}: Custom Elements - ${name}`);\n    }\n}","import { IPause } from './types';\n\nexport default ({ milliseconds = 1000 }: IPause) => new Promise((resolve, reject) => setTimeout(resolve, milliseconds));","\nimport {\n    ILoadContainerStylesheets,\n    ScriptNameSuffix,\n    StringConstant,\n    Selector\n} from './types';\nimport loadScript from './load-script'\n\nconst { dash } = StringConstant;\n\nexport default function(params: ILoadContainerStylesheets) { return new Promise((resolve: (styleElements: HTMLStyleElement[]) => void, reject) => {\n    const { requestIdleCallback } = self;\n\n    if (requestIdleCallback) {\n        requestIdleCallback(() => loadStylesheets(params, resolve).catch(reject));\n    } else {\n        setTimeout(() => loadStylesheets(params, resolve).catch(reject), 0);\n    }\n})};\n\nasync function loadStylesheets(params: ILoadContainerStylesheets, resolve: (styleElements: HTMLStyleElement[]) => void) {\n    const { container, name } = params;\n    const styles = Array\n        .from(container.content.querySelectorAll<HTMLStyleElement>(Selector.style))\n        .map((style, index) => ({\n            name: [\n                name,\n                ScriptNameSuffix.style,\n                index++\n            ].join(dash),\n            css: style.innerHTML\n        }));\n    const stylesheets = Array\n        .from(container.content.querySelectorAll<HTMLLinkElement>(Selector.stylesheet))\n        .map((stylesheet, index) => ({\n            name: [\n                name,\n                ScriptNameSuffix.stylesheet,\n                index++\n            ].join(dash),\n            href: stylesheet.href\n        }));\n    const styleElements = await Promise.all([\n        ...styles.map(loadScript),\n        ...stylesheets.map(loadScript)\n    ]);\n\n    resolve(styleElements);\n}","import {\n    IGetElementTemplate,\n    TagName,\n    ErrorMessage\n} from './types';\nimport loadContainerStylesheets from './load-container-stylesheets';\n\nconst {\n    noElementName,\n    noTemplate,\n    noElementForSelector\n} = ErrorMessage;\n\nexport default async function (params: IGetElementTemplate) {\n    const { name, template, loadStylesheets, selector } = params;\n    const container = name && template && document.createElement(TagName.template);\n\n    let element: HTMLElement | null = null;\n\n    if (!name) {\n        throw new Error(noElementName);\n    } else if (!template) {\n        throw new Error(noTemplate);\n    }\n\n    if (container) {\n        container.innerHTML = template;\n\n        element = selector && container.content.firstElementChild && container.content.firstElementChild.querySelector(selector)\n            || container.content.firstElementChild as HTMLElement;\n\n        loadStylesheets && element && await loadContainerStylesheets({\n            ...params,\n            container\n        });\n    }\n\n    if (!element) {\n        throw new Error(noElementForSelector);\n    }\n\n    element.dataset.name = name;\n\n    return element;\n}","import {\n    IGetElementUrl,\n    TagName,\n    ErrorMessage\n} from './types';\nimport loadContainerStylesheets from './load-container-stylesheets';\n\nconst {\n    noElementName,\n    noElementSelector,\n    noTemplateUrl,\n    noTemplateForUrl,\n    noElementForSelector\n} = ErrorMessage;\n\nexport default async function (params: IGetElementUrl) {\n    const { name, url, selector, loadStylesheets } = params;\n    const { head } = document;\n    const template = name && selector && url && await fetch(url)\n        .then(response => response.text());\n    const container = template && document.createElement(TagName.template);\n\n    let element: HTMLElement | null = null;\n\n    if (!name) {\n        throw new Error(noElementName);\n    } else if (!selector) {\n        throw new Error(noElementSelector);\n    } else if (!url) {\n        throw new Error(noTemplateUrl);\n    } else if (!template) {\n        throw new Error(noTemplateForUrl);\n    }\n\n    if (container) {\n        container.innerHTML = template;\n\n        element = container.content.querySelector<HTMLElement>(selector);\n\n        loadStylesheets && element && await loadContainerStylesheets({\n            ...params,\n            container\n        });\n    }\n\n    if (!element) {\n        throw new Error(noElementForSelector);\n    }\n\n    element.setAttribute('dataset-name', name);\n\n    return element;\n}\n","import {\n    GetElementParams,\n    IGetElementTemplate,\n    IGetElementUrl,\n    Selector\n} from './types';\nimport getElementFromTemplate from './get-element-from-template';\nimport getElementFromUrl from './get-element-from-url';\nimport { removeScripts } from './remove-redundant-scripts';\n\nconst { script: selector } = Selector;\n\nexport default async function<P extends GetElementParams>(params: P) { return new Promise((resolve: (element: HTMLElement) => void, reject) => {\n    const { requestIdleCallback } = self;\n\n    if (requestIdleCallback) {\n        requestIdleCallback(() => getElement(params, resolve).catch(reject));\n    } else {\n        setTimeout(() => getElement(params, resolve).catch(reject), 0);\n    }\n})}\n\nexport async function getElement<P extends GetElementParams> (params: P, resolve: (element: HTMLElement) => void) {\n    let element: HTMLElement;\n\n    if ((params as IGetElementUrl).url) {\n        element = await getElementFromUrl(params as IGetElementUrl);\n    } else {\n        element = await getElementFromTemplate(params as IGetElementTemplate);\n    }\n\n    element && await removeScripts({ selector, parent: element });\n\n    resolve(element);\n}","import {\n    IQueue,\n    IMessageQueueEntry,\n    IQueueHandleExpiredQueueEntry,\n    TimeoutDuration\n} from './types';\n\nconst { webComponent: timeout } = TimeoutDuration;\n\nexport default function ({key, resolve, reject }: IQueue) {\n    const { VamtigerBrowserMethod } = self;\n    const queueEntry = {\n        resolve,\n        reject\n    };\n    const { messageQueue } = VamtigerBrowserMethod;\n\n    let queue: Set<IMessageQueueEntry> | undefined;\n\n    !messageQueue.has(key) && messageQueue.set(key, new Set());\n\n    queue = messageQueue.get(key);\n\n    queue && queue.add(queueEntry);\n\n    setTimeout(() => handleExpiredQueueEntry({ key, queueEntry }), timeout)\n}\n\nfunction handleExpiredQueueEntry({ key, queueEntry }: IQueueHandleExpiredQueueEntry) {\n    const { VamtigerBrowserMethod } = self;\n    const { messageQueue } = VamtigerBrowserMethod;\n    const queue = messageQueue.get(key);\n\n    if (queue) {\n        queue.has(queueEntry) && queue.delete(queueEntry);\n\n        !queue.size && messageQueue.delete(key);\n    }\n}\n","import {\n    IDequeue\n} from './types';\n\nexport default function ({ key, data }: IDequeue) {\n    const { VamtigerBrowserMethod } = self;\n    const { messageQueue } = VamtigerBrowserMethod;\n    const queue = messageQueue.get(key) || new Set();\n\n    Array.from(queue).forEach((queueEntry) => {\n        queueEntry.resolve(data);\n\n        queue.delete(queueEntry);\n    });\n}","import {\n    IGetWebComponentData,\n    MessageAction,\n    DbKeyPath,\n    DbStoreName,\n    ScriptType\n} from './types';\nimport isWindow from './is-window';\nimport isWorker from './is-worker';\nimport sendMessage from './send-message';\nimport getData from './get-indexed-db-data';\nimport dequeue from './dequeue';\n\nconst { getWebComponentData: action } = MessageAction;\nconst { parse } = JSON;\n\nexport default function (params: IGetWebComponentData) {\n    const { VamtigerBrowserMethod } = self;\n    const { support, workerSupport, worker } = VamtigerBrowserMethod;\n\n    if (isWindow()) {\n        if (worker && workerSupport && workerSupport.indexedDbIsAccessible) {\n            return getWebComponentDataWindowWorker(params);\n        } else if (worker && support && support.indexedDbIsAccessible) {\n            getWebComponentDataWindow(params);\n        } else {\n            getWebComponentDataHead(params);\n        }\n    } else if (isWorker()) {\n        return getWebComponentDataWorker(params);\n    }\n}\n\nexport async function getWebComponentDataWindow({ key }: IGetWebComponentData) {\n    const data = await getWebComponentData({ key });\n    const dequeueParams = data && {\n        key,\n        data\n    };\n\n    if (dequeueParams) {\n        dequeue(dequeueParams);\n    }\n}\n\nasync function getWebComponentDataWindowWorker({ key }: IGetWebComponentData) {\n    const message = {\n        action,\n        params: {\n            key\n        }\n    };\n\n    sendMessage(message);\n}\n\nexport async function getWebComponentDataWorker({ key }: IGetWebComponentData) {\n    const webComponent = await getWebComponentData({ key });\n    const message = webComponent && webComponent.jsonLd && webComponent.jsonLd.length && {\n        action: MessageAction.dequeue,\n        params: {\n            key,\n            data: {\n                jsonLd: webComponent.jsonLd,\n                json: webComponent.json\n            }\n        }\n    };\n\n    return message;\n}\n\nexport async function getWebComponentData({ key }: IGetWebComponentData) {\n    const webComponentData = await getData({\n        storeName: DbStoreName.webComponent,\n        keyPath: DbKeyPath.webComponent,\n        key\n    });\n\n    return webComponentData;\n}\n\nfunction getWebComponentDataHead({ key }: IGetWebComponentData) {\n    const { head } = document;\n    const jsonLdSelector = `script[data-json-ld=\"${key}\"][type=\"${ScriptType.jsonld}\"]`;\n    const jsonSelector = `script[data-json-ld=\"${key}\"][type=\"${ScriptType.json}\"]`;\n    const jsonLdScripts = Array.from(head.querySelectorAll<HTMLScriptElement>(jsonLdSelector));\n    const jsonScript = head.querySelector<HTMLScriptElement>(jsonSelector);\n    const data = jsonLdScripts.length && {\n        jsonLd: jsonLdScripts.map(({innerHTML}) => innerHTML && parse(innerHTML)),\n        json: jsonScript && jsonScript.innerHTML && parse(jsonScript.innerHTML) || {}\n    };\n    const dequeueParams = data && {\n        key,\n        data\n    };\n\n    dequeueParams && dequeue(dequeueParams);\n}","import {\n    ISaveWebComponentData,\n    ISaveWebComponentDataWorker,\n    MessageAction,\n    DbStoreName,\n    DbKeyPath\n} from './types';\nimport isWindow from './is-window';\nimport isWorker from './is-worker';\nimport save from './save-indexed-db-data';\nimport sendMessage from './send-message';\nimport getWebComponentData from './get-web-component-data';\nimport removeRedundantScripts from './remove-redundant-scripts';\n\nconst { webComponent: storeName } = DbStoreName;\nconst { webComponent: keyPath } = DbKeyPath;\n\nexport default function (params: ISaveWebComponentData) {\n    if (isWindow()) {\n        return saveWebComponentDataWindow(params);\n    } else if (isWorker()) {\n        return saveWebComponentDataWorker(params);\n    }\n}\n\nasync function saveWebComponentDataWindow(params: ISaveWebComponentData) {\n    const { VamtigerBrowserMethod } = self;\n    const { support, workerSupport } = VamtigerBrowserMethod;\n    const { url: key } = params;\n    const selector = getSelector({ url: key });\n    const data = getData(params);\n    const message = data && {\n        action: MessageAction.saveWebComponentData,\n        params: data\n    };\n\n    if (workerSupport && workerSupport.indexedDbIsAccessible) {\n        message && sendMessage(message);\n    } else if (support && support.indexedDbIsAccessible) {\n        await saveWebComponentDataIndexDb(params);\n        await getWebComponentData({ key });\n        await removeRedundantScripts({ selector });\n    }\n}\n\nasync function saveWebComponentDataWorker(params: ISaveWebComponentDataWorker) {\n    const { url } = params;\n    const selector = getSelector({ url });\n    const saveData = await saveWebComponentDataIndexDb(params);\n    const getWebComponentDataMessage = {\n        action: MessageAction.getWebComponentData,\n        params: {\n            key: url\n        }\n    };\n    const removeRedundantScriptsMessage = {\n        action: MessageAction.removeRedundantScripts,\n        params: {\n            selector\n        }\n    };\n\n    sendMessage(getWebComponentDataMessage);\n    sendMessage(removeRedundantScriptsMessage);\n}\n\nasync function saveWebComponentDataIndexDb(params: ISaveWebComponentData) {\n    const data = getData(params);\n    const saveParams = data && {\n        storeName,\n        keyPath,\n        data,\n        successAction: MessageAction.getWebComponentData\n    };\n\n    saveParams && await save(saveParams);\n}\n\nfunction getData({ url, created = new Date().getTime(), json, jsonLd }: ISaveWebComponentData) {\n    const data = url && jsonLd && {\n        url,\n        created,\n        jsonLd: jsonLd,\n        json: json\n    };\n\n    return data;\n}\n\nfunction getSelector({ url }: Pick<ISaveWebComponentData, 'url'>) {\n    const selector = `script[type=\"application/json\"][data-json-ld=\"${url}\"]`;\n\n    return selector;\n}","import {\n    ILoadData,\n    IJsonData,\n    ILoadDataGetJsonJsonLd,\n    Selector,\n    ILoadDataGetFeldData,\n    ScriptType\n} from './types';\nimport loadScript from './load-script';\nimport saveWebComponentData from './save-web-component-data';\nimport isWindow from './is-window';\nimport getJsonLd from './get-json-ld';\nimport removeRedundantScripts from './remove-redundant-scripts';\n\nconst { parse, stringify } = JSON;\nconst emptyJsonLd = {\n    jsonLd: [],\n    json: {}\n};\n\nexport default async function (params: ILoadData) {\n    return await (isWindow() && loadWebComponentData(params));\n}\n\nasync function loadWebComponentData({ url, loadJsonJsonLd }: ILoadData) {\n    const { VamtigerBrowserMethod } = self;\n    const { worker } = VamtigerBrowserMethod;\n    const { head } = document;\n    const jsonLdSelector = `script[type=\"application/ld+json\"][data-json-ld=\"${url}\"]`;\n    const { jsonLd, json } = await getWebComponentData({ url });\n    const jsonJsonLdData = loadJsonJsonLd && json && Array.isArray(json.jsonLd) && await Promise.all((json.jsonLd as ILoadDataGetJsonJsonLd[]).map(getJsonJsonLd));\n    const params = jsonLd && {\n        url,\n        created: new Date().getTime(),\n        jsonLd,\n        json\n    };\n    const jsonLdScript = head.querySelector<HTMLScriptElement>(jsonLdSelector);\n    const removeScriptParams = {\n        selector: `[type=\"${ScriptType.json}\"][data-name=\"${url}\"]`\n    }\n\n    if (jsonJsonLdData) {\n        jsonJsonLdData.forEach(currentJsonJsonLdData => currentJsonJsonLdData.forEach(({index, key, jsonLd: data}) => {\n            if (jsonLd && Array.isArray(jsonLd) && jsonLd[index] && key && jsonLd[index][key] === true && data) {\n                jsonLd[index][key] = data;\n            }\n        }));\n\n        if (jsonLdScript && jsonLd) {\n            head.removeChild(jsonLdScript);\n\n            await Promise.all(jsonLd.map(currentJsonLd => loadScript({\n                name: url,\n                json: stringify(currentJsonLd),\n                jsonld: true\n            })));\n\n            await removeRedundantScripts(removeScriptParams);\n        }\n    }\n\n    if (worker && params) {\n        saveWebComponentData(params);\n    }\n}\n\nasync function getJsonJsonLd({ index, fields }: ILoadDataGetJsonJsonLd) {\n    const keys = Object.keys(fields);\n    const jsonJsonLd = await Promise.all(keys.map(key => getFieldData({key, urls: fields[key]}).then(fieldData => ({index, ...fieldData}))));\n\n    return jsonJsonLd;\n}\n\nasync function getFieldData({ urls: currentUrls, key }: ILoadDataGetFeldData) {\n    const loadJsonJsonLd = false;\n    const urls = Array.isArray(currentUrls) && currentUrls.filter(url => typeof url === 'string') || [];\n    const fieldData = await Promise.all(urls.map(url => getJsonLd({ jsonLd: url, loadJsonJsonLd })));\n    const data = {\n        key,\n        jsonLd: [] as IJsonData['jsonLd']\n    };\n\n    fieldData.forEach(({jsonLd}) => jsonLd && jsonLd.forEach(currentJsonLd => currentJsonLd && data.jsonLd.push(currentJsonLd)));\n\n    return data;\n}\n\nasync function getWebComponentData({ url }: ILoadData) {\n    try {\n        const { head } = document;\n        const selector = `${Selector.script}[src=\"${url}\"]`;\n        const jsonLdSelector = `script[type=\"application/ld+json\"][data-json-ld=\"${url}\"]`;\n        const jsonSelector = `script[type=\"application/json\"][data-json-ld=\"${url}\"]`;\n        const existingScript = head.querySelector(selector);\n        const script = !existingScript && await loadScript({ src: url });\n        const scripts = script && await Promise.all([\n            Array\n                .from(head.querySelectorAll<HTMLScriptElement>(jsonLdSelector))\n                .map(({ innerHTML }) => innerHTML),\n            head.querySelector<HTMLScriptElement>(jsonSelector)\n        ]);\n        const [ jsonLdScripts, jsonScript ] = scripts || [undefined, undefined];\n        const jsonLd = jsonLdScripts && jsonLdScripts.map(jsonLdScript => parse(jsonLdScript));\n        const json = jsonScript && parse(jsonScript.innerHTML) || {};\n        const webComponentData = {\n            jsonLd,\n            json\n        };\n\n        return webComponentData;\n    } catch(error) {\n        console.error(error);\n\n        return emptyJsonLd;\n    }\n}","import {\n    IGetJsonLd,\n    WebComponentDataResolve,\n    ErrorResolve\n} from './types';\nimport queue from './queue';\nimport loadWebComponentData from './load-web-component-data';\nimport getWebComponentData from './get-web-component-data';\n\nexport default function ({ jsonLd: url, loadJsonJsonLd = true }: IGetJsonLd) {return new Promise(async (resolve: WebComponentDataResolve, reject: ErrorResolve) => {\n    const queueParams = {\n        key: url,\n        resolve,\n        reject\n    };\n\n    queue(queueParams);\n\n    try {\n        await loadWebComponentData({ url, loadJsonJsonLd });\n    } catch(error) {\n        console.error(error);\n    }\n\n    getWebComponentData({ key: url });\n})}","import {\n    IViewJsonLd,\n    Dependency\n} from './types';\nimport loadScript from './load-script';\nimport isTextMode from './is-text-mode';\n\nconst { jsonLdViewer: src } = Dependency;\n\nlet jsonLdViewerElement: HTMLElement;\n\nexport default async function (params: IViewJsonLd) {\n    const textMode = isTextMode();\n\n    if (textMode) {\n        await viewJsonLd(params);\n    }\n}\n\nasync function viewJsonLd({jsonLd}: IViewJsonLd) {\n    const jsonLdViewerScript = await loadScript({name: src, src});\n    const jsonLdViewer = getJsonLdViewer();\n    const { dataset } = jsonLdViewer;\n\n    dataset.jsonLd = jsonLd;\n}\n\nfunction getJsonLdViewer() {\n    const { body } = document;\n    const jsonLdViewer = jsonLdViewerElement || document.createElement('vamtiger-json-ld-viewer');\n\n    if (!jsonLdViewerElement) {\n        jsonLdViewerElement = jsonLdViewer;\n\n        body.appendChild(jsonLdViewer);\n    }\n\n    return jsonLdViewer;\n}","export default function () {\n    const { documentElement } = document;\n    const isTextMode = documentElement.dataset.hasOwnProperty('vamtigerTextMode');\n\n    return isTextMode;\n}","import {\n    IGetData,\n    ErrorMessage,\n    IJsonData\n} from './types';\nimport getJsonLd from './get-json-ld';\nimport viewJsonLd from './view-json-ld';\n\nconst { noJsonLdParameter } = ErrorMessage;\n\nexport default function(params: IGetData) { return new Promise(async (resolve: (data: IJsonData) => void, reject) => {\n    const { requestIdleCallback } = self;\n    const { textMode, jsonLd } = params;\n\n    if (jsonLd) {\n        if (textMode) {\n            await viewJsonLd(params);\n        }\n\n        if (requestIdleCallback) {\n            requestIdleCallback(() => getJsonLd(params).then(resolve).catch(reject));\n        } else {\n            setTimeout(() => getJsonLd(params).then(resolve).catch(reject), 0);\n        }\n    } else {\n        reject(new Error(noJsonLdParameter));\n    }\n})}","import {\n    Environment\n} from './types';\n\nexport default function () {\n    const environment = self.hasOwnProperty('WorkerGlobalScope')\n        && Environment.worker\n        || Environment.window;\n\n    return environment;\n}","import {\n    IMessageAction,\n    MessageAction\n} from './types';\n\nconst { parse } = JSON;\nconst ignoreMessage = {\n    action: MessageAction.ignore,\n    params: {}\n}\nconst textDecoder = new TextDecoder();\n\nexport default function (event: MessageEvent) {\n    let message: IMessageAction;\n\n    try {\n        message = getMessageData(event) || ignoreMessage;\n    } catch(error) {\n        message = ignoreMessage;\n    }\n\n    return message;\n}\n\nfunction getMessageData({ data: message }: MessageEvent) {\n    const messageData: IMessageAction = typeof message === 'string' && parse(message)\n        || message instanceof Uint8Array && parse(textDecoder.decode(message));\n\n    if (typeof messageData.params === 'string') {\n        messageData.params = parse(messageData.params);\n    }\n\n    return messageData;\n}","import {\n    ISaveSupport,\n    MessageAction,\n    DbStoreName,\n    DbKeyPath\n} from './types';\nimport save from './save-indexed-db-data';\nimport isWindow from './is-window';\nimport isWorker from './is-worker';\nimport sendMessage from './send-message';\n\nconst { support: storeName } = DbStoreName;\n\nexport default async function (params: ISaveSupport) {\n    isWindow() && saveSupportDataWindow(params);\n\n    isWorker() && saveSupportDataWorker(params);\n}\n\nfunction saveSupportDataWindow(params: ISaveSupport) {\n    const { VamtigerBrowserMethod } = self;\n    const { workerSupport } = VamtigerBrowserMethod;\n    const message = workerSupport && workerSupport.indexedDbIsAccessible && {\n        action: MessageAction.saveSupport,\n        params\n    };\n\n    if (message) {\n        sendMessage(message);\n    } else {\n        saveSupportDataIndexDb(params);\n    }\n}\n\nfunction saveSupportDataWorker(params: ISaveSupport) {\n    saveSupportDataIndexDb(params);\n}\n\nfunction saveSupportDataIndexDb(params: ISaveSupport) {\n    const { environment } = params;\n    const saveParams = environment && {\n        storeName,\n        keyPath: DbKeyPath.support,\n        data: {\n            environment,\n            ...params\n        }\n    };\n\n    saveParams && save(saveParams);\n}","import {\n    ISupport,\n    MessageAction,\n    DbStoreName,\n    DbKeyPath,\n    TimeoutDuration,\n    Environment\n} from './types';\nimport isWorker from './is-worker';\nimport sendMessage from './send-message';\nimport getData from './get-indexed-db-data';\nimport saveSupport from './save-support';\n\nconst { support: keyPath } = DbKeyPath;\nconst { support: storeName } = DbStoreName\n\nexport default async function () {\n    const {\n        VamtigerBrowserMethod,\n        localStorage,\n        indexedDB,\n    } = self;\n    const [indexedDbIsAccessible] = await Promise.all([\n        indexDbAccessible()\n    ]);\n    const support: ISupport = {\n        localStorage: localStorage ? true : false,\n        indexedDb: indexedDB ? true : false,\n        indexedDbIsAccessible,\n        worker: self.hasOwnProperty('Worker') ? true : false,\n        sharedWorker: self.hasOwnProperty('SharedWorker'),\n        textEncoder: self.hasOwnProperty('TextEncoder'),\n        textDecoder: self.hasOwnProperty('TextDecoder')\n    };\n\n    VamtigerBrowserMethod.support = support;\n\n    isWorker() && sendWorkerSupport();\n}\n\nexport function indexDbAccessible() {return new Promise(async (resolve: (indexDbAccessible: boolean) => void, reject) => {\n    let indexedDbIsAccessible = false;\n    let resolved = false;\n    const environment = Environment.worker;\n    const timeout = setTimeout(() => !resolved && resolve(indexedDbIsAccessible), TimeoutDuration.indexDbIsAccessible);\n\n    await getData({\n        storeName,\n        keyPath,\n        key: environment\n    });\n\n    indexedDbIsAccessible = true;\n    resolved = true;\n\n    resolve(indexedDbIsAccessible);\n})}\n\nexport async function setWorkerSupport(workerSupport: ISupport) {\n    const { VamtigerBrowserMethod } = self;\n    const { support, environment } = VamtigerBrowserMethod;\n\n    VamtigerBrowserMethod.workerSupport = workerSupport;\n\n    support && saveSupport({\n        environment,\n        ...support\n    });\n\n    workerSupport && saveSupport({\n        environment: Environment.worker,\n        ...workerSupport\n    });\n}\n\nfunction sendWorkerSupport() {\n    const { VamtigerBrowserMethod } = self;\n    const message = {\n        action: MessageAction.setWorkerSupport,\n        params: VamtigerBrowserMethod.support || {}\n    };\n\n    sendMessage(message);\n}","const logMessage = 'Message Ignored';\n\nexport default function (params: any) {\n    console.log(logMessage);\n    console.warn(params);\n}","import {\n    MessageAction,\n    MessageResponse\n} from './types';\nimport getMessageData from './get-message-data';\nimport removeRedundantScripts from './remove-redundant-scripts';\nimport { setWorkerSupport } from './set-support';\nimport saveWebComponentData from './save-web-component-data';\nimport sendMessage from './send-message';\nimport ignoreMessage from './ignore-message';\nimport getWebComponentData from './get-web-component-data';\nimport dequeue from './dequeue';\nimport loadWebComponentData from './load-web-component-data';\nimport saveSupport from './save-support';\nimport saveCustomElementName from './save-custom-element-name';\nimport getTextModeCss from './get-text-mode-css';\nimport loadScript from './handle-load-script';\n\nconst action = {\n    [MessageAction.ignore]: ignoreMessage,\n    [MessageAction.removeRedundantScripts]: removeRedundantScripts,\n    [MessageAction.setWorkerSupport]: setWorkerSupport,\n    [MessageAction.saveWebComponentData]: saveWebComponentData,\n    [MessageAction.getWebComponentData]: getWebComponentData,\n    [MessageAction.dequeue]: dequeue,\n    [MessageAction.loadWebComponentData]: loadWebComponentData,\n    [MessageAction.saveSupport]: saveSupport,\n    [MessageAction.saveCustomElementName]: saveCustomElementName,\n    [MessageAction.getTextModeCss]: getTextModeCss,\n    [MessageAction.loadScript]: loadScript\n}\n\nexport default async function (event: MessageEvent) {\n    const { action: actionName, params } = getMessageData(event) || { action: MessageAction.ignore, params: {}};\n    const currentAction = action[actionName];\n    const response = await currentAction(params) as MessageResponse;\n\n    response && sendMessage(response);\n}","import {\n    LocalHostRelativePath\n} from './types';\nimport isLocalHost from './is-local-host';\n\nconst { vamtigerBrowserMethod: url } = LocalHostRelativePath;\n\nexport default async function() {\n    const validUrl = isLocalHost() && await fetch(url)\n        .then(response => response.ok)\n        .catch(error => '');\n    const localHostRelativeUrl = validUrl && url || '';\n\n    return localHostRelativeUrl;\n}","import {\n    HostName\n} from './types';\n\nexport default function() {\n    const { location } = window;\n    const isLocalHost = HostName.localHost === location.hostname;\n\n    return isLocalHost;\n}","import {\n    Selector,\n    ScriptType,\n    StringConstant\n} from './types';\nimport handleMessage from './handle-message';\nimport getLocalHostWorkerUrl from './get-local-host-worker-url';\n\nconst { stringify } = JSON;\nconst params = {\n    type: ScriptType.js\n}\nconst { newline } = StringConstant;\n\nlet worker: Worker;\n\nexport default async function () {\n    const localHostWorkerUrl = await getLocalHostWorkerUrl();\n    const { head } = document;\n    const { createObjectURL } = URL;\n    const workderScript = head.querySelector<HTMLScriptElement>(Selector.vamtigerBrowserMethod);\n    const workerDependecies = (Array.from(head.querySelectorAll<HTMLScriptElement>(Selector.workderDependency)) || [])\n        .map(({ innerHTML }) => innerHTML)\n        .filter(script => script);\n    const workerScripts = [\n        ...workerDependecies,\n        workderScript && workderScript.innerHTML || ''\n    ].filter(script => script).join(newline.repeat(2));\n    const workerBlob = workerScripts && workerScripts.length && new Blob([workerScripts], params);\n    const workerUrl = workerBlob && createObjectURL && createObjectURL(workerBlob);\n    const currentWorker = workerUrl && new Worker(localHostWorkerUrl || workerUrl);\n\n    if (currentWorker) {\n        currentWorker.addEventListener('message', handleMessage);\n        currentWorker.addEventListener('error', handleError);\n    }\n\n    worker = worker || currentWorker;\n\n    return worker;\n}\n\nexport function handleError(event: ErrorEvent) {\n    const keys = Object.keys(event) as (keyof ErrorEvent)[];\n\n    keys.forEach(key => console.error(typeof event[key] === 'string' || stringify(event[key])));\n}","import {\n    ElementId,\n    DataAttribute,\n    StringConstant\n} from './types';\nimport getWorker from './get-worker';\nimport isWindow from './is-window';\n\nconst { nothing } = StringConstant;\n\nexport default function () {\n    isWindow() && setupWindow();\n}\n\nasync function setupWindow() {\n    const { head } = document;\n    const { VamtigerBrowserMethod } = self;\n    const { metaElement = document.createElement('meta') } = VamtigerBrowserMethod;\n    const customeElementMetaElement = document.createElement('meta');\n\n    customeElementMetaElement.dataset[DataAttribute.customElementName] = nothing;\n\n    metaElement.id = ElementId.metaElement;\n\n    metaElement.appendChild(customeElementMetaElement);\n\n    head.appendChild(metaElement);\n\n    VamtigerBrowserMethod.metaElement = metaElement;\n\n    VamtigerBrowserMethod.worker = await getWorker();\n}","import {\n    selector\n} from './types'\nimport handleMessage from './handle-message';\nimport isWorker from './is-worker';\nimport removeRedundantScripts from './remove-redundant-scripts';\n\nexport default function () {\n    isWorker() && setupWorker();\n}\n\nfunction setupWorker() {\n    addEventListener('message', handleMessage);\n\n    return removeRedundantScripts({\n        selector: selector.redundantScripts\n    });\n}","export default `<figcaption data-linked-data-caption></figcaption> <span data-linked-data-caption-element></span> <a></a>`;","import {\n    IGetTemplate,\n    GetTemplate,\n    StringConstant,\n    AttributesKey\n} from './types';\nimport html from './html';\n\nlet template: HTMLTemplateElement;\nlet templateHtml: string;\n\nconst { document } = self;\nconst { nothing } = StringConstant;\n\nif (document) {\n    template = document.createElement('template');\n\n    templateHtml = [\n        html\n    ].join(nothing);\n\n    template.innerHTML = templateHtml;\n}\n\nexport default <P extends IGetTemplate>(params: P) => {\n    const {\n        selector,\n        attributes = {},\n        properties = {}\n    } = params;\n    const attributesKeys = Object.keys(attributes) as AttributesKey[]\n    const templateElement = template.content.querySelector(selector);\n    const currentTemplate = templateElement && templateElement.cloneNode(true) as GetTemplate<P>;\n\n    if (currentTemplate) {\n        Object.assign(currentTemplate, properties);\n\n        attributesKeys.forEach(key => attributes[key] && currentTemplate.setAttribute(key, attributes[key] || ''));\n    }\n\n    return currentTemplate;\n};","import {\n    IGetMicrodataCaption,\n    IAnyObject,\n    Selector,\n    StringConstant\n} from './types';\nimport getTemplate from './get-template';\n\nconst { nothing, slash } = StringConstant;\n\nexport default function ({ imageData, fieldKey }: IGetMicrodataCaption) {\n    const field = imageData[fieldKey] as IAnyObject | undefined;\n    const fieldData = Array.isArray(field) && field || [field] || [];\n    const caption = field && getTemplate({\n        selector: Selector.linkedDataCaption,\n        attributes: {\n            itemprop: fieldKey\n        }\n    });\n\n    let itemtype: string;\n    let currentCaption: HTMLElement | null;\n    let currentProducerCaptionElements: (HTMLElement | null)[]\n\n    fieldData.forEach(currentFieldData => {\n        if (currentFieldData) {\n            itemtype = currentFieldData['@context'] && currentFieldData['@type'] && [\n                currentFieldData['@context'],\n                currentFieldData['@type']\n            ].join(slash);\n            currentCaption = getTemplate({\n                selector: Selector.linkedDataCaption\n            });\n\n            if (currentCaption) {\n                currentCaption.setAttribute('itemscope', nothing);\n                itemtype && currentCaption.setAttribute('itemtype', itemtype);\n\n                currentProducerCaptionElements = [\n                    currentFieldData.name && getTemplate({\n                        selector: Selector.linkedDataCaptionElement,\n                        properties: {\n                            innerHTML: currentFieldData.name\n                        },\n                        attributes: {\n                            itemprop: 'name'\n                        }\n                    }),\n                    currentFieldData.description && getTemplate({\n                        selector: Selector.linkedDataCaptionElement,\n                        properties: {\n                            innerHTML: currentFieldData.description\n                        },\n                        attributes: {\n                            itemprop: 'description'\n                        }\n                    }),\n                    currentFieldData.url && getTemplate({\n                        selector: Selector.a,\n                        properties: {\n                            innerHTML: currentFieldData.name || currentFieldData.url\n                        },\n                        attributes: {\n                            itemprop: 'url',\n                            href: currentFieldData.url\n                        }\n                    })\n                ];\n\n                currentProducerCaptionElements.forEach(currentElement => currentElement && currentCaption && currentCaption.appendChild(currentElement));\n\n                caption && caption.appendChild(currentCaption);\n            }\n        }\n    });\n\n    return caption\n}","import {\n    IGetTabLink\n} from './types';\n\nexport default function ({ href, text }: IGetTabLink) {\n    const link = href && text && `<a href=\"${href}\" target=\"_blank\">${text}</a>` || '';\n\n    return link;\n}","import {\n    IGetJsonLdArray,\n    IGetJsonLdArrayGetEntry,\n    StringConstant,\n    regex\n} from './types';\nimport {\n    jsonLdEntryValueType\n} from './config';\nimport getTabLink from './get-tab-link';\nimport getEmailLink from './get-email-link';\n\nconst { requestIdleCallback } = self;\nconst { nothing, slash } = StringConstant;\nconst { leadingAt, remoteUrl, email } = regex;\n\nexport default function (params: IGetJsonLdArray) {return new Promise(async (resolve: (jsonLdArray: string[][]) => void, reject) => {\n    if (requestIdleCallback) {\n        requestIdleCallback(() => getJsonLdArray(params).then(resolve).catch(reject));\n    } else {\n        setTimeout(() => getJsonLdArray(params).then(resolve).catch(reject), 0);\n    }\n})}\n\nexport async function getJsonLdArray({ jsonLd: currentJsonLd }: IGetJsonLdArray) {\n    const jsonLd = getJsonLd({\n        jsonLd: currentJsonLd\n    });\n    const keys = Object.keys(jsonLd);\n    const entries = await Promise.all(keys.map(key => getEntry({key, value: jsonLd[key]})));\n    const jsonLdArray = [] as string[][];\n\n    entries.forEach(entries => entries.forEach(entry => jsonLdArray.push(entry)));\n\n    return jsonLdArray;\n}\n\nfunction getJsonLd({ jsonLd }: IGetJsonLdArray) {\n    const { _ } = self;\n    const { startCase } = _;\n    const {\n        '@context': context = undefined,\n        '@type': type = undefined\n    } = jsonLd;\n    const typeLinkHref = context && type && [\n        context,\n        type\n    ].join(slash);\n    const typeLinkText = type && startCase(type);\n    const typeLink = getTabLink({\n        href: typeLinkHref,\n        text: typeLinkText\n    });\n\n    if (typeLink) {\n        jsonLd['@type'] = typeLink;\n    }\n\n    return jsonLd;\n}\n\nasync function getEntry({key, value}: IGetJsonLdArrayGetEntry) {\n    const { _ } = self;\n    const { startCase } = _;\n    const entryValue = jsonLdEntryValueType.has(typeof value) && value as string | number | boolean;\n    const valueArray = Array.isArray(value) && value || typeof value === 'object' && [value];\n    const nestedEntries = valueArray && await Promise.all(valueArray.map(jsonLd => getJsonLdArray({ jsonLd })));\n    const entry = [[startCase(key.replace(leadingAt, nothing)), entryValue && (key.match(email) && getEmailLink({href: entryValue.toString(), text: entryValue.toString()}) || getEntryValue(entryValue)) || nothing]];\n\n    nestedEntries && nestedEntries.forEach(nestedEntry => nestedEntry.forEach(currentNestedEntry => entry.push(currentNestedEntry)));\n\n    return entry;\n}\n\nfunction getEntryValue(value: string | number | boolean) {\n    const valueString = value.toString().trim();\n    const linkHref = valueString.match(remoteUrl) && valueString;\n    const linkText = linkHref && valueString && valueString.split(slash).pop();\n    const link = linkHref && linkText && getTabLink({\n        href: linkHref,\n        text: linkText\n    });\n    const entryValue = link || valueString;\n\n    return entryValue;\n}","import {\n    IGetEmailLink\n} from './types';\n\nexport default function ({ href, text }: IGetEmailLink) {\n    const link = href && text && `<a href=\"mailto:${href}\">${text}</a>` || '';\n\n    return link;\n}","import {\n    getDependencies\n} from './config';\nimport loadScript from './load-script';\nimport isWindow from './is-window';\n\nexport default async function () {\n    isWindow() && await loadDependencies();\n}\n\nasync function loadDependencies() {\n    const workerDependency = true;\n    const dependencies = getDependencies();\n\n    await Promise.all(dependencies.map(src => loadScript({name: src, src, workerDependency})));;\n}","import {\n    IDispatchEvent,\n    EventName,\n    Origin\n} from './types';\nimport isWindow from './is-window';\n\nconst eventParams = {\n    bubbles: true\n};\n\nexport default function (params: IDispatchEvent) {\n    isWindow() && postWindowMessage(params);\n}\n\nfunction postWindowMessage({eventName, detail = {}}: IDispatchEvent) {\n    const event = new CustomEvent(eventName, {\n        ...eventParams,\n        detail\n    });\n\n    self.dispatchEvent(event);\n}","import {\n    EventName\n} from './types';\nexport * from './load-ts-lib';\nimport loadScript from './load-script';\nimport loadScripts from './load-scripts';\nimport loadScriptsSequentially from './load-scripts-sequentially';\nimport loadShadowStylesheet from './load-shadow-stylesheet';\nimport defineCustomElement from './define-custom-element';\nimport pause from './pause';\nimport getElement from './get-element';\nimport getData from './get-data';\nimport getEnvironment from './get-environment';\nimport setupWindow from './setup-window';\nimport setupWorker from './setup-worker';\nimport setSupport from './set-support';\nimport getMicrodataCaption from './get-microdata-caption';\nimport getJsonLdArray from './get-json-ld-array';\nimport loadDependencies from './load-dependencies';\nimport dispatchEvent from './dispatch-event';\n\nconst environment = getEnvironment();\nconst vamtigerBrowserMethod = {\n    loadScript,\n    loadScripts,\n    loadScriptsSequentially,\n    loadShadowStylesheet,\n    defineCustomElement,\n    pause,\n    getElement,\n    getData,\n    getEnvironment,\n    environment,\n    messageQueue: new Map(),\n    getMicrodataCaption,\n    getJsonLdArray\n};\n\nmain().catch(handleError);\n\nasync function main() {\n    try {\n        const { VamtigerBrowserMethod } = self;\n\n        if (!VamtigerBrowserMethod) {\n            self.VamtigerBrowserMethod = vamtigerBrowserMethod;\n\n            await loadDependencies();\n\n            await setSupport();\n\n            await setupWindow();\n\n            await setupWorker();\n\n            dispatchEvent({eventName: EventName.vamtigerBrowserMethodReady})\n        }\n    } catch(error) {\n        handleError(error);\n    }\n}\n\nfunction handleError(error: Error) {\n    console.error(error);\n    throw error;\n}","import { LoadScriptsParams, LoadedScripts } from './types';\nimport loadScript from './load-script';\n\nexport default function <P extends LoadScriptsParams>(params: P) {\n    const scripts = Promise.all(params.map(loadScript)) as Promise<LoadedScripts<P>>;\n\n    return scripts\n}","import { LoadScriptsSequentiallyParams, LoadedScriptsSequentially, LoadScriptParams } from './types';\nimport loadScript from './load-script';\n\nexport default <P extends LoadScriptParams[][]>(params: P) => new Promise((resolve: (scripts: LoadedScriptsSequentially<P>) => void, reject) => {\n    let scripts = new Set();\n    let load = Promise.resolve();\n\n    params.forEach(scriptParams => {\n        load = load\n            .then(async () => await Promise.all(scriptParams.map(loadScript)))\n            .then(loadedScripts => loadedScripts.forEach(script => scripts.add(script)))\n    });\n\n    load = load.then(() => resolve(Array.from(scripts) as LoadedScriptsSequentially<P>));\n\n    return load;\n});","import {\n    ILoadShadowStylesheet,\n    Selector\n} from './types';\n\nexport default function ({ css, element }: ILoadShadowStylesheet) {\n    const {\n        shadowRoot,\n        localName: hostName\n    } = element;\n    const lastStylesheet = shadowRoot && shadowRoot.querySelector(Selector.lastStylesheet);\n    const stylesheet = shadowRoot && document.createElement('style');\n\n    if (stylesheet && shadowRoot) {\n        stylesheet.innerHTML = css;\n\n        if (lastStylesheet && lastStylesheet.nextElementSibling) {\n            shadowRoot.insertBefore(stylesheet, lastStylesheet.nextElementSibling);\n        } else {\n            shadowRoot.appendChild(stylesheet);\n        }\n    }\n}"],"names":["Environment","EventName","TimeoutDuration","MessageQueueName","Prefix","ElementId","Origin","HostName","LocalHostRelativePath","ScriptType","ScriptAttribute","DataAttribute","ErrorMessage","StringConstant","TagName","LinkRel","LoadScriptElement","Selector","TextModeElementName","MetaElementName","ScriptNameSuffix","ScriptName","MessageAction","DbName","DbStoreName","DbMode","DbKeyPath","Dependency","__extends","__assign","__rest","__decorate","__param","__metadata","__awaiter","__generator","__exportStar","__values","__read","__spread","__await","__asyncGenerator","__asyncDelegator","__asyncValues","__makeTemplateObject","__importStar","__importDefault","regex","showRootHost","dash","RegExp","space","nonWord","backTicks","remoteUrl","jsJsonJs","jsonJs","trailingJs","uppercase","leadingAt","email","textModeElement","Object","keys","map","key","join","pipe","selector","redundantScripts","vamtigerBrowserMethodJsonJs","vamtigerBrowserMethodJson","vamtigerBrowserMethod","transpiledJs","comma","sendMessageFromWorker","postMessage","factory","root","global","self","this","createExporter","exports","previous","create","defineProperty","value","__esModule","id","v","define","amd","module","exporter","extendStatics","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__","constructor","prototype","assign","t","s","i","n","arguments","length","call","e","indexOf","getOwnPropertySymbols","decorators","target","desc","c","r","getOwnPropertyDescriptor","Reflect","decorate","paramIndex","decorator","metadataKey","metadataValue","metadata","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","result","done","then","apply","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","op","TypeError","pop","push","m","o","ar","error","concat","asyncIterator","q","a","resume","fulfill","settle","shift","cooked","raw","mod","k","default","tslib","forEach","nothing","requestIdleCallback","loadElementQueryCss","_a","css","_b","currentStylesheetName","_c","hostName","camelCase","metaElement","properties","_d","dataset","_e","attributes","head","lastMetaElement","querySelector","attributeKeys","existingMetaElement","window","newMetaElment","document","createElement","nextElementSibling","insertBefore","appendChild","hasAttribute","setAttribute","dataKey","getMetaElment","stylesheetName","elementQueryCss","replace","EQCSS","register","parse","babel","presets","jsonLdEntryValueType","Set","getDependencies","lodash","filter","dependency","handleError","console","warn","message","stack","worker","stringify","textEncoder","TextEncoder","params","VamtigerBrowserMethod","textEncoderSupport","stringMessage","encode","isWindow","isWorker","innerHTML","isJson","prefix","parent","removeScripts","removeRedundantScripts","sendMessage","action","sendRemoveRedundantScriptsMessage","removeScriptsFromParent","setTimeout","scripts","from","querySelectorAll","jsScripts","type","js","jsonScripts","json","script","isJsonScript","jsonLdScripts","jsonld","safeScripts","time","Date","getTime","jsonScriptName","jsonScriptSelector","jsonLdScriptName","jsonLdScriptSelector","name","jsonLd","removedScripts","Number","toString","removeChild","failedToLoadScript","stylesheet","scriptElement","link","style","slash","loadScript","handleLoad","removeEventListeners","removeFromDom","src","match","workerDependency","paths","split","scriptName","jsJsonJsScript","text","removeScriptSelector","catch","loadJsJsonJs","handleLoadError","event","Error","removeEventListener","url","fetch","Babel","transform","undefined","response","code","trim","getTranspiledJs","href","remoteScript","element","existingScript","HTMLScriptElement","HTMLLinkElement","rel","HTMLStyleElement","addEventListener","dbName","storeName","mode","dbRequest","indexedDB","open","db","objectStoreNames","contains","createObjectStore","keyPath","transaction","store","objectStore","data","messageId","getDbParams","save","put","handleSuccess","get","getAll","loadScriptWindow","removeExisting","ignore","error_1","semiColon","workerSupport","customElementMetaElement","indexedDbIsAccessible","getTextModeCss","customElementNameMetaElement","getCss","children","textMode","getData","customElementNames","names","getTextModeCssWorker","htmlTextMode","cssBody","support","saveCustomElementName","saveParams","saveCustomElementNameWindowIndexDb","newMetaElement","saveCustomElementNameWindow","successAction","saveCustomElementNameIndexDb","saveCustomElementNameWorker","unsupportedFeature","loadStylesheets","container","styles","content","index","stylesheets","all","styleElements","noElementName","noTemplate","noElementForSelector","noElementSelector","noTemplateUrl","noTemplateForUrl","getElement","template","loadContainerStylesheets","getElementFromUrl","firstElementChild","getElementFromTemplate","timeout","queue","queueEntry","messageQueue","has","set","add","delete","size","handleExpiredQueueEntry","jsonLdSelector","jsonSelector","jsonScript","dequeueParams","getWebComponentDataWindowWorker","getWebComponentData","dequeue","getWebComponentDataWindow","webComponent","getWebComponentDataWorker","getSelector","saveWebComponentData","saveWebComponentDataIndexDb","saveWebComponentDataWindow","getWebComponentDataMessage","removeRedundantScriptsMessage","saveWebComponentDataWorker","created","emptyJsonLd","loadJsonJsonLd","jsonLdScript","isArray","getJsonJsonLd","jsonJsonLdData","removeScriptParams","currentJsonJsonLdData","currentJsonLd","loadWebComponentData","fields","currentUrls","urls","getJsonLd","fieldData","getFieldData","jsonLdViewerElement","jsonLdViewer","getJsonLdViewer","viewJsonLd","noJsonLdParameter","ignoreMessage","textDecoder","TextDecoder","messageData","Uint8Array","decode","getMessageData","saveSupport","saveSupportDataIndexDb","saveSupportDataWindow","saveSupportDataWorker","environment","localStorage","resolved","indexDbIsAccessible","indexDbAccessible","indexedDb","sharedWorker","setWorkerSupport","sendWorkerSupport","logMessage","log","actionName","currentAction","location","localHost","hostname","ok","newline","customeElementMetaElement","customElementName","getLocalHostWorkerUrl","localHostWorkerUrl","createObjectURL","URL","workderScript","workerDependecies","workderDependency","workerScripts","repeat","workerBlob","Blob","workerUrl","currentWorker","Worker","handleMessage","getWorker","setupWindow","templateHtml","attributesKeys","templateElement","currentTemplate","cloneNode","getJsonLdArray","startCase","context","typeLinkHref","typeLinkText","typeLink","getTabLink","entryValue","valueArray","nestedEntries","entry","valueString","linkHref","linkText","getEntryValue","nestedEntry","currentNestedEntry","getEntry","entries","jsonLdArray","dependencies","loadDependencies","eventParams","bubbles","eventName","CustomEvent","detail","dispatchEvent","loadScripts","loadScriptsSequentially","load","scriptParams","loadedScripts","loadShadowStylesheet","shadowRoot","lastStylesheet","defineCustomElement","customElements","existingElement","pause","milliseconds","getEnvironment","Map","getMicrodataCaption","itemtype","currentCaption","imageData","fieldKey","field","caption","getTemplate","linkedDataCaption","itemprop","currentFieldData","linkedDataCaptionElement","description","currentElement","setSupport","setupWorker","vamtigerBrowserMethodReady","main"],"mappings":"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"}