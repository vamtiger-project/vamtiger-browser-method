{"version":3,"file":"vamtiger-browser-method.js","sources":["../node_modules/tslib/tslib.js","../source/types.ts","../source/load-ts-lib.ts","../source/get-meta-element.ts","../source/get-camel-case.ts","../source/load-element-query-css.ts","../source/load-script.ts","../source/define-custom-element.ts","../source/pause.ts","../source/load-container-stylesheets.ts","../source/get-element-from-template.ts","../source/get-element-from-url.ts","../source/is-window.ts","../source/is-worker.ts","../source/send-message.ts","../source/is-json-script.ts","../source/remove-redundant-scripts.ts","../source/get-element.ts","../source/queue.ts","../source/get-db-params.ts","../source/save-indexed-db-data.ts","../source/get-indexed-db-data.ts","../source/dequeue.ts","../source/get-web-component-data.ts","../source/save-web-component-data.ts","../source/load-web-component-data.ts","../source/get-json-ld.ts","../source/get-data.ts","../source/get-environment.ts","../source/get-message-data.ts","../source/save-support.ts","../source/set-support.ts","../source/ignore-message.ts","../source/handle-message.ts","../source/get-local-host-worker-url.ts","../source/is-local-host.ts","../source/get-worker.ts","../source/setup-window.ts","../source/setup-worker.ts","../source/html/index.ts","../source/get-template.ts","../source/get-microdata-caption.ts","../source/vamtiger-browser-method.ts","../source/load-scripts.ts","../source/load-scripts-sequentially.ts","../source/load-shadow-stylesheet.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global global, define, System, Reflect, Promise */\r\nvar __extends;\r\nvar __assign;\r\nvar __rest;\r\nvar __decorate;\r\nvar __param;\r\nvar __metadata;\r\nvar __awaiter;\r\nvar __generator;\r\nvar __exportStar;\r\nvar __values;\r\nvar __read;\r\nvar __spread;\r\nvar __await;\r\nvar __asyncGenerator;\r\nvar __asyncDelegator;\r\nvar __asyncValues;\r\nvar __makeTemplateObject;\r\nvar __importStar;\r\nvar __importDefault;\r\n(function (factory) {\r\n    var root = typeof global === \"object\" ? global : typeof self === \"object\" ? self : typeof this === \"object\" ? this : {};\r\n    if (typeof define === \"function\" && define.amd) {\r\n        define(\"tslib\", [\"exports\"], function (exports) { factory(createExporter(root, createExporter(exports))); });\r\n    }\r\n    else if (typeof module === \"object\" && typeof module.exports === \"object\") {\r\n        factory(createExporter(root, createExporter(module.exports)));\r\n    }\r\n    else {\r\n        factory(createExporter(root));\r\n    }\r\n    function createExporter(exports, previous) {\r\n        if (exports !== root) {\r\n            if (typeof Object.create === \"function\") {\r\n                Object.defineProperty(exports, \"__esModule\", { value: true });\r\n            }\r\n            else {\r\n                exports.__esModule = true;\r\n            }\r\n        }\r\n        return function (id, v) { return exports[id] = previous ? previous(id, v) : v; };\r\n    }\r\n})\r\n(function (exporter) {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\n    __extends = function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n\r\n    __assign = Object.assign || function (t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n\r\n    __rest = function (s, e) {\r\n        var t = {};\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n            t[p] = s[p];\r\n        if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n            for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n                t[p[i]] = s[p[i]];\r\n        return t;\r\n    };\r\n\r\n    __decorate = function (decorators, target, key, desc) {\r\n        var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n        if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n        else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n        return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n    };\r\n\r\n    __param = function (paramIndex, decorator) {\r\n        return function (target, key) { decorator(target, key, paramIndex); }\r\n    };\r\n\r\n    __metadata = function (metadataKey, metadataValue) {\r\n        if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n    };\r\n\r\n    __awaiter = function (thisArg, _arguments, P, generator) {\r\n        return new (P || (P = Promise))(function (resolve, reject) {\r\n            function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n            function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n            function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n            step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n        });\r\n    };\r\n\r\n    __generator = function (thisArg, body) {\r\n        var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n        return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n        function verb(n) { return function (v) { return step([n, v]); }; }\r\n        function step(op) {\r\n            if (f) throw new TypeError(\"Generator is already executing.\");\r\n            while (_) try {\r\n                if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n                if (y = 0, t) op = [op[0] & 2, t.value];\r\n                switch (op[0]) {\r\n                    case 0: case 1: t = op; break;\r\n                    case 4: _.label++; return { value: op[1], done: false };\r\n                    case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                    case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                    default:\r\n                        if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                        if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                        if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                        if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                        if (t[2]) _.ops.pop();\r\n                        _.trys.pop(); continue;\r\n                }\r\n                op = body.call(thisArg, _);\r\n            } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n            if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n        }\r\n    };\r\n\r\n    __exportStar = function (m, exports) {\r\n        for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n    };\r\n\r\n    __values = function (o) {\r\n        var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n        if (m) return m.call(o);\r\n        return {\r\n            next: function () {\r\n                if (o && i >= o.length) o = void 0;\r\n                return { value: o && o[i++], done: !o };\r\n            }\r\n        };\r\n    };\r\n\r\n    __read = function (o, n) {\r\n        var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n        if (!m) return o;\r\n        var i = m.call(o), r, ar = [], e;\r\n        try {\r\n            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n        }\r\n        catch (error) { e = { error: error }; }\r\n        finally {\r\n            try {\r\n                if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n            }\r\n            finally { if (e) throw e.error; }\r\n        }\r\n        return ar;\r\n    };\r\n\r\n    __spread = function () {\r\n        for (var ar = [], i = 0; i < arguments.length; i++)\r\n            ar = ar.concat(__read(arguments[i]));\r\n        return ar;\r\n    };\r\n\r\n    __await = function (v) {\r\n        return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n    };\r\n\r\n    __asyncGenerator = function (thisArg, _arguments, generator) {\r\n        if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n        var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n        return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n        function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n        function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n        function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }\r\n        function fulfill(value) { resume(\"next\", value); }\r\n        function reject(value) { resume(\"throw\", value); }\r\n        function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n    };\r\n\r\n    __asyncDelegator = function (o) {\r\n        var i, p;\r\n        return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n        function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n    };\r\n\r\n    __asyncValues = function (o) {\r\n        if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n        var m = o[Symbol.asyncIterator], i;\r\n        return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n        function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n        function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n    };\r\n\r\n    __makeTemplateObject = function (cooked, raw) {\r\n        if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n        return cooked;\r\n    };\r\n\r\n    __importStar = function (mod) {\r\n        if (mod && mod.__esModule) return mod;\r\n        var result = {};\r\n        if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n        result[\"default\"] = mod;\r\n        return result;\r\n    };\r\n\r\n    __importDefault = function (mod) {\r\n        return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n    };\r\n\r\n    exporter(\"__extends\", __extends);\r\n    exporter(\"__assign\", __assign);\r\n    exporter(\"__rest\", __rest);\r\n    exporter(\"__decorate\", __decorate);\r\n    exporter(\"__param\", __param);\r\n    exporter(\"__metadata\", __metadata);\r\n    exporter(\"__awaiter\", __awaiter);\r\n    exporter(\"__generator\", __generator);\r\n    exporter(\"__exportStar\", __exportStar);\r\n    exporter(\"__values\", __values);\r\n    exporter(\"__read\", __read);\r\n    exporter(\"__spread\", __spread);\r\n    exporter(\"__await\", __await);\r\n    exporter(\"__asyncGenerator\", __asyncGenerator);\r\n    exporter(\"__asyncDelegator\", __asyncDelegator);\r\n    exporter(\"__asyncValues\", __asyncValues);\r\n    exporter(\"__makeTemplateObject\", __makeTemplateObject);\r\n    exporter(\"__importStar\", __importStar);\r\n    exporter(\"__importDefault\", __importDefault);\r\n});\r\n","import * as tslib from 'tslib/tslib';\nimport { requestIdleCallback } from 'requestidlecallback';\n\nexport enum Environment {\n    window = 'window',\n    worker = 'worker'\n}\n\nexport enum TimeoutDuration {\n    webComponent = 60000,\n    indexDbIsAccessible = 100\n}\n\nexport enum MessageQueueName {\n    webComponent = 'webComponent'\n}\n\nexport enum Prefix {\n    vamtigerBrowserMethod = 'vamtiger-browser-method',\n    db = 'vamtiger-browser-method',\n    messageIdWindow = 'vamtiger-browser-method-window',\n    messageIdWorker = 'vamtiger-browser-method-worker'\n}\n\nexport enum Origin {\n    nowhere = '',\n    everyWhere = '*'\n}\n\nexport enum HostName {\n    localHost = 'localhost'\n}\n\nexport enum LocalHostRelativePath {\n    vamtigerBrowserMethod = 'vamtiger-browser-method.js'\n}\n\nexport enum ScriptType {\n    js = 'text/javascript',\n    json = 'application/json',\n    jsonld = 'application/ld+json'\n}\n\nexport enum ScriptAttribute {\n    type = 'type'\n}\n\nexport enum DataAttribute {\n    vamtigerElementQuery = 'vamtigerLoadElementQueryCss',\n    elementQueryCssLoaded = 'elementQueryCssLoaded'\n}\n\nexport enum ErrorMessage {\n    failedToLoadScript = 'Failed to load script',\n    windowPropertyNotSet = 'Window property not set',\n    unsupportedFeature = 'Unsupported feature',\n    customElementAreadyDefined = 'Custom element already defined',\n    noElementName = 'No Element Name',\n    noTemplateUrl = 'No Template URL',\n    noElementSelector = 'No Template Selector',\n    noTemplateForUrl = 'No Template for URL',\n    noTemplate = 'No Template',\n    noElementForSelector = 'No Element for Selector',\n    noJsonLdParameter = 'No \"jsonLd\" property set'\n}\n\nexport enum StringConstant {\n    nothing = '',\n    slash = '/',\n    dash = '-',\n    pipe = '|',\n    comma = ',',\n    backTick = '`',\n    doubleQuote = '\"',\n    commaSpace = ', '\n}\n\nexport enum TagName {\n    div = 'div',\n    template = 'template'\n}\n\nexport enum LinkRel {\n    stylesheet = 'stylesheet'\n}\n\nexport enum LoadScriptElement {\n    script = 'script',\n    link = 'link',\n    style = 'style'\n}\n\nexport enum Selector {\n    lastStylesheet = 'style:last-of-type',\n    lastMetaElement = 'head > meta:last-of-type',\n    webcomponentsjs = 'script[src*=\"@webcomponents\\/webcomponentsjs\"]',\n    style = 'style',\n    stylesheet = ' link[rel=\"stylesheet\"]',\n    vamtigerBrowserMethodJsonJs = '[src$=\"vamtiger-browser-method.js.json.js\"]',\n    vamtigerBrowserMethodJson = '[data-name$=\"vamtiger-browser-method.js.json\"]',\n    vamtigerBrowserMethod = '[data-name$=\"vamtiger-browser-method.js\"]',\n    script = 'script',\n    jsonScript = 'script[type=\"application/json\"]',\n    jsonLdScript = 'script[type=\"application/ld+json\"]',\n    a = 'a',\n    linkedDataCaption = '[data-linked-data-caption]',\n    linkedDataCaptionElement = '[data-linked-data-caption-element]',\n}\n\nexport enum  MetaElementName {\n    loadElementQueryCss = 'vamtiger-load-element-query-css'\n}\n\nexport enum ScriptNameSuffix {\n    style = 'style',\n    stylesheet = 'stylesheet'\n}\n\nexport enum MessageAction {\n    ignore = 'ignore',\n    removeRedundantScripts = 'removeRedundantScripts',\n    setWorkerSupport = 'setWorkerSupport',\n    saveWebComponentData = 'saveWebComponentData',\n    getWebComponentData = 'getWebComponentData',\n    dequeue = 'dequeue',\n    loadWebComponentData = 'loadWebComponentData',\n    saveSupport = 'saveSupport'\n}\n\nexport enum DbName {\n    vamtigerBrowserSupport = 'vamtiger-browser-support'\n}\n\nexport enum DbStoreName {\n    support = 'support',\n    webComponent = 'web-component'\n}\n\nexport enum DbMode {\n    readonly = 'readonly',\n    readwrite = 'readwrite',\n    versionchange = 'versionchange'\n}\n\nexport enum DbKeyPath {\n    webComponent = 'url',\n    support = 'environment'\n}\n\nexport interface IDequeue {\n    key: string;\n    data: IAnyObject;\n}\n\nexport interface IGetDbParams {\n    storeName: DbStoreName;\n    keyPath: DbKeyPath;\n    mode: DbMode;\n}\n\nexport interface IGetDbParamsHandleUpgradeNeeded extends Pick<IDbParams, 'db'>{}\n\nexport interface IDbParams {\n    db: IDBDatabase;\n    transaction: IDBTransaction;\n    store: IDBObjectStore;\n}\n\nexport interface ILoadRemoteScriptParams {\n    src: string;\n}\n\nexport interface ILoadRemoteStylesheetScriptParams {\n    href: string;\n}\n\nexport interface IIsJsonScript {\n    script: HTMLScriptElement;\n}\n\nexport interface ILoadLocalScriptParams {\n    name: string;\n    removeFromDom?: boolean;\n}\n\nexport interface ILoadScriptParams {\n    js: string;\n    jsonld?: boolean;\n}\n\nexport interface ILoadJsonScriptParams {\n    json: string;\n}\n\nexport interface ILoadStylesheetScriptParams {\n    css: string;\n}\n\nexport interface IAnyObject {\n    [key: string]: any;\n}\n\nexport interface IJsonData {\n    jsonLd: IAnyObject[];\n    json?: IAnyObject;\n}\n\nexport interface ILoadScript {\n    params: LocalScriptParams\n        | LocalStylesheetScriptParams\n        | ILoadRemoteScriptParams\n        | ILoadRemoteStylesheetScriptParams\n        | ILoadJsonScriptParams;\n    reject: (error: Error) => void\n}\n\nexport interface ILoadShadowStylesheet {\n    css: string;\n    element: HTMLElement;\n}\n\nexport interface IJsonScriptData {\n    name: string;\n    text: string;\n}\n\nexport interface IDefineCustomElement {\n    name: string;\n    constructor: {\n        new (): HTMLElement\n        prototype: HTMLElement;\n    };\n    ignore?: boolean;\n}\n\nexport interface IPause {\n    milliseconds: number;\n}\n\nexport interface IGetElementBase {\n    name: string;\n    loadStylesheets?: boolean;\n}\n\nexport interface IGetElementTemplate extends IGetElementBase {\n    template: string;\n    selector?: string;\n}\n\nexport interface IGetElementUrl extends IGetElementBase {\n    url: string;\n    selector:  string;\n}\n\nexport interface ILoadElementQueryCss {\n    css: string;\n    stylesheetName?: string;\n    hostName?: string;\n}\n\nexport interface IGetMetaElement {\n    selector?: string;\n    properties?: {\n        id?: string;\n    };\n    attributes?: {\n        [key: string]: string;\n    };\n    dataset?: DOMStringMap;\n}\n\nexport interface ILoadContainerStylesheets {\n    name: string;\n    container: HTMLTemplateElement;\n}\n\nexport interface IGetData {\n    jsonLd: string;\n}\n\nexport interface IGetJsonLd {\n    jsonLd: string;\n}\n\nexport interface IJosnLdImageObject {\n    \"@context\": string;\n    '@type': string;\n    name: string;\n    description: string;\n    author: {\n        '@type': string;\n        givenName: string;\n        familyName: string;\n        email: string;\n    };\n    datePublished: string;\n    contentUrl: string;\n}\n\nexport interface IMessageAction {\n    action: MessageAction;\n    params: IAnyObject & {\n        messageId?: string;\n    };\n}\n\nexport interface IRemoveRedundantScripts {\n    selector: string;\n}\n\nexport interface IRemoveRedundantScriptsRemoveScripts extends IRemoveRedundantScripts {\n    parent: HTMLElement;\n}\n\nexport interface IRemoveRedundantScriptsRemoveScriptsFromParent extends IRemoveRedundantScriptsRemoveScripts {\n    resolve?: () => void;\n    reject?: (error: Error) => void;\n}\n\nexport interface ISupport {\n    localStorage: boolean;\n    indexedDb: boolean;\n    indexedDbIsAccessible: boolean;\n    worker: boolean;\n    sharedWorker: boolean;\n    textEncoder: boolean;\n    textDecoder: boolean;\n}\n\nexport interface ISaveSupport extends ISupport {\n    environment: Environment;\n}\n\nexport interface ISaveWebComponentData extends IWebComponentData {}\n\nexport interface IGetWebComponentData {\n    key: string;\n}\n\nexport interface IGetDbName {\n    dbName: DbName\n}\n\nexport interface ISaveIndexedDbData {\n    storeName: DbStoreName;\n    keyPath: DbKeyPath;\n    messageId?: string;\n    data: IWebComponentData | ISupport;\n}\n\nexport interface IGetIndexedDbData {\n    storeName: DbStoreName;\n    keyPath: DbKeyPath;\n    key: string;\n    messageId?: string;\n}\n\nexport interface ISaveIndexedDbDataHandleSuccess {\n    messageId?: string;\n    key: string;\n}\n\nexport interface IWebComponentData {\n    url: string;\n    created?: number;\n    messageId?: string;\n    jsonLd: IAnyObject[];\n    json: IAnyObject;\n}\n\nexport interface ISaveWebComponentDataWorker extends ISaveWebComponentData {}\n\nexport interface IMessageQueueEntry {\n    resolve: (result: any) => void;\n    reject: (reason: Error) => void;\n}\n\nexport interface IQueue extends NonNullable<Pick<IMessageQueueEntry, 'resolve' | 'reject'>> {\n    key: string;\n}\n\nexport interface IQueueHandleExpiredQueueEntry {\n    key: string;\n    queueEntry: IMessageQueueEntry;\n}\n\nexport interface ILoadData {\n    url: string;\n}\n\nexport interface IGetMicrodataCaption {\n    imageData: IAnyObject;\n    fieldKey: string;\n}\n\nexport interface IGetTemplate {\n    selector: Selector;\n    attributes?: IAttributes;\n    properties?: IProperties;\n}\n\nexport interface IProperties {\n    name?: string;\n    src?: string;\n    alt?: string;\n    innerHTML?: string;\n}\n\nexport type WebComponentDataResolve = (webComponent: IJsonData | undefined) => void;\n\nexport type ErrorResolve = (error: Error) => void;\n\nexport type MessageResponse = IMessageAction | undefined | null | false;\n\nexport type TsLibType = typeof tslib;\n\nexport type TsLibKey = keyof TsLibType;\n\nexport type TsLib = {\n    [K in TsLibKey]: TsLibType[K]\n}\n\nexport type LocalScriptParams = ILoadLocalScriptParams & ILoadScriptParams;\n\nexport type LocalStylesheetScriptParams = ILoadLocalScriptParams & ILoadStylesheetScriptParams;\n\nexport type LoadScriptParams = LocalScriptParams\n    | LocalStylesheetScriptParams\n    | ILoadRemoteScriptParams\n    | ILoadRemoteStylesheetScriptParams;\n\nexport type LoadScriptsParams = LoadScriptParams[];\n\nexport type LoadScriptsSequentiallyParams = LoadScriptsParams[];\n\nexport type LoadedScript<P extends ILoadScript['params']> =\n    P extends ILoadScriptParams ? HTMLScriptElement :\n    P extends ILoadStylesheetScriptParams ? HTMLStyleElement :\n    P extends ILoadRemoteScriptParams ? HTMLScriptElement :\n    P extends ILoadRemoteStylesheetScriptParams ? HTMLLinkElement :\n    never;\n\nexport type LoadedScripts<P extends LoadScriptsParams> =\n    P extends ILoadScriptParams[] ? HTMLScriptElement[] :\n    P extends ILoadStylesheetScriptParams[] ? HTMLStyleElement[] :\n    P extends ILoadRemoteScriptParams[] ? HTMLScriptElement[] :\n    P extends ILoadRemoteStylesheetScriptParams[] ? HTMLLinkElement[] :\n    never;\n\nexport type LoadedScriptsSequentially<P extends LoadScriptsSequentiallyParams> =\n    P extends ILoadScriptParams[][] ? HTMLScriptElement[] :\n    P extends ILoadStylesheetScriptParams[][] ? HTMLStyleElement[] :\n    P extends ILoadRemoteScriptParams[][] ? HTMLScriptElement[] :\n    P extends ILoadRemoteStylesheetScriptParams[][] ? HTMLLinkElement[] :\n    never;\n\nexport type GetElementParams = IGetElementTemplate | IGetElementUrl;\n\nexport type VamtigerBrowserMethod = {\n    loadScript: <P extends LocalScriptParams | LocalStylesheetScriptParams | ILoadRemoteScriptParams | ILoadRemoteStylesheetScriptParams>(params: P) => Promise<LoadedScript<P>>;\n    loadScripts: <P extends LoadScriptParams[]>(params: P) => Promise<LoadedScripts<P>>;\n    loadScriptsSequentially: <P extends LoadScriptParams[][]>(params: P) => Promise<LoadedScriptsSequentially<P>>;\n    loadShadowStylesheet: ({ css, element }: ILoadShadowStylesheet) => void;\n    defineCustomElement: ({ name, constructor, ignore }: IDefineCustomElement) => void;\n    pause: ({ milliseconds }: IPause) => Promise<unknown>;\n    getElement: <P extends GetElementParams>(params: P) => Promise<HTMLElement>;\n    getData: ({ jsonLd }: IGetData) => Promise<IJsonData>;\n    getEnvironment: () => Environment;\n    environment: Environment;\n    getMicrodataCaption: (params: IGetMicrodataCaption) => HTMLElement | null | undefined\n    messageQueue: Map<string, Set<IMessageQueueEntry>>;\n    worker?: Worker;\n    support?: ISupport;\n    workerSupport?: ISupport;\n};\n\nexport interface IAttributes {\n    id?: string;\n    for?: string;\n    slot?: string;\n    'data-image-figure'?: string;\n    'data-json-ld'?: string;\n    itemprop?: string;\n}\n\nexport type JsonDataResolve = (data: IJsonData) => void;\n\nexport type WorkerPostMessage = (message: string | Uint8Array) => void;\n\nexport type GetIndexedDbData<P extends IGetIndexedDbData> =\n    P['keyPath'] extends DbKeyPath.webComponent ? IWebComponentData | undefined :\n    P['keyPath'] extends DbKeyPath.support ? ISaveSupport :\n    never;\n\nexport type DbKeyPathName = keyof typeof DbKeyPath;\n\nexport type DbStoreNameKey = keyof typeof DbStoreName;\n\nexport type AttributesKey = keyof IAttributes;\n\nexport type GetTemplate<P extends IGetTemplate> =\n    P['selector'] extends Selector.a ? HTMLAnchorElement :\n    P['selector'] extends  Selector.linkedDataCaptionElement ? HTMLSpanElement :\n    P['selector'] extends Selector.linkedDataCaption ? HTMLElement :\n    null;\n\ndeclare global {\n    interface Window extends TsLib {\n        VamtigerBrowserMethod: VamtigerBrowserMethod;\n        EQCSS: IAnyObject;\n        requestIdleCallback?: typeof requestIdleCallback\n    }\n\n    namespace NodeJS {\n        interface  Global {\n            VamtigerBrowserMethod: Window['VamtigerBrowserMethod'];\n        }\n    }\n}\n\nexport const regex = {\n    showRootHost: /:{1,2}host/gm,\n    dash: new RegExp(StringConstant.dash, 'g'),\n    space: /\\s/g,\n    nonWord: /\\W+/g,\n    backTicks: /`/gm\n}\n\nexport const selector = {\n    worker: [\n        Selector.vamtigerBrowserMethod\n    ].join(StringConstant.comma),\n    redundantScripts: [\n        Selector.vamtigerBrowserMethodJsonJs,\n        Selector.vamtigerBrowserMethodJson,\n        Selector.vamtigerBrowserMethod\n    ].join(StringConstant.comma)\n}\n\nexport const sendMessageFromWorker = postMessage as WorkerPostMessage;","import * as tslib from '../node_modules/tslib/tslib';\nimport { TsLibKey } from './types';\n\nconst tsLibKeys = Object.keys(tslib) as TsLibKey[];\n\ntsLibKeys.forEach(key => {\n    if (!self[key]) {\n        self[key] = tslib[key];\n    }\n});","import {\n    IGetMetaElement,\n    StringConstant,\n    Selector\n} from './types';\n\nconst { nothing } = StringConstant;\n\nexport default function ({ selector = nothing, properties = {}, dataset = {}, attributes = {}}: IGetMetaElement) {\n    const { id } = properties;\n    const { head } = document;\n    const lastMetaElement = head.querySelector<HTMLMetaElement>(Selector.lastMetaElement);\n    const attributeKeys = Object.keys(attributes);\n    const existingMetaElement = id && ((window as any)[id]\n        || selector && head.querySelector(selector)) as HTMLMetaElement;\n    const newMetaElment = !existingMetaElement && document.createElement('meta');\n    const metaElement = (existingMetaElement || newMetaElment) as HTMLMetaElement;\n\n    let dataKey: string;\n\n    if (newMetaElment) {\n        Object.assign(newMetaElment, properties);\n        Object.assign(newMetaElment.dataset, dataset);\n\n        if (lastMetaElement && lastMetaElement.nextElementSibling) {\n            head.insertBefore(\n                newMetaElment,\n                lastMetaElement.nextElementSibling\n            );\n        } else {\n            head.appendChild(newMetaElment);\n        }\n    }\n\n    attributeKeys.forEach(key => !metaElement.hasAttribute(key) && metaElement.setAttribute(dataKey, attributes[key]));\n\n    return metaElement;\n}","import {\n    regex,\n    StringConstant\n} from './types';\n\nconst { nothing } = StringConstant;\nconst { nonWord } = regex;\n\nexport default (input: string) => input\n    .split(nonWord)\n    .map((word, index) => !index && word.toLowerCase() || word.slice(0, 1).toUpperCase() + word.slice(1).toLowerCase())\n    .join(nothing);","import {\n    ILoadElementQueryCss,\n    MetaElementName,\n    StringConstant,\n    regex\n} from './types';\nimport getMetaElment from './get-meta-element';\nimport getCamelCase from './get-camel-case';\n\nconst { showRootHost } = regex;\nconst { nothing } = StringConstant;\n\nexport default function({ css, stylesheetName: currentStylesheetName = nothing, hostName = nothing }: ILoadElementQueryCss) {\n    const metaElement = getMetaElment({\n        properties: {\n            id: MetaElementName.loadElementQueryCss\n        }\n    });\n    const stylesheetName = getCamelCase(currentStylesheetName);\n    const { dataset } = metaElement;\n    const elementQueryCss = !dataset.hasOwnProperty(hostName) && (hostName && css.replace(showRootHost, hostName)) || css;\n    const { EQCSS } = self;\n\n    if (elementQueryCss && EQCSS) {\n        EQCSS.register(EQCSS.parse(elementQueryCss));\n\n        if (stylesheetName) {\n            dataset[stylesheetName] = nothing;\n        } else if (hostName) {\n            dataset[hostName] = nothing;\n        }\n    }\n}","import {\n    ILoadScript,\n    ErrorMessage,\n    LocalScriptParams,\n    LocalStylesheetScriptParams,\n    ILoadRemoteStylesheetScriptParams,\n    ILoadRemoteScriptParams,\n    ILoadJsonScriptParams,\n    LoadScriptElement,\n    LoadedScript,\n    LinkRel,\n    ScriptAttribute,\n    ScriptType\n} from './types';\nimport loadElementQueryCss from './load-element-query-css';\n\nconst { failedToLoadScript } = ErrorMessage;\nconst { stylesheet } = LinkRel;\nconst { script: scriptElement, link, style } = LoadScriptElement;\n\nexport default <P extends ILoadScript['params']>(params: P) => new Promise((resolve: (script: LoadedScript<P>) => void, reject: ILoadScript['reject']) => {\n    const { head, body } = document;\n    const { js, name: scriptName, jsonld, removeFromDom } = params as LocalScriptParams;\n    const { src } = params as ILoadRemoteScriptParams;\n    const { css, name: stylesheetName } = params as LocalStylesheetScriptParams;\n    const { href } = params as ILoadRemoteStylesheetScriptParams;\n    const { json } = params as ILoadJsonScriptParams;\n    const remoteScript = params.hasOwnProperty('src') || params.hasOwnProperty('href');\n    const element = (js || src) && scriptElement\n        || css && style\n        || href && link;\n    const selector = src && `script[src=\"${src}\"]`\n        || href && `link[href=\"${href}\"]`\n        || js && scriptName && `script[data-name=\"${scriptName}\"]`\n        || css && stylesheetName && `style[data-name=\"${stylesheetName}\"]`;\n    const existingScript = (head.querySelector(selector) || body.querySelector(selector)) as LoadedScript<P>;\n    const script = selector\n        && element\n        && document.createElement(element) as LoadedScript<P>;\n\n    if (script instanceof HTMLScriptElement) {\n        if (src) {\n            script.src = src;\n        } else if (json || js) {\n            script.innerHTML = json || js;\n            script.dataset.name = scriptName;\n\n            if (jsonld) {\n                script.setAttribute(ScriptAttribute.type, ScriptType.jsonld);\n            } else if (json) {\n                script.setAttribute(ScriptAttribute.type, ScriptType.json);\n            }\n        }\n    } else if (script instanceof HTMLLinkElement) {\n        script.rel = stylesheet;\n        script.href = href;\n    } else if (script instanceof HTMLStyleElement) {\n        script.innerHTML = css;\n        script.dataset.name = stylesheetName;\n\n        loadElementQueryCss({\n            css,\n            stylesheetName\n        });\n    }\n\n    if (existingScript) {\n        resolve(existingScript);\n    } else if (script) {\n        script.addEventListener('load', handleLoad);\n        script.addEventListener('error', handleLoadError);\n\n        head.appendChild(script);\n\n        if (!remoteScript) {\n            handleLoad();\n        }\n    }\n\n    function handleLoad() {\n        if (script) {\n            removeEventListeners();\n\n            if (removeFromDom) {\n                head.removeChild(script);\n            }\n\n            resolve(script);\n        }\n    }\n\n    function handleLoadError(event: Event) {\n        removeEventListeners();\n\n        console.error(event);\n\n        reject(new Error(`${failedToLoadScript}`));\n    }\n\n    function removeEventListeners() {\n        if (script) {\n            script.removeEventListener('load', handleLoad);\n            script.removeEventListener('error', handleLoadError);\n        }\n    }\n});\n","import { IDefineCustomElement, ErrorMessage } from './types';\n\nconst { unsupportedFeature, customElementAreadyDefined } = ErrorMessage;\n\nexport default function defineCustomElement({ name, constructor, ignore }: IDefineCustomElement) {\n    const { customElements } = self;\n    const define = customElements && customElements.define;\n    const existingElement = define && customElements.get && customElements.get(name);\n\n    if (define && !existingElement) {\n        customElements.define(name, constructor);\n    } else if (existingElement) {\n        throw new Error(`${customElementAreadyDefined}: ${name}`);\n    } else if (!ignore) {\n        defineCustomElement({ name, constructor, ignore: true });\n    } else {\n        throw new Error(`${unsupportedFeature}: Custom Elements - ${name}`);\n    }\n}","import { IPause } from './types';\n\nexport default ({ milliseconds = 1000 }: IPause) => new Promise((resolve, reject) => setTimeout(resolve, milliseconds));","\nimport {\n    ILoadContainerStylesheets,\n    ScriptNameSuffix,\n    StringConstant,\n    Selector\n} from './types';\nimport loadScript from './load-script'\n\nconst { dash } = StringConstant;\n\nexport default function(params: ILoadContainerStylesheets) { return new Promise((resolve: (styleElements: HTMLStyleElement[]) => void, reject) => {\n    const { requestIdleCallback } = self;\n\n    if (requestIdleCallback) {\n        requestIdleCallback(() => loadStylesheets(params, resolve));\n    } else {\n        loadStylesheets(params, resolve);\n    }\n})};\n\nasync function loadStylesheets(params: ILoadContainerStylesheets, resolve: (styleElements: HTMLStyleElement[]) => void) {\n    const { container, name } = params;\n    const styles = Array\n        .from(container.content.querySelectorAll<HTMLStyleElement>(Selector.style))\n        .map((style, index) => ({\n            name: [\n                name,\n                ScriptNameSuffix.style,\n                index++\n            ].join(dash),\n            css: style.innerHTML\n        }));\n    const stylesheets = Array\n        .from(container.content.querySelectorAll<HTMLLinkElement>(Selector.stylesheet))\n        .map((stylesheet, index) => ({\n            name: [\n                name,\n                ScriptNameSuffix.stylesheet,\n                index++\n            ].join(dash),\n            href: stylesheet.href\n        }));\n    const styleElements = await Promise.all([\n        ...styles.map(loadScript),\n        ...stylesheets.map(loadScript)\n    ]);\n\n    resolve(styleElements);\n}","import {\n    IGetElementTemplate,\n    TagName,\n    ErrorMessage\n} from './types';\nimport loadContainerStylesheets from './load-container-stylesheets';\n\nconst {\n    noElementName,\n    noTemplate,\n    noElementForSelector\n} = ErrorMessage;\n\nexport default async function (params: IGetElementTemplate) {\n    const { name, template, loadStylesheets, selector } = params;\n    const container = name && template && document.createElement(TagName.template);\n\n    let element: HTMLElement | null = null;\n\n    if (!name) {\n        throw new Error(noElementName);\n    } else if (!template) {\n        throw new Error(noTemplate);\n    }\n\n    if (container) {\n        container.innerHTML = template;\n\n        element = selector && container.content.firstElementChild && container.content.firstElementChild.querySelector(selector)\n            || container.content.firstElementChild as HTMLElement;\n\n        loadStylesheets && element && await loadContainerStylesheets({\n            ...params,\n            container\n        });\n    }\n\n    if (!element) {\n        throw new Error(noElementForSelector);\n    }\n\n    element.dataset.name = name;\n\n    return element;\n}","import {\n    IGetElementUrl,\n    TagName,\n    ErrorMessage\n} from './types';\nimport loadContainerStylesheets from './load-container-stylesheets';\n\nconst {\n    noElementName,\n    noElementSelector,\n    noTemplateUrl,\n    noTemplateForUrl,\n    noElementForSelector\n} = ErrorMessage;\n\nexport default async function (params: IGetElementUrl) {\n    const { name, url, selector, loadStylesheets } = params;\n    const { head } = document;\n    const template = name && selector && url && await fetch(url)\n        .then(response => response.text());\n    const container = template && document.createElement(TagName.template);\n\n    let element: HTMLElement | null = null;\n\n    if (!name) {\n        throw new Error(noElementName);\n    } else if (!selector) {\n        throw new Error(noElementSelector);\n    } else if (!url) {\n        throw new Error(noTemplateUrl);\n    } else if (!template) {\n        throw new Error(noTemplateForUrl);\n    }\n\n    if (container) {\n        container.innerHTML = template;\n\n        element = container.content.querySelector<HTMLElement>(selector);\n\n        loadStylesheets && element && await loadContainerStylesheets({\n            ...params,\n            container\n        });\n    }\n\n    if (!element) {\n        throw new Error(noElementForSelector);\n    }\n\n    element.setAttribute('dataset-name', name);\n\n    return element;\n}\n","import {\n    Environment\n} from './types';\n\nexport default function () {\n    const { VamtigerBrowserMethod } = self;\n    const { environment } = VamtigerBrowserMethod;\n    const isWindow = environment === Environment.window;\n\n    return isWindow;\n}","import {\n    Environment\n} from './types';\n\nexport default function () {\n    const { VamtigerBrowserMethod } = self;\n    const { environment } = VamtigerBrowserMethod;\n    const isWorker = environment === Environment.worker;\n\n    return isWorker;\n}","import {\n    IMessageAction,\n    ISupport,\n    sendMessageFromWorker\n} from './types';\nimport isWindow from './is-window';\nimport isWorker from './is-worker';\n\nconst { stringify } = JSON;\nconst textEncoder = new TextEncoder();\n\nexport default function (params: IMessageAction) {\n    const { VamtigerBrowserMethod } = self;\n    const { worker, support } = VamtigerBrowserMethod;\n    const { textEncoder: textEncoderSupport } = support || {} as ISupport;\n    const stringMessage = stringify(params);\n    const message = textEncoderSupport && textEncoder.encode(stringMessage)\n        || stringMessage;\n\n    isWindow() && worker && worker.postMessage(message);\n\n    isWorker() && sendMessageFromWorker(message)\n}","import {\n    IIsJsonScript\n} from './types';\n\nconst { parse } = JSON;\n\nexport default function ({ script }: IIsJsonScript) {\n    const { innerHTML } = script;\n\n    let isJson = false;\n\n    try {\n        parse(innerHTML);\n        isJson = true;\n    } catch(error) {\n        console.warn(error);\n        isJson = false;\n    }\n\n    return isJson;\n}","import {\n    MessageAction,\n    IRemoveRedundantScripts,\n    IRemoveRedundantScriptsRemoveScripts,\n    IRemoveRedundantScriptsRemoveScriptsFromParent,\n    StringConstant,\n    ScriptType,\n    Prefix\n} from './types';\nimport isWindow from './is-window';\nimport isWorker from './is-worker';\nimport sendMessage from './send-message';\nimport isJsonScript from './is-json-script';\n\nconst { requestIdleCallback } = self;\nconst { dash } = StringConstant;\nconst { vamtigerBrowserMethod: prefix } = Prefix;\n\nexport default async function (params: IRemoveRedundantScripts) {\n    isWindow() && await removeRedundantScripts(params);\n\n    isWorker() && sendRemoveRedundantScriptsMessage(params);\n}\n\nasync function removeRedundantScripts(params: IRemoveRedundantScripts) {\n    const { head: parent } = document;\n\n    await removeScripts({...params, parent});\n}\n\nexport function removeScripts(params: IRemoveRedundantScriptsRemoveScripts) {return new Promise((resolve, reject) => {\n    if (requestIdleCallback) {\n        requestIdleCallback(() => removeScriptsFromParent({...params, resolve, reject }));\n    } else {\n        removeScriptsFromParent({...params, resolve, reject });\n    }\n})}\n\nfunction removeScriptsFromParent({ selector, parent, resolve, reject }: IRemoveRedundantScriptsRemoveScriptsFromParent) {\n    const { head } = document;\n    const scripts = Array.from(parent.querySelectorAll<HTMLScriptElement>(selector));\n    const jsScripts = scripts.filter(({type, src}) => src || !type || type === ScriptType.js);\n    const jsonScripts = scripts\n        .filter(({ type }) => type === ScriptType.json)\n        .filter(script => isJsonScript({ script }));\n    const jsonLdScripts = scripts\n        .filter(({ type }) => type === ScriptType.jsonld)\n        .filter(script => isJsonScript({ script }));\n    const safeScripts = jsonLdScripts.concat(jsonScripts);\n    const time = new Date().getTime();\n    const jsonScriptName = jsonScripts.length && [\n        prefix,\n        ScriptType.json,\n        time\n    ].join(dash);\n    const jsonScriptSelector = jsonScriptName && `script[type=\"${ScriptType.json}\"][data-name=\"${jsonScriptName}\"]`;\n    const jsonLdScriptName = jsonLdScripts.length && [\n        prefix,\n        ScriptType.jsonld,\n        time\n    ].join(dash);\n    const jsonLdScriptSelector = jsonLdScriptName && `script[type=\"${ScriptType.jsonld}\"][data-name=\"${jsonLdScriptName}\"]`;\n\n    jsScripts.length && jsonScriptName && jsScripts.forEach(({ dataset }) => dataset.name = jsonScriptName || '');\n\n    jsonLdScripts.length && jsonLdScriptName && jsonLdScriptSelector && jsonLdScripts.forEach(({ dataset }) => dataset.name = jsonLdScriptName || '');\n\n    if (jsonScriptSelector && parent !== head) {\n        parent.dataset.json = jsonScriptSelector;\n    }\n\n    if (jsonLdScriptSelector && parent !== head) {\n        parent.dataset.jsonLd = jsonLdScriptSelector;\n    }\n\n    if (scripts.length) {\n        parent.dataset.removedScripts = scripts.length.toString();\n    }\n\n    safeScripts.forEach(script => head.appendChild(script));\n\n    scripts.forEach(script => parent.removeChild(script));\n\n    resolve && resolve();\n}\n\nexport function sendRemoveRedundantScriptsMessage({ selector }: IRemoveRedundantScripts) {\n    const massage = {\n        action: MessageAction.removeRedundantScripts,\n        params: {\n            selector\n        }\n    };\n\n    sendMessage(massage);\n}","import {\n    GetElementParams,\n    IGetElementTemplate,\n    IGetElementUrl,\n    Selector\n} from './types';\nimport getElementFromTemplate from './get-element-from-template';\nimport getElementFromUrl from './get-element-from-url';\nimport { removeScripts } from './remove-redundant-scripts';\n\nconst { script: selector } = Selector;\n\nexport default async function<P extends GetElementParams>(params: P) { return new Promise((resolve: (element: HTMLElement) => void, reject) => {\n    const { requestIdleCallback } = self;\n\n    if (requestIdleCallback) {\n        requestIdleCallback(() => getElement(params, resolve));\n    } else {\n        getElement(params, resolve);\n    }\n})}\n\nexport async function getElement<P extends GetElementParams> (params: P, resolve: (element: HTMLElement) => void) {\n    let element: HTMLElement;\n\n    if ((params as IGetElementUrl).url) {\n        element = await getElementFromUrl(params as IGetElementUrl);\n    } else {\n        element = await getElementFromTemplate(params as IGetElementTemplate);\n    }\n\n    element && await removeScripts({ selector, parent: element });\n\n    resolve(element);\n}","import {\n    IQueue,\n    IMessageQueueEntry,\n    IQueueHandleExpiredQueueEntry,\n    TimeoutDuration\n} from './types';\n\nconst { webComponent: timeout } = TimeoutDuration;\n\nexport default function ({key, resolve, reject }: IQueue) {\n    const { VamtigerBrowserMethod } = self;\n    const queueEntry = {\n        resolve,\n        reject\n    };\n    const { messageQueue } = VamtigerBrowserMethod;\n\n    let queue: Set<IMessageQueueEntry> | undefined;\n\n    !messageQueue.has(key) && messageQueue.set(key, new Set());\n\n    queue = messageQueue.get(key);\n\n    queue && queue.add(queueEntry);\n\n    setTimeout(() => handleExpiredQueueEntry({ key, queueEntry }), timeout)\n}\n\nfunction handleExpiredQueueEntry({ key, queueEntry }: IQueueHandleExpiredQueueEntry) {\n    const { VamtigerBrowserMethod } = self;\n    const { messageQueue } = VamtigerBrowserMethod;\n    const queue = messageQueue.get(key);\n\n    if (queue) {\n        queue.has(queueEntry) && queue.delete(queueEntry);\n\n        !queue.size && messageQueue.delete(key);\n    }\n}","import {\n    IGetDbParams,\n    IGetDbParamsHandleUpgradeNeeded,\n    IDbParams,\n    DbName,\n    DbStoreName,\n    DbStoreNameKey,\n    DbKeyPathName,\n    DbKeyPath\n} from './types';\n\nconst { vamtigerBrowserSupport: dbName } = DbName;\n\nexport default async function (params: IGetDbParams) {\n    const { storeName, keyPath, mode } = params;\n    const db = await getDb();\n    const transaction = db && db.transaction && db.transaction(storeName, mode);\n    const store = transaction && transaction.objectStore && transaction.objectStore(storeName);\n    const dbParams: IDbParams = {\n        db,\n        transaction,\n        store\n    };\n\n    return dbParams;\n}\n\nexport function getDb() {return new Promise((resolve: (db: IDBDatabase) => void, reject) => {\n    const dbRequest = indexedDB.open(dbName, 1);\n\n    dbRequest.addEventListener('error', reject);\n\n    dbRequest.addEventListener('upgradeneeded', () => handleUpgradeNeeded({ db: dbRequest.result }));\n\n    dbRequest.addEventListener('success', () => resolve(dbRequest.result));\n})}\n\nfunction handleUpgradeNeeded({ db }: IGetDbParamsHandleUpgradeNeeded) {\n    const storeNames = Object.keys(DbKeyPath);\n\n    storeNames.forEach(storeName => !db.objectStoreNames.contains(storeName) && db.createObjectStore(DbStoreName[storeName as DbStoreNameKey], {\n        keyPath: DbKeyPath[storeName as DbKeyPathName]\n    }));\n}","import {\n    ISaveIndexedDbData,\n    ISaveIndexedDbDataHandleSuccess,\n    DbMode,\n    MessageAction\n} from './types';\nimport getDbParams from './get-db-params';\nimport sendMessage from './send-message';\n\nconst { readwrite: mode } = DbMode;\nconst { getWebComponentData: action } = MessageAction;\n\nexport default async function ({ storeName, keyPath, data, messageId }: ISaveIndexedDbData) {\n    const { store } = await getDbParams({\n        storeName,\n        keyPath,\n        mode\n    });\n    const save = store.put(data);\n\n    save.addEventListener('error', handleError);\n    save.addEventListener('success', () => handleSuccess({ messageId, key: keyPath }));\n}\n\nfunction handleSuccess({ messageId, key }: ISaveIndexedDbDataHandleSuccess) {\n    const message = messageId && {\n        action,\n        params: {\n            messageId,\n            key\n        }\n    };\n\n    message && sendMessage(message);\n}\n\nfunction handleError(error: Event) {\n    console.error(error);\n    throw error;\n}","import {\n    IGetIndexedDbData,\n    GetIndexedDbData,\n    DbMode\n} from './types';\nimport getDbParams from './get-db-params';\n\nconst { readonly: mode } = DbMode;\n\nexport default async function <P extends IGetIndexedDbData>({ storeName, keyPath, key }: P): Promise<GetIndexedDbData<P>> {return new Promise(async (resolve, reject) => {\n    const { store } = await getDbParams({\n        storeName,\n        keyPath,\n        mode\n    });\n    const get = store.get(key);\n\n    get.addEventListener('error', reject);\n    get.addEventListener('success', () => resolve(get.result));\n})}","import {\n    IDequeue\n} from './types';\n\nexport default function ({ key, data }: IDequeue) {\n    const { VamtigerBrowserMethod } = self;\n    const { messageQueue } = VamtigerBrowserMethod;\n    const queue = messageQueue.get(key) || new Set();\n\n    Array.from(queue).forEach((queueEntry) => {\n        queueEntry.resolve(data);\n\n        queue.delete(queueEntry);\n    });\n}","import {\n    IGetWebComponentData,\n    MessageAction,\n    DbKeyPath,\n    DbStoreName\n} from './types';\nimport isWindow from './is-window';\nimport isWorker from './is-worker';\nimport sendMessage from './send-message';\nimport getData from './get-indexed-db-data';\nimport dequeue from './dequeue';\n\nconst { getWebComponentData: action } = MessageAction;\n\nexport default function (params: IGetWebComponentData) {\n    const { VamtigerBrowserMethod } = self;\n    const { support, workerSupport } = VamtigerBrowserMethod;\n\n    if (isWindow()) {\n        if (workerSupport && workerSupport.indexedDbIsAccessible) {\n            return getWebComponentDataWindowWorker(params);\n        } else if (support && support.indexedDbIsAccessible) {\n            getWebComponentDataWindow(params);\n        }\n    } else if (isWorker()) {\n        return getWebComponentDataWorker(params);\n    }\n}\n\nexport async function getWebComponentDataWindow({ key }: IGetWebComponentData) {\n    const data = await getWebComponentData({ key });\n    const dequeueParams = data && {\n        key,\n        data\n    };\n\n    if (dequeueParams) {\n        dequeue(dequeueParams);\n    }\n}\n\nasync function getWebComponentDataWindowWorker({ key }: IGetWebComponentData) {\n    const message = {\n        action,\n        params: {\n            key\n        }\n    };\n\n    sendMessage(message);\n}\n\nexport async function getWebComponentDataWorker({ key }: IGetWebComponentData) {\n    const webComponent = await getWebComponentData({ key });\n    const message = webComponent && webComponent.jsonLd && webComponent.jsonLd.length && {\n        action: MessageAction.dequeue,\n        params: {\n            key,\n            data: {\n                jsonLd: webComponent.jsonLd,\n                json: webComponent.json\n            }\n        }\n    };\n\n    return message;\n}\n\nexport async function getWebComponentData({ key }: IGetWebComponentData) {\n    const webComponent = await getData({\n        storeName: DbStoreName.webComponent,\n        keyPath: DbKeyPath.webComponent,\n        key\n    });\n\n    return webComponent;\n}","import {\n    ISaveWebComponentData,\n    ISaveWebComponentDataWorker,\n    MessageAction,\n    DbStoreName,\n    DbKeyPath\n} from './types';\nimport isWindow from './is-window';\nimport isWorker from './is-worker';\nimport save from './save-indexed-db-data';\nimport sendMessage from './send-message';\nimport getWebComponentData from './get-web-component-data';\nimport removeRedundantScripts from './remove-redundant-scripts';\n\nconst { webComponent: storeName } = DbStoreName;\nconst { webComponent: keyPath } = DbKeyPath;\n\nexport default function (params: ISaveWebComponentData) {\n    if (isWindow()) {\n        return saveWebComponentDataWindow(params);\n    } else if (isWorker()) {\n        return saveWebComponentDataWorker(params);\n    }\n}\n\nasync function saveWebComponentDataWindow(params: ISaveWebComponentData) {\n    const { VamtigerBrowserMethod } = self;\n    const { support, workerSupport } = VamtigerBrowserMethod;\n    const { url: key } = params;\n    const selector = getSelector({ url: key });\n    const data = getData(params);\n    const message = data && {\n        action: MessageAction.saveWebComponentData,\n        params: data\n    };\n\n    if (workerSupport && workerSupport.indexedDbIsAccessible) {\n        message && sendMessage(message);\n    } else if (support && support.indexedDbIsAccessible) {\n        await saveWebComponentDataIndexDb(params);\n        await getWebComponentData({ key });\n        removeRedundantScripts({ selector });\n    }\n}\n\nasync function saveWebComponentDataWorker(params: ISaveWebComponentDataWorker) {\n    const { url } = params;\n    const selector = getSelector({ url });\n    const saveData = await saveWebComponentDataIndexDb(params);\n    const getWebComponentDataMessage = {\n        action: MessageAction.getWebComponentData,\n        params: {\n            key: url\n        }\n    };\n    const removeRedundantScriptsMessage = {\n        action: MessageAction.removeRedundantScripts,\n        params: {\n            selector\n        }\n    };\n\n    sendMessage(getWebComponentDataMessage);\n    sendMessage(removeRedundantScriptsMessage);\n}\n\nasync function saveWebComponentDataIndexDb(params: ISaveWebComponentData) {\n    const data = getData(params);\n    const saveParams = data && {\n        storeName,\n        keyPath,\n        data\n    };\n\n    saveParams && await save(saveParams);\n}\n\nfunction getData({ url, created = new Date().getTime(), json, jsonLd }: ISaveWebComponentData) {\n    const data = url && jsonLd && {\n        url,\n        created,\n        jsonLd: jsonLd,\n        json: json\n    };\n\n    return data;\n}\n\nfunction getSelector({ url }: Pick<ISaveWebComponentData, 'url'>) {\n    const selector = `script[type=\"application/json\"][data-json-ld=\"${url}\"]`;\n\n    return selector;\n}","import {\n    ILoadData, Selector\n} from './types';\nimport loadScript from './load-script';\nimport saveWebComponentData from './save-web-component-data';\nimport isWindow from './is-window';\n\nconst { parse } = JSON;\n\nexport default async function (params: ILoadData) {\n    return await (isWindow() && loadWebComponentData(params));\n}\n\nasync function loadWebComponentData({ url }: ILoadData) {\n    const { head } = document;\n    const selector = `${Selector.script}[src=\"${url}\"]`;\n    const existingScript = head.querySelector(selector);\n    const script = !existingScript && await loadScript({ src: url });\n    const jsonLdSelector = `script[type=\"application/ld+json\"][data-json-ld=\"${url}\"]`;\n    const jsonSelector = `script[type=\"application/json\"][data-json-ld=\"${url}\"]`;\n    const scripts = script && await Promise.all([\n        Array\n            .from(head.querySelectorAll<HTMLScriptElement>(jsonLdSelector))\n            .map(({ innerHTML }) => innerHTML),\n        head.querySelector<HTMLScriptElement>(jsonSelector)\n    ]);\n    const [ jsonLdScripts, jsonScript ] = scripts || [undefined, undefined];\n    const jsonLd = jsonLdScripts && jsonLdScripts.map(jsonLdScript => parse(jsonLdScript));\n    const json = jsonScript && parse(jsonScript.innerHTML) || {};\n    const params = jsonLd && {\n        url,\n        created: new Date().getTime(),\n        jsonLd,\n        json\n    };\n\n    params && saveWebComponentData(params);\n}","import {\n    IGetJsonLd,\n    WebComponentDataResolve,\n    ErrorResolve\n} from './types';\nimport queue from './queue';\nimport loadWebComponentData from './load-web-component-data';\nimport getWebComponentData from './get-web-component-data';\n\nexport default function ({ jsonLd: url }: IGetJsonLd) {return new Promise(async (resolve: WebComponentDataResolve, reject: ErrorResolve) => {\n    const queueParams = {\n        key: url,\n        resolve,\n        reject\n    };\n\n    queue(queueParams);\n\n    try {\n        await loadWebComponentData({ url });\n    } catch(error) {\n        console.error(error);\n    }\n\n    getWebComponentData({ key: url });\n})}","import {\n    IGetData,\n    ErrorMessage,\n    IJsonData\n} from './types';\nimport getJsonLd from './get-json-ld';\n\nconst { noJsonLdParameter } = ErrorMessage;\n\nexport default function({ jsonLd }: IGetData) { return new Promise((resolve: (data: IJsonData) => void, reject) => {\n    const { requestIdleCallback } = self;\n\n    if (jsonLd) {\n        if (requestIdleCallback) {\n            requestIdleCallback(() => getJsonLd({ jsonLd }).then(resolve));\n        } else {\n            getJsonLd({ jsonLd }).then(resolve);\n        }\n    } else {\n        reject(new Error(noJsonLdParameter));\n    }\n})}","import {\n    Environment\n} from './types';\n\nexport default function () {\n    const environment = self.hasOwnProperty('WorkerGlobalScope')\n        && Environment.worker\n        || Environment.window;\n\n    return environment;\n}","import {\n    IMessageAction,\n    MessageAction\n} from './types';\n\nconst { parse } = JSON;\nconst ignoreMessage = {\n    action: MessageAction.ignore,\n    params: {}\n}\nconst textDecoder = new TextDecoder();\n\nexport default function (event: MessageEvent) {\n    let message: IMessageAction;\n\n    try {\n        message = getMessageData(event) || ignoreMessage;\n    } catch(error) {\n        message = ignoreMessage;\n    }\n\n    return message;\n}\n\nfunction getMessageData({ data: message }: MessageEvent) {\n    const messageData: IMessageAction = typeof message === 'string' && parse(message)\n        || message instanceof Uint8Array && parse(textDecoder.decode(message));\n\n    if (typeof messageData.params === 'string') {\n        messageData.params = parse(messageData.params);\n    }\n\n    return messageData;\n}","import {\n    ISaveSupport,\n    MessageAction,\n    DbStoreName,\n    DbKeyPath\n} from './types';\nimport save from './save-indexed-db-data';\nimport isWindow from './is-window';\nimport isWorker from './is-worker';\nimport sendMessage from './send-message';\n\nconst { support: storeName } = DbStoreName;\n\nexport default async function (params: ISaveSupport) {\n    isWindow() && saveSupportDataWindow(params);\n\n    isWorker() && saveSupportDataWorker(params);\n}\n\nfunction saveSupportDataWindow(params: ISaveSupport) {\n    const { VamtigerBrowserMethod } = self;\n    const { workerSupport } = VamtigerBrowserMethod;\n    const message = workerSupport && workerSupport.indexedDbIsAccessible && {\n        action: MessageAction.saveSupport,\n        params\n    };\n\n    if (message) {\n        sendMessage(message);\n    } else {\n        saveSupportDataIndexDb(params);\n    }\n}\n\nfunction saveSupportDataWorker(params: ISaveSupport) {\n    saveSupportDataIndexDb(params);\n}\n\nfunction saveSupportDataIndexDb(params: ISaveSupport) {\n    const { environment } = params;\n    const saveParams = environment && {\n        storeName,\n        keyPath: DbKeyPath.support,\n        data: {\n            environment,\n            ...params\n        }\n    };\n\n    saveParams && save(saveParams);\n}","import {\n    ISupport,\n    MessageAction,\n    DbStoreName,\n    DbKeyPath,\n    TimeoutDuration,\n    Environment\n} from './types';\nimport isWorker from './is-worker';\nimport sendMessage from './send-message';\nimport getData from './get-indexed-db-data';\nimport saveSupport from './save-support';\n\nconst { support: keyPath } = DbKeyPath;\nconst { support: storeName } = DbStoreName\n\nexport default async function () {\n    const {\n        VamtigerBrowserMethod,\n        localStorage,\n        indexedDB,\n    } = self;\n    const [indexedDbIsAccessible] = await Promise.all([\n        indexDbAccessible()\n    ]);\n    const support: ISupport = {\n        localStorage: localStorage ? true : false,\n        indexedDb: indexedDB ? true : false,\n        indexedDbIsAccessible,\n        worker: self.hasOwnProperty('Worker') ? true : false,\n        sharedWorker: self.hasOwnProperty('SharedWorker'),\n        textEncoder: self.hasOwnProperty('TextEncoder'),\n        textDecoder: self.hasOwnProperty('TextDecoder')\n    };\n\n    VamtigerBrowserMethod.support = support;\n\n    isWorker() && sendWorkerSupport();\n}\n\nexport function indexDbAccessible() {return new Promise(async (resolve: (indexDbAccessible: boolean) => void, reject) => {\n    let indexedDbIsAccessible = false;\n    let resolved = false;\n    const environment = Environment.worker;\n    const timeout = setTimeout(() => !resolved && resolve(indexedDbIsAccessible), TimeoutDuration.indexDbIsAccessible);\n\n    await getData({\n        storeName,\n        keyPath,\n        key: environment\n    });\n\n    indexedDbIsAccessible = true;\n    resolved = true;\n\n    resolve(indexedDbIsAccessible);\n})}\n\nexport async function setWorkerSupport(workerSupport: ISupport) {\n    const { VamtigerBrowserMethod } = self;\n    const { support, environment } = VamtigerBrowserMethod;\n\n    VamtigerBrowserMethod.workerSupport = workerSupport;\n\n    support && saveSupport({\n        environment,\n        ...support\n    });\n\n    workerSupport && saveSupport({\n        environment: Environment.worker,\n        ...workerSupport\n    });\n}\n\nfunction sendWorkerSupport() {\n    const { VamtigerBrowserMethod } = self;\n    const message = {\n        action: MessageAction.setWorkerSupport,\n        params: VamtigerBrowserMethod.support || {}\n    };\n\n    sendMessage(message);\n}","const logMessage = 'Message Ignored';\n\nexport default function (params: any) {\n    console.log(logMessage);\n    console.warn(params);\n}","import {\n    MessageAction,\n    MessageResponse\n} from './types';\nimport getMessageData from './get-message-data';\nimport removeRedundantScripts from './remove-redundant-scripts';\nimport { setWorkerSupport } from './set-support';\nimport saveWebComponentData from './save-web-component-data';\nimport sendMessage from './send-message';\nimport ignoreMessage from './ignore-message';\nimport getWebComponentData from './get-web-component-data';\nimport dequeue from './dequeue';\nimport loadWebComponentData from './load-web-component-data';\nimport saveSupport from './save-support';\n\nconst action = {\n    [MessageAction.ignore]: ignoreMessage,\n    [MessageAction.removeRedundantScripts]: removeRedundantScripts,\n    [MessageAction.setWorkerSupport]: setWorkerSupport,\n    [MessageAction.saveWebComponentData]: saveWebComponentData,\n    [MessageAction.getWebComponentData]: getWebComponentData,\n    [MessageAction.dequeue]: dequeue,\n    [MessageAction.loadWebComponentData]: loadWebComponentData,\n    [MessageAction.saveSupport]: saveSupport\n}\n\nexport default async function (event: MessageEvent) {\n    const { action: actionName, params } = getMessageData(event) || { action: MessageAction.ignore, params: {}};\n    const currentAction = action[actionName];\n    const response = await currentAction(params) as MessageResponse;\n\n    response && sendMessage(response);\n}","import {\n    LocalHostRelativePath\n} from './types';\nimport isLocalHost from './is-local-host';\n\nconst { vamtigerBrowserMethod: url } = LocalHostRelativePath;\n\nexport default async function() {\n    const validUrl = isLocalHost() && await fetch(url)\n        .then(response => response.ok)\n        .catch(error => '');\n    const localHostRelativeUrl = validUrl && url || '';\n\n    return localHostRelativeUrl;\n}","import {\n    HostName\n} from './types';\n\nexport default function() {\n    const { location } = window;\n    const isLocalHost = HostName.localHost === location.hostname;\n\n    return isLocalHost;\n}","import {\n    selector,\n    ScriptType,\n    LocalHostRelativePath\n} from './types';\nimport handleMessage from './handle-message';\nimport getLocalHostWorkerUrl from './get-local-host-worker-url';\n\nconst { stringify } = JSON;\nconst params = {\n    type: ScriptType.js\n}\n\nlet worker: Worker;\n\nexport default async function () {\n    const localHostWorkerUrl = await getLocalHostWorkerUrl();\n    const { head } = document;\n    const { createObjectURL } = URL;\n    const workerSelector = !worker && selector.worker;\n    const workerScripts = (workerSelector && Array.from(head.querySelectorAll<HTMLScriptElement>(workerSelector)) || [])\n        .map(({ innerHTML }) => innerHTML)\n        .filter(script => script);\n    const workerBlob = workerScripts && workerScripts.length && new Blob(workerScripts, params);\n    const workerUrl = workerBlob && createObjectURL && createObjectURL(workerBlob);\n    const currentWorker = workerUrl && new Worker(localHostWorkerUrl || workerUrl);\n\n    if (currentWorker) {\n        currentWorker.addEventListener('message', handleMessage);\n        currentWorker.addEventListener('error', handleError);\n    }\n\n    worker = worker || currentWorker;\n\n    return worker;\n}\n\nexport function handleError(event: ErrorEvent) {\n    const keys = Object.keys(event) as (keyof ErrorEvent)[];\n\n    keys.forEach(key => console.error(typeof event[key] === 'string' || stringify(event[key])));\n}","import {\n    Environment\n} from './types';\nimport getWorker from './get-worker';\nimport isWindow from './is-window';\n\nexport default function () {\n    isWindow() && setupWindow();\n}\n\nasync function setupWindow() {\n    const { VamtigerBrowserMethod } = self;\n\n    VamtigerBrowserMethod.worker = await getWorker();\n}","import {\n    MessageAction,\n    sendMessageFromWorker,\n    selector as Selector\n} from './types'\nimport handleMessage from './handle-message';\nimport isWorker from './is-worker';\nimport removeRedundantScripts from './remove-redundant-scripts';\n\nexport default function () {\n    isWorker() && setupWorker();\n}\n\nfunction setupWorker() {\n    addEventListener('message', handleMessage);\n\n    removeRedundantScripts({\n        selector: Selector.redundantScripts\n    });\n}","export default `<figcaption data-linked-data-caption></figcaption> <span data-linked-data-caption-element></span> <a></a>`;","import {\n    IGetTemplate,\n    GetTemplate,\n    StringConstant,\n    AttributesKey\n} from './types';\nimport html from './html';\n\nconst { nothing } = StringConstant;\nconst template = document.createElement('template');\nconst templateHtml = [\n    html\n].join(nothing);\n\ntemplate.innerHTML = templateHtml;\n\nexport default <P extends IGetTemplate>(params: P) => {\n    const {\n        selector,\n        attributes = {},\n        properties = {}\n    } = params;\n    const attributesKeys = Object.keys(attributes) as AttributesKey[]\n    const templateElement = template.content.querySelector(selector);\n    const currentTemplate = templateElement && templateElement.cloneNode(true) as GetTemplate<P>;\n\n    if (currentTemplate) {\n        Object.assign(currentTemplate, properties);\n\n        attributesKeys.forEach(key => attributes[key] && currentTemplate.setAttribute(key, attributes[key] || ''));\n    }\n\n    return currentTemplate;\n};","import {\n    IGetMicrodataCaption,\n    IAnyObject,\n    Selector,\n    StringConstant\n} from './types';\nimport getTemplate from './get-template';\n\nconst { nothing, slash } = StringConstant;\n\nexport default function ({ imageData, fieldKey }: IGetMicrodataCaption) {\n    const field = imageData[fieldKey] as IAnyObject | undefined;\n    const fieldData = Array.isArray(field) && field || [field] || [];\n    const caption = field && getTemplate({\n        selector: Selector.linkedDataCaption,\n        attributes: {\n            itemprop: fieldKey\n        }\n    });\n\n    let itemtype: string;\n    let currentCaption: HTMLElement | null;\n    let currentProducerCaptionElements: (HTMLElement | null)[]\n\n    fieldData.forEach(currentFieldData => {\n        if (currentFieldData) {\n            itemtype = currentFieldData['@context'] && currentFieldData['@type'] && [\n                currentFieldData['@context'],\n                currentFieldData['@type']\n            ].join(slash);\n            currentCaption = getTemplate({\n                selector: Selector.linkedDataCaption\n            });\n\n            if (currentCaption) {\n                currentCaption.setAttribute('itemscope', nothing);\n                itemtype && currentCaption.setAttribute('itemtype', itemtype);\n\n                currentProducerCaptionElements = [\n                    currentFieldData.name && getTemplate({\n                        selector: Selector.linkedDataCaptionElement,\n                        properties: {\n                            innerHTML: currentFieldData.name\n                        },\n                        attributes: {\n                            itemprop: 'name'\n                        }\n                    }),\n                    currentFieldData.description && getTemplate({\n                        selector: Selector.linkedDataCaptionElement,\n                        properties: {\n                            innerHTML: currentFieldData.description\n                        },\n                        attributes: {\n                            itemprop: 'description'\n                        }\n                    }),\n                    currentFieldData.url && getTemplate({\n                        selector: Selector.a,\n                        properties: {\n                            innerHTML: currentFieldData.name || currentFieldData.url\n                        },\n                        attributes: {\n                            itemprop: 'url',\n                            href: currentFieldData.url\n                        }\n                    })\n                ];\n\n                currentProducerCaptionElements.forEach(currentElement => currentElement && currentCaption && currentCaption.appendChild(currentElement));\n\n                caption && caption.appendChild(currentCaption);\n            }\n        }\n    });\n\n    return caption\n}","export * from './load-ts-lib';\nimport loadScript from './load-script';\nimport loadScripts from './load-scripts';\nimport loadScriptsSequentially from './load-scripts-sequentially';\nimport loadShadowStylesheet from './load-shadow-stylesheet';\nimport defineCustomElement from './define-custom-element';\nimport pause from './pause';\nimport getElement from './get-element';\nimport getData from './get-data';\nimport getEnvironment from './get-environment';\nimport setupWindow from './setup-window';\nimport setupWorker from './setup-worker';\nimport setSupport from './set-support';\nimport getMicrodataCaption from './get-microdata-caption';\n\nconst environment = getEnvironment();\nconst vamtigerBrowserMethod = {\n    loadScript,\n    loadScripts,\n    loadScriptsSequentially,\n    loadShadowStylesheet,\n    defineCustomElement,\n    pause,\n    getElement,\n    getData,\n    getEnvironment,\n    environment,\n    messageQueue: new Map(),\n    getMicrodataCaption\n};\nmain();\n\nfunction main() {\n    try {\n        const { VamtigerBrowserMethod } = self;\n\n        if (!VamtigerBrowserMethod) {\n            self.VamtigerBrowserMethod = vamtigerBrowserMethod;\n\n            setSupport();\n\n            setupWindow();\n\n            setupWorker();\n        }\n    } catch(error) {\n        handleError(error);\n    }\n}\n\nfunction handleError(error: Error) {\n    console.error(error);\n    throw error;\n}","import { LoadScriptsParams, LoadedScripts } from './types';\nimport loadScript from './load-script';\n\nexport default function <P extends LoadScriptsParams>(params: P) {\n    const scripts = Promise.all(params.map(loadScript)) as Promise<LoadedScripts<P>>;\n\n    return scripts\n}","import { LoadScriptsSequentiallyParams, LoadedScriptsSequentially, LoadScriptParams } from './types';\nimport loadScript from './load-script';\n\nexport default <P extends LoadScriptParams[][]>(params: P) => new Promise((resolve: (scripts: LoadedScriptsSequentially<P>) => void, reject) => {\n    let scripts = new Set();\n    let load = Promise.resolve();\n\n    params.forEach(scriptParams => {\n        load = load\n            .then(async () => await Promise.all(scriptParams.map(loadScript)))\n            .then(loadedScripts => loadedScripts.forEach(script => scripts.add(script)))\n    });\n\n    load = load.then(() => resolve(Array.from(scripts) as LoadedScriptsSequentially<P>));\n\n    return load;\n});","import {\n    ILoadShadowStylesheet,\n    Selector\n} from './types';\nimport loadElementQueryCss from './load-element-query-css';\n\nexport default function ({ css, element }: ILoadShadowStylesheet) {\n    const {\n        shadowRoot,\n        localName: hostName\n    } = element;\n    const lastStylesheet = shadowRoot && shadowRoot.querySelector(Selector.lastStylesheet);\n    const stylesheet = shadowRoot && document.createElement('style');\n\n    if (stylesheet && shadowRoot) {\n        stylesheet.innerHTML = css;\n\n        if (lastStylesheet && lastStylesheet.nextElementSibling) {\n            shadowRoot.insertBefore(stylesheet, lastStylesheet.nextElementSibling);\n        } else {\n            shadowRoot.appendChild(stylesheet);\n        }\n    }\n}"],"names":["__extends","__assign","__rest","__decorate","__param","__metadata","__awaiter","__generator","__exportStar","__values","__read","__spread","__await","__asyncGenerator","__asyncDelegator","__asyncValues","__makeTemplateObject","__importStar","__importDefault","factory","root","global","self","this","createExporter","exports","previous","Object","create","defineProperty","value","__esModule","id","v","define","amd","module","exporter","extendStatics","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__","constructor","prototype","assign","t","s","i","n","arguments","length","call","e","indexOf","getOwnPropertySymbols","decorators","target","key","desc","c","r","getOwnPropertyDescriptor","Reflect","decorate","paramIndex","decorator","metadataKey","metadataValue","metadata","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","result","done","then","apply","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","op","TypeError","pop","push","m","o","ar","error","concat","asyncIterator","q","a","resume","fulfill","settle","shift","cooked","raw","mod","k","default","Environment","TimeoutDuration","MessageQueueName","Prefix","Origin","HostName","LocalHostRelativePath","ScriptType","ScriptAttribute","DataAttribute","ErrorMessage","StringConstant","TagName","LinkRel","LoadScriptElement","Selector","MetaElementName","ScriptNameSuffix","MessageAction","DbName","DbStoreName","DbMode","DbKeyPath","keys","tslib","forEach","regex","RegExp","dash","selector","worker","vamtigerBrowserMethod","join","comma","redundantScripts","vamtigerBrowserMethodJsonJs","vamtigerBrowserMethodJson","sendMessageFromWorker","postMessage","nothing","nonWord","input","split","map","word","index","toLowerCase","slice","toUpperCase","showRootHost","_a","css","_b","currentStylesheetName","_c","hostName","metaElement","properties","_d","dataset","_e","attributes","head","lastMetaElement","querySelector","attributeKeys","existingMetaElement","window","newMetaElment","document","createElement","nextElementSibling","insertBefore","appendChild","hasAttribute","setAttribute","dataKey","getMetaElment","loadElementQueryCss","stylesheetName","getCamelCase","elementQueryCss","replace","EQCSS","register","parse","failedToLoadScript","stylesheet","scriptElement","link","style","params","js","scriptName","jsonld","removeFromDom","src","href","json","remoteScript","element","existingScript","script","handleLoad","removeEventListeners","removeChild","handleLoadError","event","console","Error","removeEventListener","HTMLScriptElement","innerHTML","name","type","HTMLLinkElement","rel","HTMLStyleElement","addEventListener","unsupportedFeature","customElementAreadyDefined","requestIdleCallback","loadStylesheets","container","styles","from","content","querySelectorAll","stylesheets","all","loadScript","styleElements","noElementName","noTemplate","noElementForSelector","noElementSelector","noTemplateUrl","noTemplateForUrl","stringify","textEncoder","TextEncoder","VamtigerBrowserMethod","textEncoderSupport","stringMessage","message","encode","isWindow","isWorker","isJson","warn","prefix","parent","removeScripts","removeRedundantScripts","sendMessage","action","sendRemoveRedundantScriptsMessage","removeScriptsFromParent","scripts","jsScripts","filter","jsonScripts","isJsonScript","jsonLdScripts","safeScripts","time","Date","getTime","jsonScriptName","jsonScriptSelector","jsonLdScriptName","jsonLdScriptSelector","jsonLd","removedScripts","toString","getElement","url","fetch","response","text","template","loadContainerStylesheets","getElementFromUrl","firstElementChild","getElementFromTemplate","timeout","queue","queueEntry","messageQueue","has","set","Set","get","add","setTimeout","delete","size","handleExpiredQueueEntry","dbName","storeName","mode","dbRequest","indexedDB","open","db","objectStoreNames","contains","createObjectStore","keyPath","transaction","store","objectStore","data","messageId","getDbParams","save","put","handleError","handleSuccess","support","workerSupport","indexedDbIsAccessible","getWebComponentDataWindowWorker","getWebComponentData","dequeueParams","dequeue","getWebComponentDataWindow","webComponent","getWebComponentDataWorker","getData","getSelector","saveWebComponentData","saveWebComponentDataIndexDb","saveWebComponentDataWindow","getWebComponentDataMessage","removeRedundantScriptsMessage","saveWebComponentDataWorker","saveParams","created","jsonLdSelector","jsonSelector","undefined","jsonScript","jsonLdScript","loadWebComponentData","error_1","noJsonLdParameter","ignoreMessage","ignore","textDecoder","TextDecoder","messageData","Uint8Array","decode","getMessageData","saveSupport","saveSupportDataIndexDb","saveSupportDataWindow","saveSupportDataWorker","environment","localStorage","resolved","indexDbIsAccessible","indexDbAccessible","indexedDb","sharedWorker","setWorkerSupport","sendWorkerSupport","logMessage","log","actionName","currentAction","location","localHost","hostname","ok","catch","getLocalHostWorkerUrl","localHostWorkerUrl","createObjectURL","URL","workerSelector","workerScripts","workerBlob","Blob","workerUrl","currentWorker","Worker","handleMessage","getWorker","setupWindow","templateHtml","attributesKeys","templateElement","currentTemplate","cloneNode","slash","getEnvironment","loadScripts","loadScriptsSequentially","load","scriptParams","loadedScripts","loadShadowStylesheet","shadowRoot","lastStylesheet","defineCustomElement","customElements","existingElement","pause","milliseconds","getJsonLd","Map","getMicrodataCaption","itemtype","currentCaption","imageData","fieldKey","field","fieldData","isArray","caption","getTemplate","linkedDataCaption","itemprop","currentFieldData","linkedDataCaptionElement","description","currentElement","setSupport","setupWorker","main"],"mappings":"yBAeA,IAAIA,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,GACJ,SAAWC,GACP,IAAIC,EAAyB,iBAAXC,OAAsBA,OAAyB,iBAATC,KAAoBA,KAAuB,iBAATC,KAAoBA,QAU9G,SAASC,EAAeC,EAASC,GAS7B,OARID,IAAYL,IACiB,mBAAlBO,OAAOC,OACdD,OAAOE,eAAeJ,EAAS,cAAgBK,OAAO,IAGtDL,EAAQM,YAAa,GAGtB,SAAUC,EAAIC,GAAK,OAAOR,EAAQO,GAAMN,EAAWA,EAASM,EAAIC,GAAKA,GAlB1D,mBAAXC,QAAyBA,OAAOC,IACvCD,OAAO,SAAU,WAAY,SAAUT,GAAWN,EAAQK,EAAeJ,EAAMI,EAAeC,OAEvE,iBAAXW,QAAiD,iBAAnBA,OAAOX,QACjDN,EAAQK,EAAeJ,EAAMI,EAAeY,OAAOX,WAGnDN,EAAQK,EAAeJ,IAT/B,CAuBC,SAAUiB,GACP,IAAIC,EAAgBX,OAAOY,iBACpBC,wBAA2BC,OAAS,SAAUC,EAAGC,GAAKD,EAAEF,UAAYG,IACvE,SAAUD,EAAGC,GAAK,IAAK,IAAIC,KAAKD,EAAOA,EAAEE,eAAeD,KAAIF,EAAEE,GAAKD,EAAEC,KAEzE5C,EAAY,SAAU0C,EAAGC,GAErB,SAASG,IAAOvB,KAAKwB,YAAcL,EADnCJ,EAAcI,EAAGC,GAEjBD,EAAEM,UAAkB,OAANL,EAAahB,OAAOC,OAAOe,IAAMG,EAAGE,UAAYL,EAAEK,UAAW,IAAIF,IAGnF7C,EAAW0B,OAAOsB,QAAU,SAAUC,GAClC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAIR,KADTO,EAAIG,UAAUF,GACOzB,OAAOqB,UAAUH,eAAeW,KAAKL,EAAGP,KAAIM,EAAEN,GAAKO,EAAEP,IAE9E,OAAOM,GAGXhD,EAAS,SAAUiD,EAAGM,GAClB,IAAIP,KACJ,IAAK,IAAIN,KAAKO,EAAOxB,OAAOqB,UAAUH,eAAeW,KAAKL,EAAGP,IAAMa,EAAEC,QAAQd,GAAK,IAC9EM,EAAEN,GAAKO,EAAEP,IACb,GAAS,MAALO,GAAqD,mBAAjCxB,OAAOgC,sBACtB,CAAA,IAAIP,EAAI,EAAb,IAAgBR,EAAIjB,OAAOgC,sBAAsBR,GAAIC,EAAIR,EAAEW,OAAQH,IAASK,EAAEC,QAAQd,EAAEQ,IAAM,IAC1FF,EAAEN,EAAEQ,IAAMD,EAAEP,EAAEQ,KACtB,OAAOF,GAGX/C,EAAa,SAAUyD,EAAYC,EAAQC,EAAKC,GAC5C,IAA2HrB,EAAvHsB,EAAIV,UAAUC,OAAQU,EAAID,EAAI,EAAIH,EAAkB,OAATE,EAAgBA,EAAOpC,OAAOuC,yBAAyBL,EAAQC,GAAOC,EACrH,GAAuB,iBAAZI,SAAoD,mBAArBA,QAAQC,SAAyBH,EAAIE,QAAQC,SAASR,EAAYC,EAAQC,EAAKC,QACpH,IAAK,IAAIX,EAAIQ,EAAWL,OAAS,EAAGH,GAAK,EAAGA,KAASV,EAAIkB,EAAWR,MAAIa,GAAKD,EAAI,EAAItB,EAAEuB,GAAKD,EAAI,EAAItB,EAAEmB,EAAQC,EAAKG,GAAKvB,EAAEmB,EAAQC,KAASG,GAChJ,OAAOD,EAAI,GAAKC,GAAKtC,OAAOE,eAAegC,EAAQC,EAAKG,GAAIA,GAGhE7D,EAAU,SAAUiE,EAAYC,GAC5B,OAAO,SAAUT,EAAQC,GAAOQ,EAAUT,EAAQC,EAAKO,KAG3DhE,EAAa,SAAUkE,EAAaC,GAChC,GAAuB,iBAAZL,SAAoD,mBAArBA,QAAQM,SAAyB,OAAON,QAAQM,SAASF,EAAaC,IAGpHlE,EAAY,SAAUoE,EAASC,EAAYC,EAAGC,GAC1C,OAAO,IAAKD,IAAMA,EAAIE,UAAU,SAAUC,EAASC,GAC/C,SAASC,EAAUnD,GAAS,IAAMoD,EAAKL,EAAUM,KAAKrD,IAAW,MAAO2B,GAAKuB,EAAOvB,IACpF,SAAS2B,EAAStD,GAAS,IAAMoD,EAAKL,EAAiB,MAAE/C,IAAW,MAAO2B,GAAKuB,EAAOvB,IACvF,SAASyB,EAAKG,GAAUA,EAAOC,KAAOP,EAAQM,EAAOvD,OAAS,IAAI8C,EAAE,SAAUG,GAAWA,EAAQM,EAAOvD,SAAWyD,KAAKN,EAAWG,GACnIF,GAAML,EAAYA,EAAUW,MAAMd,EAASC,QAAmBQ,WAItE5E,EAAc,SAAUmE,EAASe,GAC7B,IAAsGC,EAAGC,EAAGzC,EAAG0C,EAA3GC,GAAMC,MAAO,EAAGC,KAAM,WAAa,GAAW,EAAP7C,EAAE,GAAQ,MAAMA,EAAE,GAAI,OAAOA,EAAE,IAAO8C,QAAUC,QAC3F,OAAOL,GAAMT,KAAMe,EAAK,GAAIC,MAASD,EAAK,GAAIE,OAAUF,EAAK,IAAwB,mBAAXG,SAA0BT,EAAES,OAAOC,UAAY,WAAa,OAAO/E,OAAUqE,EACvJ,SAASM,EAAK7C,GAAK,OAAO,SAAUpB,GAAK,OACzC,SAAcsE,GACV,GAAIb,EAAG,MAAM,IAAIc,UAAU,mCAC3B,KAAOX,GAAG,IACN,GAAIH,EAAI,EAAGC,IAAMzC,EAAY,EAARqD,EAAG,GAASZ,EAAU,OAAIY,EAAG,GAAKZ,EAAS,SAAOzC,EAAIyC,EAAU,SAAMzC,EAAEM,KAAKmC,GAAI,GAAKA,EAAER,SAAWjC,EAAIA,EAAEM,KAAKmC,EAAGY,EAAG,KAAKjB,KAAM,OAAOpC,EAE3J,OADIyC,EAAI,EAAGzC,IAAGqD,GAAc,EAARA,EAAG,GAAQrD,EAAEpB,QACzByE,EAAG,IACP,KAAK,EAAG,KAAK,EAAGrD,EAAIqD,EAAI,MACxB,KAAK,EAAc,OAAXV,EAAEC,SAAkBhE,MAAOyE,EAAG,GAAIjB,MAAM,GAChD,KAAK,EAAGO,EAAEC,QAASH,EAAIY,EAAG,GAAIA,GAAM,GAAI,SACxC,KAAK,EAAGA,EAAKV,EAAEI,IAAIQ,MAAOZ,EAAEG,KAAKS,MAAO,SACxC,QACI,KAAkBvD,GAAZA,EAAI2C,EAAEG,MAAYzC,OAAS,GAAKL,EAAEA,EAAEK,OAAS,MAAkB,IAAVgD,EAAG,IAAsB,IAAVA,EAAG,IAAW,CAAEV,EAAI,EAAG,SACjG,GAAc,IAAVU,EAAG,MAAcrD,GAAMqD,EAAG,GAAKrD,EAAE,IAAMqD,EAAG,GAAKrD,EAAE,IAAM,CAAE2C,EAAEC,MAAQS,EAAG,GAAI,MAC9E,GAAc,IAAVA,EAAG,IAAYV,EAAEC,MAAQ5C,EAAE,GAAI,CAAE2C,EAAEC,MAAQ5C,EAAE,GAAIA,EAAIqD,EAAI,MAC7D,GAAIrD,GAAK2C,EAAEC,MAAQ5C,EAAE,GAAI,CAAE2C,EAAEC,MAAQ5C,EAAE,GAAI2C,EAAEI,IAAIS,KAAKH,GAAK,MACvDrD,EAAE,IAAI2C,EAAEI,IAAIQ,MAChBZ,EAAEG,KAAKS,MAAO,SAEtBF,EAAKd,EAAKjC,KAAKkB,EAASmB,GAC1B,MAAOpC,GAAK8C,GAAM,EAAG9C,GAAIkC,EAAI,UAAeD,EAAIxC,EAAI,EACtD,GAAY,EAARqD,EAAG,GAAQ,MAAMA,EAAG,GAAI,OAASzE,MAAOyE,EAAG,GAAKA,EAAG,QAAK,EAAQjB,MAAM,GArB9BJ,EAAM7B,EAAGpB,OAyB7DzB,EAAe,SAAUmG,EAAGlF,GACxB,IAAK,IAAImB,KAAK+D,EAAQlF,EAAQoB,eAAeD,KAAInB,EAAQmB,GAAK+D,EAAE/D,KAGpEnC,EAAW,SAAUmG,GACjB,IAAID,EAAsB,mBAAXN,QAAyBO,EAAEP,OAAOC,UAAWlD,EAAI,EAChE,OAAIuD,EAAUA,EAAEnD,KAAKoD,IAEjBzB,KAAM,WAEF,OADIyB,GAAKxD,GAAKwD,EAAErD,SAAQqD,OAAI,IACnB9E,MAAO8E,GAAKA,EAAExD,KAAMkC,MAAOsB,MAKhDlG,EAAS,SAAUkG,EAAGvD,GAClB,IAAIsD,EAAsB,mBAAXN,QAAyBO,EAAEP,OAAOC,UACjD,IAAKK,EAAG,OAAOC,EACf,IAAmB3C,EAAYR,EAA3BL,EAAIuD,EAAEnD,KAAKoD,GAAOC,KACtB,IACI,WAAc,IAANxD,GAAgBA,KAAM,MAAQY,EAAIb,EAAE+B,QAAQG,MAAMuB,EAAGH,KAAKzC,EAAEnC,OAExE,MAAOgF,GAASrD,GAAMqD,MAAOA,WAEzB,IACQ7C,IAAMA,EAAEqB,OAASqB,EAAIvD,EAAU,SAAIuD,EAAEnD,KAAKJ,WAExC,GAAIK,EAAG,MAAMA,EAAEqD,OAE7B,OAAOD,GAGXlG,EAAW,WACP,IAAK,IAAIkG,KAASzD,EAAI,EAAGA,EAAIE,UAAUC,OAAQH,IAC3CyD,EAAKA,EAAGE,OAAOrG,EAAO4C,UAAUF,KACpC,OAAOyD,GAGXjG,EAAU,SAAUqB,GAChB,OAAOV,gBAAgBX,GAAWW,KAAKU,EAAIA,EAAGV,MAAQ,IAAIX,EAAQqB,IAGtEpB,EAAmB,SAAU6D,EAASC,EAAYE,GAC9C,IAAKwB,OAAOW,cAAe,MAAM,IAAIR,UAAU,wCAC/C,IAAoDpD,EAAhDwC,EAAIf,EAAUW,MAAMd,EAASC,OAAsBsC,KACvD,OAAO7D,KAAQ8C,EAAK,QAASA,EAAK,SAAUA,EAAK,UAAW9C,EAAEiD,OAAOW,eAAiB,WAAc,OAAOzF,MAAS6B,EACpH,SAAS8C,EAAK7C,GAASuC,EAAEvC,KAAID,EAAEC,GAAK,SAAUpB,GAAK,OAAO,IAAI6C,QAAQ,SAAUoC,EAAGvE,GAAKsE,EAAEP,MAAMrD,EAAGpB,EAAGiF,EAAGvE,IAAM,GAAKwE,EAAO9D,EAAGpB,OAC9H,SAASkF,EAAO9D,EAAGpB,GAAK,KACVgC,EADqB2B,EAAEvC,GAAGpB,IACnBH,iBAAiBlB,EAAUkE,QAAQC,QAAQd,EAAEnC,MAAMG,GAAGsD,KAAK6B,EAASpC,GAAUqC,EAAOJ,EAAE,GAAG,GAAIhD,GADpE,MAAOR,GAAK4D,EAAOJ,EAAE,GAAG,GAAIxD,GAC3E,IAAcQ,EACd,SAASmD,EAAQtF,GAASqF,EAAO,OAAQrF,GACzC,SAASkD,EAAOlD,GAASqF,EAAO,QAASrF,GACzC,SAASuF,EAAO3B,EAAGzD,GAASyD,EAAEzD,GAAIgF,EAAEK,QAASL,EAAE1D,QAAQ4D,EAAOF,EAAE,GAAG,GAAIA,EAAE,GAAG,MAGhFnG,EAAmB,SAAU8F,GACzB,IAAIxD,EAAGR,EACP,OAAOQ,KAAQ8C,EAAK,QAASA,EAAK,QAAS,SAAUzC,GAAK,MAAMA,IAAOyC,EAAK,UAAW9C,EAAEiD,OAAOC,UAAY,WAAc,OAAO/E,MAAS6B,EAC1I,SAAS8C,EAAK7C,EAAGqC,GAAKtC,EAAEC,GAAKuD,EAAEvD,GAAK,SAAUpB,GAAK,OAAQW,GAAKA,IAAOd,MAAOlB,EAAQgG,EAAEvD,GAAGpB,IAAKqD,KAAY,WAANjC,GAAmBqC,EAAIA,EAAEzD,GAAKA,GAAOyD,IAG/I3E,EAAgB,SAAU6F,GACtB,IAAKP,OAAOW,cAAe,MAAM,IAAIR,UAAU,wCAC/C,IAAiCpD,EAA7BuD,EAAIC,EAAEP,OAAOW,eACjB,OAAOL,EAAIA,EAAEnD,KAAKoD,IAAMA,EAAwB,mBAAbnG,EAA0BA,EAASmG,GAAKA,EAAEP,OAAOC,YAAalD,KAAQ8C,EAAK,QAASA,EAAK,SAAUA,EAAK,UAAW9C,EAAEiD,OAAOW,eAAiB,WAAc,OAAOzF,MAAS6B,GAC9M,SAAS8C,EAAK7C,GAAKD,EAAEC,GAAKuD,EAAEvD,IAAM,SAAUpB,GAAK,OAAO,IAAI6C,QAAQ,SAAUC,EAASC,IACvF,SAAgBD,EAASC,EAAQtC,EAAGT,GAAK6C,QAAQC,QAAQ9C,GAAGsD,KAAK,SAAStD,GAAK8C,GAAUjD,MAAOG,EAAGqD,KAAM5C,KAASsC,IADJqC,CAAOtC,EAASC,GAA7B/C,EAAI2E,EAAEvD,GAAGpB,IAA8BqD,KAAMrD,EAAEH,YAIpJd,EAAuB,SAAUuG,EAAQC,GAErC,OADI7F,OAAOE,eAAkBF,OAAOE,eAAe0F,EAAQ,OAASzF,MAAO0F,IAAiBD,EAAOC,IAAMA,EAClGD,GAGXtG,EAAe,SAAUwG,GACrB,GAAIA,GAAOA,EAAI1F,WAAY,OAAO0F,EAClC,IAAIpC,KACJ,GAAW,MAAPoC,EAAa,IAAK,IAAIC,KAAKD,EAAS9F,OAAOkB,eAAeW,KAAKiE,EAAKC,KAAIrC,EAAOqC,GAAKD,EAAIC,IAE5F,OADArC,EAAgB,QAAIoC,EACbpC,GAGXnE,EAAkB,SAAUuG,GACxB,OAAQA,GAAOA,EAAI1F,WAAc0F,GAAQE,QAAWF,IAGxDpF,EAAS,YAAarC,GACtBqC,EAAS,WAAYpC,GACrBoC,EAAS,SAAUnC,GACnBmC,EAAS,aAAclC,GACvBkC,EAAS,UAAWjC,GACpBiC,EAAS,aAAchC,GACvBgC,EAAS,YAAa/B,GACtB+B,EAAS,cAAe9B,GACxB8B,EAAS,eAAgB7B,GACzB6B,EAAS,WAAY5B,GACrB4B,EAAS,SAAU3B,GACnB2B,EAAS,WAAY1B,GACrB0B,EAAS,UAAWzB,GACpByB,EAAS,mBAAoBxB,GAC7BwB,EAAS,mBAAoBvB,GAC7BuB,EAAS,gBAAiBtB,GAC1BsB,EAAS,uBAAwBrB,GACjCqB,EAAS,eAAgBpB,GACzBoB,EAAS,kBAAmBnB,kcAEhC,IChPY0G,EAKAC,EAKAC,EAIAC,EAOAC,EAKAC,EAIAC,EAIAC,EAMAC,EAIAC,EAKAC,EAcAC,EAWAC,EAKAC,EAIAC,EAMAC,EAiBCC,EAIDC,EAKAC,EAWAC,EAIAC,EAKAC,EAMAC,EC7IMvH,OAAOwH,KAAKC,GAEpBC,QAAQ,SAAAvF,GACTxC,KAAKwC,KACNxC,KAAKwC,GAAOsF,EAAMtF,MDJ1B,SAAY8D,GACRA,kBACAA,kBAFJ,CAAYA,IAAAA,OAKZ,SAAYC,GACRA,qCACAA,mDAFJ,CAAYA,IAAAA,OAKZ,SAAYC,GACRA,8BADJ,CAAYA,IAAAA,OAIZ,SAAYC,GACRA,kDACAA,+BACAA,mDACAA,mDAJJ,CAAYA,IAAAA,OAOZ,SAAYC,GACRA,aACAA,iBAFJ,CAAYA,IAAAA,OAKZ,SAAYC,GACRA,wBADJ,CAAYA,IAAAA,OAIZ,SAAYC,GACRA,qDADJ,CAAYA,IAAAA,OAIZ,SAAYC,GACRA,uBACAA,0BACAA,+BAHJ,CAAYA,IAAAA,OAMZ,SAAYC,GACRA,cADJ,CAAYA,IAAAA,OAIZ,SAAYC,GACRA,qDACAA,gDAFJ,CAAYA,IAAAA,OAKZ,SAAYC,GACRA,6CACAA,iDACAA,2CACAA,8DACAA,kCACAA,kCACAA,2CACAA,yCACAA,2BACAA,iDACAA,+CAXJ,CAAYA,IAAAA,OAcZ,SAAYC,GACRA,aACAA,YACAA,WACAA,WACAA,YACAA,eACAA,kBACAA,kBARJ,CAAYA,IAAAA,OAWZ,SAAYC,GACRA,YACAA,sBAFJ,CAAYA,IAAAA,OAKZ,SAAYC,GACRA,0BADJ,CAAYA,IAAAA,OAIZ,SAAYC,GACRA,kBACAA,cACAA,gBAHJ,CAAYA,IAAAA,OAMZ,SAAYC,GACRA,sCACAA,6CACAA,kEACAA,gBACAA,uCACAA,4EACAA,6EACAA,oEACAA,kBACAA,+CACAA,oDACAA,QACAA,iDACAA,gEAdJ,CAAYA,IAAAA,OAiBZ,SAAaC,GACTA,wDADJ,CAAaA,IAAAA,OAIb,SAAYC,GACRA,gBACAA,0BAFJ,CAAYA,IAAAA,OAKZ,SAAYC,GACRA,kBACAA,kDACAA,sCACAA,8CACAA,4CACAA,oBACAA,8CACAA,4BARJ,CAAYA,IAAAA,OAWZ,SAAYC,GACRA,oDADJ,CAAYA,IAAAA,OAIZ,SAAYC,GACRA,oBACAA,+BAFJ,CAAYA,IAAAA,OAKZ,SAAYC,GACRA,sBACAA,wBACAA,gCAHJ,CAAYA,IAAAA,OAMZ,SAAYC,GACRA,qBACAA,wBAFJ,CAAYA,IAAAA,OAwXZ,IAAaI,EACK,eADLA,GAEH,IAAIC,OAAOhB,EAAeiB,KAAM,KAE7B,QAIAC,GACTC,QACIf,EAASgB,uBACXC,KAAKrB,EAAesB,OACtBC,kBACInB,EAASoB,4BACTpB,EAASqB,0BACTrB,EAASgB,uBACXC,KAAKrB,EAAesB,QAGbI,EAAwBC,YErhB7BC,YCDA,IAAAA,YACAC,eAEQC,GAAkB,OAAAA,EAC7BC,MAAMF,GACNG,IAAI,SAACC,EAAMC,GAAU,OAACA,GAASD,EAAKE,eAAiBF,EAAKG,MAAM,EAAG,GAAGC,cAAgBJ,EAAKG,MAAM,GAAGD,gBACpGd,KAAKO,ICFFU,IACAV,aAER,YAAwBW,OAAEC,QAAKC,mBAAAC,kBAAiDC,aAAAC,kBACtEC,EFLV,SAAyBN,OAAEE,aAAAvB,iBAAoByB,eAAAG,kBAAiBC,YAAAC,kBAAcC,eAAAC,kBAClEzJ,OACA0J,gBACFC,EAAkBD,EAAKE,cAA+BjD,EAASgD,iBAC/DE,EAAgBlK,OAAOwH,KAAKsC,GAC5BK,EAAsB9J,IAAQ+J,OAAe/J,IAC5CyH,GAAYiC,EAAKE,cAAcnC,IAChCuC,GAAiBF,GAAuBG,SAASC,cAAc,QAC/Dd,EAAeU,GAAuBE,EAoB5C,OAhBIA,IACArK,OAAOsB,OAAO+I,EAAeX,GAC7B1J,OAAOsB,OAAO+I,EAAcT,QAASA,GAEjCI,GAAmBA,EAAgBQ,mBACnCT,EAAKU,aACDJ,EACAL,EAAgBQ,oBAGpBT,EAAKW,YAAYL,IAIzBH,EAAcxC,QAAQ,SAAAvF,GAAO,OAACsH,EAAYkB,aAAaxI,IAAQsH,EAAYmB,kBAhBvEC,EAgB6Ff,EAAW3H,MAErGsH,EEvBaqB,EAChBpB,YACIrJ,GAAI4G,EAAgB8D,uBAGtBC,EAAiBC,EAAa3B,GAC5BM,YACFsB,GAAmBtB,EAAQ1I,eAAesI,IAAcA,GAAYJ,EAAI+B,QAAQjC,EAAcM,IAAcJ,EAC1GgC,aAEJF,GAAmBE,IACnBA,EAAMC,SAASD,EAAME,MAAMJ,IAEvBF,EACApB,EAAQoB,GAAkBxC,GACnBgB,IACPI,EAAQJ,GAAYhB,KCbxB,IAAA+C,wBACAC,gBACAC,YAAuBC,UAAMC,uBAEYC,GAAc,OAAA,IAAIzI,QAAQ,SAACC,EAA4CC,GAC5G,IAAA0G,gBAAMjG,gBACRqF,IAAE0C,OAAIC,SAAkBC,WAAQC,kBAC9BC,QACF5C,IAAED,QAAK4B,SACLkB,SACAC,SACFC,EAAeR,EAAO1K,eAAe,QAAU0K,EAAO1K,eAAe,QACrEmL,GAAWR,GAAMI,IAAQR,IACxBrC,GAAOuC,IACPO,GAAQR,GACT5D,EAAWmE,GAAO,eAAeA,QAChCC,GAAQ,cAAcA,QACtBL,GAAMC,GAAc,qBAAqBA,QACzC1C,GAAO4B,GAAkB,oBAAoBA,OAC9CsB,EAAkBvC,EAAKE,cAAcnC,IAAahE,EAAKmG,cAAcnC,GACrEyE,EAASzE,GACRuE,GACA/B,SAASC,cAAc8B,GAyC9B,SAASG,IACDD,IACAE,IAEIT,GACAjC,EAAK2C,YAAYH,GAGrBnJ,EAAQmJ,IAIhB,SAASI,EAAgBC,GACrBH,IAEAI,QAAQ1H,MAAMyH,GAEdvJ,EAAO,IAAIyJ,MAAM,GAAGvB,KAGxB,SAASkB,IACDF,IACAA,EAAOQ,oBAAoB,OAAQP,GACnCD,EAAOQ,oBAAoB,QAASJ,IA9DxCJ,aAAkBS,kBACdf,EACAM,EAAON,IAAMA,GACNE,GAAQN,KACfU,EAAOU,UAAYd,GAAQN,EAC3BU,EAAO3C,QAAQsD,KAAOpB,EAElBC,EACAQ,EAAO3B,aAAanE,EAAgB0G,KAAM3G,EAAWuF,QAC9CI,GACPI,EAAO3B,aAAanE,EAAgB0G,KAAM3G,EAAW2F,OAGtDI,aAAkBa,iBACzBb,EAAOc,IAAM7B,GACbe,EAAOL,KAAOA,GACPK,aAAkBe,mBACzBf,EAAOU,UAAY7D,EACnBmD,EAAO3C,QAAQsD,KAAOlC,EAEtBD,IACI3B,MACA4B,oBAIJsB,EACAlJ,EAAQkJ,GACDC,IACPA,EAAOgB,iBAAiB,OAAQf,GAChCD,EAAOgB,iBAAiB,QAASZ,GAEjC5C,EAAKW,YAAY6B,GAEZH,GACDI,QCzEJ,IAAAgB,wBAAoBC,gCCA5B,ICOQ5F,UAER,YAAwB+D,GAAqC,OAAO,IAAIzI,QAAQ,SAACC,EAAsDC,GAC3H,IAAAqK,2BAEJA,EACAA,EAAoB,WAAM,OAAAC,GAAgB/B,EAAQxI,KAElDuK,GAAgB/B,EAAQxI,KAE7B,SAEYuK,GAAgB/B,EAAmCxI,mHAsBxC,OArBdwK,EAAoBhC,YAATsB,EAAStB,OACtBiC,EAAS/M,MACVgN,KAAKF,EAAUG,QAAQC,iBAAmChH,EAAS2E,QACnE/C,IAAI,SAAC+C,EAAO7C,GAAU,OACnBoE,MACIA,EACAhG,EAAiByE,MACjB7C,KACFb,KAAKJ,IACPuB,IAAKuC,EAAMsB,aAEbgB,EAAcnN,MACfgN,KAAKF,EAAUG,QAAQC,iBAAkChH,EAASwE,aAClE5C,IAAI,SAAC4C,EAAY1C,GAAU,OACxBoE,MACIA,EACAhG,EAAiBsE,WACjB1C,KACFb,KAAKJ,IACPqE,KAAMV,EAAWU,WAEG/I,QAAQ+K,IAC7BL,EAAOjF,IAAIuF,WACXF,EAAYrF,IAAIuF,qBAFjBC,EAAgBjF,SAKtB/F,EAAQgL,YCxCR,IAAAC,mBACAC,gBACAC,0BCFA,IAAAF,mBACAG,uBACAC,mBACAC,sBACAH,wCCHA,gDAFiCtI,EAAYmE,qBCE7C,gDAFiCnE,EAAY8B,OCCzC,IAAA4G,kBACFC,GAAc,IAAIC,YAExB,YAAyBjD,GACb,IAAAkD,6BACA/G,WACAgH,8BACFC,EAAgBL,GAAU/C,GAC1BqD,EAAUF,GAAsBH,GAAYM,OAAOF,IAClDA,EAEPG,MAAcpH,GAAUA,EAAOQ,YAAY0G,GAE3CG,MAAc9G,EAAsB2G,GCjBhC,IAAA3D,cAER,YAAyBnC,OACb8D,qBAEJoC,GAAS,EAEb,IACI/D,GAAM2B,GACNoC,GAAS,EACX,MAAMlK,GACJ0H,QAAQyC,KAAKnK,GACbkK,GAAS,EAGb,OAAOA,ECLH,IAAA3B,4BACA7F,UACA0H,2BAER,YAA+B3D,4GAC3BuD,QAKJ,SAAsCvD,2GAGlC,OAFc4D,EAAWlF,iBAEnBmF,QAAkB7D,GAAQ4D,2BAAhCrG,kBARoBuG,CAAuB9D,iBAA7BvC,iCAEd+F,MAiEJ,SAAkDjG,OAAErB,aAQhD6H,IANIC,OAAQzI,EAAcuI,uBACtB9D,QACI9D,cArEM+H,CAAkCjE,YASpD,SAAgB6D,GAAc7D,GAA+C,OAAO,IAAIzI,QAAQ,SAACC,EAASC,GAClGqK,GACAA,GAAoB,WAAM,OAAAoC,QAA4BlE,GAAQxI,UAASC,cAEvEyM,QAA4BlE,GAAQxI,UAASC,cAIrD,SAASyM,GAAwB3G,OAAErB,aAAU0H,WAAQpM,YACzC2G,2BACFgG,EAAUjP,MAAMgN,KAAK0B,EAAOxB,iBAAoClG,IAChEkI,EAAYD,EAAQE,OAAO,SAAC9G,OAACgE,SAAe,eAAQA,GAAQA,IAAS3G,EAAWqF,KAChFqE,EAAcH,EACfE,OAAO,SAAC9G,GAAa,gBAAS3C,EAAW2F,OACzC8D,OAAO,SAAA1D,GAAU,OAAA4D,IAAe5D,aAC/B6D,EAAgBL,EACjBE,OAAO,SAAC9G,GAAa,gBAAS3C,EAAWuF,SACzCkE,OAAO,SAAA1D,GAAU,OAAA4D,IAAe5D,aAC/B8D,EAAcD,EAAchL,OAAO8K,GACnCI,GAAO,IAAIC,MAAOC,UAClBC,EAAiBP,EAAYtO,SAC/B2N,GACA/I,EAAW2F,KACXmE,GACFrI,KAAKJ,IACD6I,EAAqBD,GAAkB,gBAAgBjK,EAAW2F,sBAAqBsE,OACvFE,EAAmBP,EAAcxO,SACnC2N,GACA/I,EAAWuF,OACXuE,GACFrI,KAAKJ,IACD+I,EAAuBD,GAAoB,gBAAgBnK,EAAWuF,wBAAuB4E,OAEnGX,EAAUpO,QAAU6O,GAAkBT,EAAUtI,QAAQ,SAACyB,GAAgB,iBAAQ+D,KAAOuD,GAAkB,KAE1GL,EAAcxO,QAAU+O,GAAoBC,GAAwBR,EAAc1I,QAAQ,SAACyB,GAAgB,iBAAQ+D,KAAOyD,GAAoB,KAE1ID,GAAsBlB,IAAWzF,IACjCyF,EAAO5F,QAAQuC,KAAOuE,GAGtBE,GAAwBpB,IAAWzF,IACnCyF,EAAO5F,QAAQiH,OAASD,GAGxBb,EAAQnO,SACR4N,EAAO5F,QAAQkH,eAAiBf,EAAQnO,OAAOmP,YAGnDV,EAAY3I,QAAQ,SAAA6E,GAAU,OAAAxC,EAAKW,YAAY6B,KAE/CwD,EAAQrI,QAAQ,SAAA6E,GAAU,OAAAiD,EAAO9C,YAAYH,KAE7CnJ,GAAWA,ICzEP,IAAA0E,YAYR,SAAsBkJ,GAAwCpF,EAAWxI,kHAGhEwI,EAA0BqF,ONVnC,SAA+BrF,gIACnBsB,EAAyCtB,OAAnCqF,EAAmCrF,MAA9B9D,EAA8B8D,WAApB+B,EAAoB/B,kBAChCtB,eACAnB,EAAA+D,GAAQpF,GAAYmJ,MAAaC,MAAMD,GACnDrN,KAAK,SAAAuN,GAAY,OAAAA,EAASC,yBADa7H,0BAM5C,GAJMqE,GAFAyD,MAEwB/G,SAASC,cAAc1D,EAAQwK,UAEzDhF,EAA8B,MAE7Ba,EACD,MAAM,IAAIJ,MAAMuB,IACb,IAAKvG,EACR,MAAM,IAAIgF,MAAM0B,IACb,IAAKyC,EACR,MAAM,IAAInE,MAAM2B,IACb,IAAK4C,EACR,MAAM,IAAIvE,MAAM4B,WAGhBd,GACAA,EAAUX,UAAYoE,EAEtBhF,EAAUuB,EAAUG,QAAQ9D,cAA2BnC,GAEvD6F,GAAmBtB,KAAiBiF,QAC7B1F,GACHgC,oCAF0BrE,2CAMlC,IAAK8C,EACD,MAAM,IAAIS,MAAMyB,IAKpB,OAFAlC,EAAQzB,aAAa,eAAgBsC,MAE9Bb,QMzBakF,CAAkB3F,wBAAlCS,EAAUhD,sBAEA,SPflB,SAA+BuC,qHAM3B,GALQsB,EAA8CtB,OAAxCyF,EAAwCzF,WAA9B+B,EAA8B/B,kBAAb9D,EAAa8D,WAChDgC,EAAYV,GAAQmE,GAAY/G,SAASC,cAAc1D,EAAQwK,UAEjEhF,EAA8B,MAE7Ba,EACD,MAAM,IAAIJ,MAAMuB,IACb,IAAKgD,EACR,MAAM,IAAIvE,MAAMwB,WAGhBV,GACAA,EAAUX,UAAYoE,EAEtBhF,EAAUvE,GAAY8F,EAAUG,QAAQyD,mBAAqB5D,EAAUG,QAAQyD,kBAAkBvH,cAAcnC,IACxG8F,EAAUG,QAAQyD,kBAEzB7D,GAAmBtB,KAAiBiF,QAC7B1F,GACHgC,oCAF0BvE,2CAMlC,IAAKgD,EACD,MAAM,IAAIS,MAAMyB,IAKpB,OAFAlC,EAAQzC,QAAQsD,KAAOA,KAEhBb,QOfaoF,CAAuB7F,WAAvCS,EAAUhD,iCAGdgD,KAAiBoD,IAAgB3H,YAAU0H,OAAQnD,kBAAxChD,iCAEXjG,EAAQiJ,YC1BJ,IAAAqF,kBAER,YAAyBvI,OAQjBwI,EARkBxP,QAEhByP,GACFxO,kBACAC,iBAEIwO,2CAIPA,EAAaC,IAAI3P,IAAQ0P,EAAaE,IAAI5P,EAAK,IAAI6P,MAEpDL,EAAQE,EAAaI,IAAI9P,KAEhBwP,EAAMO,IAAIN,GAEnBO,WAAW,WAAM,OAGrB,SAAiChJ,OAAEhH,QAAKyP,eAE5BC,0CACFF,EAAQE,EAAaI,IAAI9P,GAE3BwP,IACAA,EAAMG,IAAIF,IAAeD,EAAMS,OAAOR,IAErCD,EAAMU,MAAQR,EAAaO,OAAOjQ,IAXtBmQ,EAA0BnQ,MAAKyP,gBAAeF,ICd3D,IAAAa,4BAER,YAA+B3G,mHAEhB,OADH4G,EAA6B5G,YAAAA,UAAT6G,EAAS7G,UAaT,IAAIzI,QAAQ,SAACC,EAAoCC,GAC7E,IAAMqP,EAAYC,UAAUC,KAAKL,GAAQ,GAEzCG,EAAUnF,iBAAiB,QAASlK,GAEpCqP,EAAUnF,iBAAiB,gBAAiB,WAAM,OAKzBpE,GAL+C0J,GAAIH,EAAUhP,QAK3DmP,YACR7S,OAAOwH,KAAKD,GAEpBG,QAAQ,SAAA8K,GAAa,OAACK,EAAGC,iBAAiBC,SAASP,IAAcK,EAAGG,kBAAkB3L,EAAYmL,IACzGS,QAAS1L,EAAUiL,OAJ3B,IAA6BrJ,EAAE0J,IAH3BH,EAAUnF,iBAAiB,UAAW,WAAM,OAAAnK,EAAQsP,EAAUhP,oBAV9D,OATMmP,EAAK1J,SACL+J,EAAcL,GAAMA,EAAGK,aAAeL,EAAGK,YAAYV,EAAWC,GAChEU,EAAQD,GAAeA,EAAYE,aAAeF,EAAYE,YAAYZ,OAE5EK,KACAK,cACAC,eCZA,IAAAV,eACA7C,yBAER,YAA+BzG,OAAEqJ,cAAWS,YAASI,SAAMC,wHACrC,SAAMC,IACpBf,YACAS,UACAR,yBAHIU,EAAU9J,gBAKZmK,EAAOL,EAAMM,IAAIJ,IAElB9F,iBAAiB,QAASmG,IAC/BF,EAAKjG,iBAAiB,UAAW,WAAM,OAG3C,SAAuBpE,OAAEmK,cAAWnR,QAC1B8M,EAAUqE,IACZ1D,UACAhE,QACI0H,YACAnR,QAIR8M,GAAWU,GAAYV,GAZgB0E,EAAgBL,YAAWnR,IAAK8Q,eAe3E,SAASS,GAAYvO,GAEjB,MADA0H,QAAQ1H,MAAMA,GACRA,EC/BF,IAAAsN,cAER,YAA4DtJ,OAAEqJ,cAAWS,YAAS9Q,6BAAWgB,kEAA8B,SAAO,IAAIA,QAAQ,SAAOC,EAASC,0GACxI,SAAMkQ,IACpBf,YACAS,UACAR,yBAHIU,EAAUhK,gBAKZ8I,EAAMkB,EAAMlB,IAAI9P,IAElBoL,iBAAiB,QAASlK,GAC9B4O,EAAI1E,iBAAiB,UAAW,WAAM,OAAAnK,EAAQ6O,EAAIvO,sCCd7ByF,OAAEhH,QAAKkR,SAGtB1B,0CAAqBM,IAAI9P,IAAQ,IAAI6P,IAE3ClR,MAAMgN,KAAK6D,GAAOjK,QAAQ,SAACkK,GACvBA,EAAWxO,QAAQiQ,GAEnB1B,EAAMS,OAAOR,KCAb,IAAAhC,yBAER,YAAyBhE,GACb,IAAAkD,6BACA8E,YAASC,kBAEjB,GAAI1E,KAAY,CACZ,GAAI0E,GAAiBA,EAAcC,sBAC/B,OAqBZ,SAA+C3K,OAAEhH,0FAQ7CwN,IANIC,UACAhE,QACIzJ,iBAzBO4R,CAAgCnI,GAChCgI,GAAWA,EAAQE,uBAQtC,SAAgD3K,OAAEhH,2GACjC,SAAM6R,IAAsB7R,uBAAnCkR,EAAOhK,UACP4K,EAAgBZ,IAClBlR,MACAkR,UAIAa,GAAQD,YAfJE,CAA0BvI,QAE3B,GAAIwD,KACP,OA2BR,SAAgDjG,OAAEhH,gHACzB,SAAM6R,IAAsB7R,gBAYjD,OAZMiS,EAAe/K,YACL+K,GAAgBA,EAAavD,QAAUuD,EAAavD,OAAOjP,SACvEgO,OAAQzI,EAAc+M,QACtBtI,QACIzJ,MACAkR,MACIxC,OAAQuD,EAAavD,OACrB1E,KAAMiI,EAAajI,cAnCpBkI,CAA0BzI,GA2CzC,SAAsBoI,GAAoB7K,OAAEhH,0GACnB,SAAMmS,IACvB9B,UAAWnL,EAAY+M,aACvBnB,QAAS1L,EAAU6M,aACnBjS,gBAGJ,SANqBkH,eCvDjB,IAAAmJ,kBACAS,kBAER,YAAyBrH,GACrB,OAAIuD,KAOR,SAA0CvD,8HAC9BkD,EAA0BnP,2BAC1BiU,EAA2B9E,UAAlB+E,EAAkB/E,gBACtB3M,EAAQyJ,MACf9D,EAAWyM,IAActD,IAAK9O,IAC9BkR,EAAOiB,GAAQ1I,GACfqD,EAAUoE,IACZzD,OAAQzI,EAAcqN,qBACtB5I,OAAQyH,GAGRQ,GAAiBA,EAAcC,uBAC/B7E,GAAWU,GAAYV,8BAChB2E,GAAWA,EAAQE,yBACpBW,GAA4B7I,iBAClC,OADAzC,YACM6K,IAAsB7R,gBAA5BgH,SACAuG,IAAyB5H,6CAtBlB4M,CAA2B9I,GAC3BwD,KAyBf,SAA0CxD,iHAGrB,OAFTqF,EAAQrF,MACV9D,EAAWyM,IAActD,WACRwD,GAA4B7I,kBAAlCzC,SACXwL,GACF/E,OAAQzI,EAAc6M,oBACtBpI,QACIzJ,IAAK8O,IAGP2D,GACFhF,OAAQzI,EAAcuI,uBACtB9D,QACI9D,aAIR6H,GAAYgF,GACZhF,GAAYiF,YA1CDC,CAA2BjJ,QAD/B,EA8CX,SAAe6I,GAA4B7I,oHACjCyH,EAAOiB,GAAQ1I,IACfkJ,EAAazB,IACfb,aACAS,WACAI,YAGgBG,GAAKsB,iBAAXzL,yCAGlB,SAASiL,GAAQnL,OAAE8H,QAAK5H,YAAA0L,oCAAgC5I,SAAM0E,WAQ1D,OAPaI,GAAOJ,IAChBI,MACA8D,UACAlE,OAAQA,EACR1E,KAAMA,GAMd,SAASoI,GAAYpL,GAGjB,MAFiB,4DClFb,IAAAmC,cAER,YAA+BM,qGACpB,SAAOuD,MAGlB,SAAoChG,OAAE8H,+IAC1BlH,EAASO,cACXxC,EAAcd,EAASuF,gBAAe0E,OACtC3E,EAAiBvC,EAAKE,cAAcnC,IAC3BuB,GAACiD,MAAwB6B,IAAalC,IAAKgF,oBAAxBpH,iCAC5BmL,EAAiB,oDAAoD/D,OACrEgE,EAAe,iDAAiDhE,QACtD1H,QAAgBpG,QAAQ+K,KACpCpN,MACKgN,KAAK/D,EAAKiE,iBAAoCgH,IAC9CpM,IAAI,SAACO,OAAE8D,cAAgB,OAAAA,IAC5BlD,EAAKE,cAAiCgL,qBAJhBpL,iCAMlBuG,GAAFzG,WAA4CuL,OAAWA,OAAtCC,OACjBtE,EAAST,GAAiBA,EAAcxH,IAAI,SAAAwM,GAAgB,OAAA9J,GAAM8J,KAClEjJ,EAAOgJ,GAAc7J,GAAM6J,EAAWlI,gBACtCrB,EAASiF,IACXI,MACA8D,SAAS,IAAIxE,MAAOC,UACpBK,SACA1E,UAGMqI,GAAqB5I,YA1BHyJ,CAAqBzJ,WAAjD,SAAOzC,2BCDcA,GAAzB,WAA2B8H,WAA4B,OAAO,IAAI9N,QAAQ,SAAOC,EAAkCC,wGAO/GsO,IALIxP,IAAK8O,EACL7N,UACAC,4BAMA,gCAAMgS,IAAuBpE,uBAA7B9H,wCAEA0D,QAAQ1H,MAAMmQ,uBAGlBtB,IAAsB7R,IAAK8O,eCjBvB,IAAAsE,qCCEJ,OAJoB5V,KAAKuB,eAAe,sBACjC+E,EAAY8B,QACZ9B,EAAYmE,OCFf,IAAAkB,cACFkK,IACF5F,OAAQzI,EAAcsO,OACtB7J,WAEE8J,GAAc,IAAIC,YAExB,YAAyB/I,GACrB,IAAIqC,EAEJ,IACIA,EAQR,SAAwB9F,OAAE8F,SAChB2G,EAAiD,iBAAZ3G,GAAwB3D,GAAM2D,IAClEA,aAAmB4G,YAAcvK,GAAMoK,GAAYI,OAAO7G,IAE/B,iBAAvB2G,EAAYhK,SACnBgK,EAAYhK,OAASN,GAAMsK,EAAYhK,SAG3C,OAAOgK,EAhBOG,CAAenJ,IAAU4I,GACrC,MAAMrQ,GACJ8J,EAAUuG,GAGd,OAAOvG,ECVH,IAAAuD,aAER,YAA+B5G,qFAC3BuD,MAKJ,SAA+BvD,GACnB,IACAiI,2CACF5E,EAAU4E,GAAiBA,EAAcC,wBAC3ClE,OAAQzI,EAAc6O,YACtBpK,UAGAqD,EACAU,GAAYV,GAEZgH,GAAuBrK,GAhBbsK,CAAsBtK,GAEpCwD,MAkBJ,SAA+BxD,GAC3BqK,GAAuBrK,GAnBTuK,CAAsBvK,WAsBxC,SAASqK,GAAuBrK,GACpB,IAAAwK,gBACFtB,EAAasB,IACf5D,aACAS,QAAS1L,EAAUqM,QACnBP,QACI+C,eACGxK,IAIXkJ,GAActB,GAAKsB,GCpCf,IAAA7B,aACAT,aAER,8HAMoC,OAJ5B1D,EAGAnP,2BAFA0W,EAEA1W,kBADAgT,EACAhT,kBACkCwD,QAAQ+K,KAkBlD,WAAA,WAAqC,OAAO,IAAI/K,QAAQ,SAAOC,EAA+CC,4GAM1G,OALIyQ,GAAwB,EACxBwC,GAAW,EACTF,EAAcnQ,EAAY8B,OAChBoK,WAAW,WAAM,OAACmE,GAAYlT,EAAQ0Q,IAAwB5N,EAAgBqQ,wBAExFjC,IACF9B,aACAS,WACA9Q,IAAKiU,mBAHTjN,SAOAmN,GAAW,EAEXlT,EAHA0Q,GAAwB,cA7BpB0C,oBADG1C,EAAyB3K,YAG1ByK,GACFyC,eAAcA,EACdI,YAAW9D,EACXmB,wBACA/L,SAAQpI,KAAKuB,eAAe,UAC5BwV,aAAc/W,KAAKuB,eAAe,gBAClC0N,YAAajP,KAAKuB,eAAe,eACjCwU,YAAa/V,KAAKuB,eAAe,gBAGrC4N,EAAsB8E,QAAUA,EAEhCxE,MAsCJ,WACY,IAAAN,6BAMRa,IAJIC,OAAQzI,EAAcwP,iBACtB/K,OAAQkD,EAAsB8E,cA1CpBgD,YCrClB,OAAMC,GAAa,kBCAnB,IAeMjH,YACDzI,EAAcsO,QDdnB,SAAyB7J,GACrBiB,QAAQiK,IAAID,IACZhK,QAAQyC,KAAK1D,ICabzC,GAAChC,EAAcuI,wBAAyBA,GACxCvG,GAAChC,EAAcwP,kBFwCnB,SAAuC9C,+FAC3B/E,EAA0BnP,2BAC1BiU,EAAyB9E,UAAhBsH,EAAgBtH,cAEjCA,EAAsB+E,cAAgBA,EAEtCD,GAAWoC,MACPI,eACGxC,IAGPC,GAAiBmC,MACbI,YAAanQ,EAAY8B,QACtB8L,aEpDP1K,GAAChC,EAAcqN,sBAAuBA,GACtCrL,GAAChC,EAAc6M,qBAAsBA,GACrC7K,GAAChC,EAAc+M,SAAUA,GACzB/K,GAAChC,EAAckO,sBAAuBA,GACtClM,GAAChC,EAAc6O,aAAcA,OAGjC,YAA+BpJ,iHAGV,OAFXzD,EAAiC4M,GAAenJ,KAAYgD,OAAQzI,EAAcsO,OAAQ7J,WAAhFmL,WAAYnL,eACtBoL,EAAgBpH,GAAOmH,IACQnL,kBAA/BuF,EAAW9H,WAELsG,GAAYwB,YC1BpB,IAAAF,2BAER,6HCFYgG,mBDGS9N,ECFG7C,EAAS4Q,YAAcD,EAASE,aDEZjG,MAAMD,IACzCrN,KAAK,SAAAuN,GAAY,OAAAA,EAASiG,KAC1BC,MAAM,SAAAlS,GAAS,MAAA,qBAFckE,0BAKlC,YAFyC4H,IAAO,QCNxCgG,MCGJ,IAKJlP,GALI4G,kBACF/C,IACFuB,KAAM3G,EAAWqF,IA2BrB,SAAgB6H,GAAY9G,GACX5M,OAAOwH,KAAKoF,GAEpBlF,QAAQ,SAAAvF,GAAO,OAAA0K,QAAQ1H,MAA4B,iBAAfyH,EAAMzK,IAAqBwM,GAAU/B,EAAMzK,qBCjCpFgN,MAGJ,8GAGmC,OAFvBL,EAA0BnP,2BAElCwJ,EAAA2F,KDEJ,iIAC+B,SAAMwI,aAkBjC,OAlBMC,EAAqBpO,SACnBY,EAASO,cACTkN,EAAoBC,oBACtBC,GAAkB3P,IAAUD,EAASC,OACrC4P,GAAiBD,GAAkB5W,MAAMgN,KAAK/D,EAAKiE,iBAAoC0J,SACxF9O,IAAI,SAACO,GAAkB,qBACvB8G,OAAO,SAAA1D,GAAU,OAAAA,IAChBqL,EAAaD,GAAiBA,EAAc/V,QAAU,IAAIiW,KAAKF,EAAe/L,IAC9EkM,EAAYF,GAAcJ,GAAmBA,EAAgBI,IAC7DG,EAAgBD,GAAa,IAAIE,OAAOT,GAAsBO,MAGhEC,EAAcxK,iBAAiB,UAAW0K,IAC1CF,EAAcxK,iBAAiB,QAASmG,QAG5C3L,GAASA,IAAUgQ,QCnBkBG,kBAArC/O,EAAsBpB,OAASsB,kBANjB8O,iBCGd/I,OAIA7B,iBAAiB,UAAW0K,IAE5BvI,IACI5H,SAAUd,EAASmB,oBCjB3B,ICQQK,aACF6I,GAAW/G,SAASC,cAAc,YAClC6N,IDVS,6GCYbnQ,KAAKO,IAEP6I,GAASpE,UAAYmL,GAErB,gBAAwCxM,GAEhC,IAAA9D,aACAqB,eAAAW,kBACAT,eAAAK,kBAEE2O,EAAiBrY,OAAOwH,KAAKsC,GAC7BwO,EAAkBjH,GAAStD,QAAQ9D,cAAcnC,GACjDyQ,EAAkBD,GAAmBA,EAAgBE,WAAU,GAQrE,OANID,IACAvY,OAAOsB,OAAOiX,EAAiB7O,GAE/B2O,EAAe3Q,QAAQ,SAAAvF,GAAO,OAAA2H,EAAW3H,IAAQoW,EAAgB3N,aAAazI,EAAK2H,EAAW3H,IAAQ,OAGnGoW,GCxBH/P,aAASiQ,WCOjB,IAAMrC,GAAcsC,KACd1Q,IACFmG,cACAwK,qBCfkD/M,GAGlD,OAFgBzI,QAAQ+K,IAAItC,EAAOhD,IAAIuF,MDevCyK,iCEhB4ChN,GAAc,OAAA,IAAIzI,QAAQ,SAACC,EAA0DC,GACjI,IAAI0M,EAAU,IAAIiC,IACd6G,EAAO1V,QAAQC,UAUnB,OARAwI,EAAOlE,QAAQ,SAAAoR,GACXD,EAAOA,EACFjV,KAAK,+GAAY,SAAMT,QAAQ+K,IAAI4K,EAAalQ,IAAIuF,aAAnC,SAAAhF,iBACjBvF,KAAK,SAAAmV,GAAiB,OAAAA,EAAcrR,QAAQ,SAAA6E,GAAU,OAAAwD,EAAQmC,IAAI3F,SAG3EsM,EAAOA,EAAKjV,KAAK,WAAM,OAAAR,EAAQtC,MAAMgN,KAAKiC,SFO1CiJ,8BGdqB7P,OAAEC,QAAKiD,YAExB4M,eAGEC,eAAiBD,GAAcA,EAAWhP,cAAcjD,EAASkS,iBACjE1N,EAAayN,GAAc3O,SAASC,cAAc,SAEpDiB,GAAcyN,IACdzN,EAAWyB,UAAY7D,EAEnB8P,GAAkBA,EAAe1O,mBACjCyO,EAAWxO,aAAae,EAAY0N,EAAe1O,oBAEnDyO,EAAWvO,YAAYc,KHC/B2N,oBnCjBJ,SAAwBA,EAAoBhQ,OAAE+D,SAAM9L,gBAAaqU,WACrD2D,sBACF7Y,EAAS6Y,GAAkBA,EAAe7Y,OAC1C8Y,EAAkB9Y,GAAU6Y,EAAenH,KAAOmH,EAAenH,IAAI/E,GAE3E,GAAI3M,IAAW8Y,EACXD,EAAe7Y,OAAO2M,EAAM9L,OACzB,CAAA,GAAIiY,EACP,MAAM,IAAIvM,MAASW,QAA+BP,GAC/C,GAAKuI,EAGR,MAAM,IAAI3I,MAASU,0BAAyCN,GAF5DiM,GAAsBjM,OAAM9L,cAAaqU,QAAQ,MmCQrD6D,elCpBYnQ,OAAEE,iBAAAkQ,mBAAkC,OAAA,IAAIpW,QAAQ,SAACC,EAASC,GAAW,OAAA8O,WAAW/O,EAASmW,MkCqBrGvI,WzBXJ,SAA0DpF,8EAAa,SAAO,IAAIzI,QAAQ,SAACC,EAAyCC,GACxH,IAAAqK,2BAEJA,EACAA,EAAoB,WAAM,OAAAsD,GAAWpF,EAAQxI,KAE7C4N,GAAWpF,EAAQxI,WyBMvBkR,QffJ,SAAwBnL,OAAE0H,WAAsB,OAAO,IAAI1N,QAAQ,SAACC,EAAoCC,GAC5F,IAAAqK,2BAEJmD,EACInD,EACAA,EAAoB,WAAM,OAAA8L,IAAY3I,WAAUjN,KAAKR,KAErDoW,IAAY3I,WAAUjN,KAAKR,GAG/BC,EAAO,IAAIyJ,MAAMyI,QeMrBmD,kBACAtC,eACAvE,aAAc,IAAI4H,IAClBC,oBDlBJ,SAAyBvQ,OAUjBwQ,EACAC,EAXmBC,cAAWC,aAC5BC,EAAQF,EAAUC,GAClBE,EAAYlZ,MAAMmZ,QAAQF,IAAUA,IAAUA,OAC9CG,EAAUH,GAASI,IACrBrS,SAAUd,EAASoT,kBACnBtQ,YACIuQ,SAAUP,KA4DlB,OApDAE,EAAUtS,QAAQ,SAAA4S,GACVA,IACAX,EAAWW,EAAiB,aAAeA,EAAiB,WACxDA,EAAiB,YACjBA,EAAiB,UACnBrS,KAAKwQ,KACPmB,EAAiBO,IACbrS,SAAUd,EAASoT,uBAInBR,EAAehP,aAAa,YAAapC,IACzCmR,GAAYC,EAAehP,aAAa,WAAY+O,IAGhDW,EAAiBpN,MAAQiN,IACrBrS,SAAUd,EAASuT,yBACnB7Q,YACIuD,UAAWqN,EAAiBpN,MAEhCpD,YACIuQ,SAAU,UAGlBC,EAAiBE,aAAeL,IAC5BrS,SAAUd,EAASuT,yBACnB7Q,YACIuD,UAAWqN,EAAiBE,aAEhC1Q,YACIuQ,SAAU,iBAGlBC,EAAiBrJ,KAAOkJ,IACpBrS,SAAUd,EAASzB,EACnBmE,YACIuD,UAAWqN,EAAiBpN,MAAQoN,EAAiBrJ,KAEzDnH,YACIuQ,SAAU,MACVnO,KAAMoO,EAAiBrJ,QAKJvJ,QAAQ,SAAA+S,GAAkB,OAAAA,GAAkBb,GAAkBA,EAAelP,YAAY+P,KAExHP,GAAWA,EAAQxP,YAAYkP,OAKpCM,KC5CX,WACI,IACY,IAAApL,6BAEHA,IACDnP,KAAKmP,sBAAwB9G,GAE7B0S,KAEAvC,KAEAwC,MAEN,MAAMxV,IAKZ,SAAqBA,GAEjB,MADA0H,QAAQ1H,MAAMA,GACRA,EANFuO,CAAYvO,IAhBpByV"}